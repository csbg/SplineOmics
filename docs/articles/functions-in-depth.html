<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>functions-in-depth • SplineOmics</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="functions-in-depth">
<meta property="og:description" content="SplineOmics">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SplineOmics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/functions-in-depth.html">functions-in-depth</a>
    </li>
    <li>
      <a href="../articles/get-started.html">get-started</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>functions-in-depth</h1>
                        <h4 data-toc-skip class="author">Thomas
Rauter</h4>
            
            <h4 data-toc-skip class="date">11 June, 2024</h4>
      
      
      <div class="hidden name"><code>functions-in-depth.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="about-this-vignette">About this vignette<a class="anchor" aria-label="anchor" href="#about-this-vignette"></a>
</h2>
<p>In this vignette, all the exported functions of the SplineOmics
package will be explained in detail.</p>
</div>
<div class="section level2">
<h2 id="extract_data">extract_data()<a class="anchor" aria-label="anchor" href="#extract_data"></a>
</h2>
<div class="section level3">
<h3 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h3>
<p>This function is not directly needed for the core workflow, that this
package carried out. Rather, it can be seen as a convenience function.
Because the Excel files, containing the results of a time-series omics
experiment are not always formatted in the exact way that is needed for
this packge, this function was created. It takes for example an Excel
file as dataframe as input, and automatically extracts the “data matrix
part”, so the square or rectangle, where there is only the numeric data.
Further, it combines all the column headers of one column, that maybe
goes over several rows, into one. Additionally, you can specify a column
or columns, which contents will be used to make a rowheader of the
output dataframe containing the data. These rowheaders will be used to
label the features in the plots. If skipped, the rowheaders will be
increasing integers (1, 2, 3, etc.) which instead will be used to label
the features in the plots.</p>
<p>When for example the Excel file in the beginning looks like this:
<img src="../reference/figures/original_excel_file.png" alt="Original Excel file"></p>
<p>The output dataframe of the extract_data() function looks like this:
<img src="../reference/figures/extract_data_output_dataframe.png" alt="Output dataframe"></p>
<p>This dataframe can be directly used as the input for the other
functions of the SplineOmics package.</p>
</div>
<div class="section level3">
<h3 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clean_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_data.html">extract_data</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                           feature_name_columns <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mandatory-arguments">Mandatory arguments<a class="anchor" aria-label="anchor" href="#mandatory-arguments"></a>
</h3>
<p><strong>data</strong>:</p>
<div style="margin-left: 20px;">
<p>A dataframe, loaded from for example an Excel, CSV, TSV, etc. file.
It must contain a quadratic or rectangular “field” where the numeric
values of the data are located. On the right of that field (it must be
on the right, otherwise the function will produce an error) there can be
annotation information for the features, which column names can be
specified to construct a unique identifier for the features.</p>
</div>
</div>
<div class="section level3">
<h3 id="optional-arguments">Optional arguments<a class="anchor" aria-label="anchor" href="#optional-arguments"></a>
</h3>
<p><strong>feature_name_columns</strong>:</p>
<div style="margin-left: 20px;">
<p>A character vector of column names to use as features. If set to
<code>NA</code>, all columns are used as features. Default is
<code>NA</code>.</p>
</div>
</div>
<div class="section level3">
<h3 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a>
</h3>
<p><strong>clean_data</strong>:</p>
<div style="margin-left: 20px;">
<p>A dataframe, containing only numeric values as the elements. The
column names are the combination of all the strings in the cells above
the respective column in the original dataframe, that contain the
numeric values. The row names are either integers (1, 2, 3, etc.) if
feature_name_columns was NA, or the concatenated strings of the columns
which names were provided with feature_name_columns.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="explore_data">explore_data()<a class="anchor" aria-label="anchor" href="#explore_data"></a>
</h2>
<div class="section level3">
<h3 id="description-1">Description<a class="anchor" aria-label="anchor" href="#description-1"></a>
</h3>
<p>The first step in analysing data is usually exploratory data analysis
(EDA). EDA involves summarizing the main characteristics of the data,
often using plots. This can involve densitiy distributions, boxplots,
PCA, correlation heatmaps, and more. This process can be automatically
carried out by using the package function explore_data(). The function
generates an HTML report, containg all the EDA plots.</p>
</div>
<div class="section level3">
<h3 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/explore_data.html">explore_data</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                      <span class="va">meta</span>,</span>
<span>                      <span class="va">condition</span>,</span>
<span>                      <span class="va">report_info</span>,</span>
<span>                      meta_batch_column <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                      meta_batch2_column <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                      report_dir <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                      report <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mandatory-arguments-1">Mandatory arguments<a class="anchor" aria-label="anchor" href="#mandatory-arguments-1"></a>
</h3>
<p><strong>data</strong>:</p>
<div style="margin-left: 20px;">
<p>A dataframe, where every element is numeric and the columns represent
the samples of a time-series omics experiment. The elements are the
intensities/abundances/etc. of the individual features
(proteins/metabolites/etc.) which are the rows of this dataframe. The
row headers are the IDs of the features. (For an example see output
dataframe picture in the section extract_data() ).</p>
</div>
<p><strong>meta</strong>:</p>
<div style="margin-left: 20px;">
<p>A dataframe, that contains the meta information of the time-series
omics experiment. Each column contains different meta information,
e.g. the reactor, timepoint, etc. Each row corresponds to one specific
timepoint, so each row corresponds to a column of data. It must have the
column named ‘Time’, which must contain only numeric elements. Further,
it must have a ‘condition’ column, that divides the experiment into
different levels, for example Exponential and Stationary (two growth
phases of cells). This is an example of such a meta dataframe (this is
part of it): <img src="../reference/figures/meta_dataframe_example.png" alt="meta dataframe"></p>
</div>
<p><strong>condition</strong>:</p>
<div style="margin-left: 20px;">
<p>The argument condition must be a character vector of length == 1,
containing a string that is a column name of meta. This column contains
the levels of the experiment.</p>
</div>
<p><strong>report_info</strong>:</p>
<div style="margin-left: 20px;">
<p>The argument report_info must be a named list with these mandatory
fields: “omics_data_type”, “data_description”, “data_collection_date”,
“analyst_name”, “contact_info”, “project_name”. The following fields are
optional: “method_description”, “results_summary”, “conclusions”. Any
other fields besides the mandatory and optional fields are not allowed.
All elements of the report_info list must be strings, so character
vectors of length == 1. You can write whatever you want in there, as
long as it is not exceeding 80 characters. However, we recommend writing
descriptive info in there. The fields are self descriptive, but for
example, in the field ‘omics_data_type’, you could write proteomics, to
remind yourself, when you look at the report after 2 years, that this
was about proteomics.</p>
</div>
</div>
<div class="section level3">
<h3 id="optional-arguments-1">Optional arguments<a class="anchor" aria-label="anchor" href="#optional-arguments-1"></a>
</h3>
<p><strong>meta_batch_column</strong>:</p>
<div style="margin-left: 20px;">
<p>The argument meta_batch_column must be a character vector of length
== 1, containing a string that is a column name of meta. This column
contains the first batch effect of the experiment, if present. If
specified, the function explore_data() will generate a second HTML
report, containing the same plots but with the batch effect removed from
the data. The removal of the batch effect is carried out with the limma
function ‘removeBatchEffect’.</p>
</div>
<p><strong>meta_batch2_column</strong>:</p>
<div style="margin-left: 20px;">
<p>The argument meta_batch2_column must be a character vector of length
== 1, containing a string that is a column name of meta. This column
contains the second batch effect of the experiment, if present. This
argument can only be specified if meta_batch_column also is specified.
The limma function ‘removeBatchEffect’ can remove up to two batch
effects from the data.</p>
</div>
<p><strong>report_dir</strong>:</p>
<div style="margin-left: 20px;">
<p>A valid path to a directory (when the dir is not existing yet, it
will be created automatically). The HTML repors will be written to this
directory.</p>
</div>
<p><strong>report</strong>:</p>
<div style="margin-left: 20px;">
<p>A Boolean value (either ‘TRUE’ or ‘FALSE’) specifying if the HTML
repors should be generated or not. Default is TRUE, which means the
repors will be generated. It can be set to false if you are only
interested in the plots inside your R session.</p>
</div>
</div>
<div class="section level3">
<h3 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a>
</h3>
<p><strong>plots</strong>:</p>
<div style="margin-left: 20px;">
<p>A named list, where the elements are data and optionally
batch-corrected-data (if at least one meta batch column was specified).
The elements are lists containing the ggplot and ComplexHeatmap plot
objects of all the plots, that are put into the HTML report, in that
order.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="screen_limma_hyperparams">screen_limma_hyperparams()<a class="anchor" aria-label="anchor" href="#screen_limma_hyperparams"></a>
</h2>
<div class="section level3">
<h3 id="description-2">Description<a class="anchor" aria-label="anchor" href="#description-2"></a>
</h3>
<p>This function allows to test different limma spline “hyperparameters”
in a semi-combinatorial fashion. Examples for such “hyperparameters” are
different versions of the data (full data vs. outliers removed),
different limma design formulas, spline parameters, adj. p-value
threshold, etc. For every type of “hyperparameter”, you can just specify
all the values that you want to explore, and this function runs the
limma spline analysis with those parameters.</p>
</div>
<div class="section level3">
<h3 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/screen_limma_hyperparams.html">screen_limma_hyperparams</a></span><span class="op">(</span><span class="va">datas</span>, </span>
<span>                         <span class="va">datas_descr</span>,</span>
<span>                         <span class="va">metas</span>, </span>
<span>                         <span class="va">designs</span>, </span>
<span>                         <span class="va">condition</span>, </span>
<span>                         <span class="va">spline_test_configs</span>,</span>
<span>                         <span class="va">report_info</span>,</span>
<span>                         report_dir <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         adj_pthresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span><span class="op">)</span>,</span>
<span>                         meta_batch_column <span class="op">=</span> <span class="cn">NA</span>,  </span>
<span>                         meta_batch2_column <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                         time_unit <span class="op">=</span> <span class="st">"m"</span>,    </span>
<span>                         padjust_method <span class="op">=</span> <span class="st">"BH"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mandatory-arguments-2">Mandatory arguments<a class="anchor" aria-label="anchor" href="#mandatory-arguments-2"></a>
</h3>
<p><strong>datas</strong>:</p>
<div style="margin-left: 20px;">
<p>A list of valid data dataframes (see extract_data(), Mandatory
arguments, data).</p>
</div>
<p><strong>datas_descr</strong>:</p>
<div style="margin-left: 20px;">
<p>A character vector, where each element is a description of the
element with the same index in datas (each element describes the
corresponding data dataframe)</p>
</div>
<p><strong>metas</strong>:</p>
<div style="margin-left: 20px;">
<p>A list of valid meta tables (see extract_data(), Mandatory arguments,
meta).</p>
</div>
<p><strong>designs</strong>:</p>
<div style="margin-left: 20px;">
<p>A character vector, where each element is a valid limma design
formula, such as ’~ 1 + Phase*X + Reactor’. Each design formula must
contain the capital letter X, and each meta column (such as Phase and
Reactor in this example) must be present in the respective meta table of
the list metas (the first element of designs corresponds to the first
element of datas and metas).</p>
</div>
<p><strong>condition</strong>:</p>
<div style="margin-left: 20px;">
<p>The argument condition must be a character vector of length == 1,
containing a string that is a column name of meta. This column contains
the levels of the experiment.</p>
</div>
<p><strong>spline_test_configs</strong>:</p>
<div style="margin-left: 20px;">
<p>A dataframe, where the columns must be ‘spline_type’, ‘degree’,
‘dof’, ‘knots’, and ‘bknots’. Every row is then a set of spline
parameters. One such set is one value for the hyperparameter
spline_params.</p>
</div>
<p><strong>report_info</strong>:</p>
<div style="margin-left: 20px;">
<p>The argument report_info must be a named list with these mandatory
fields: “omics_data_type”, “data_description”, “data_collection_date”,
“analyst_name”, “contact_info”, “project_name”. The following fields are
optional: “method_description”, “results_summary”, “conclusions”. Any
other fields besides the mandatory and optional fields are not allowed.
All elements of the report_info list must be strings, so character
vectors of length == 1. You can write whatever you want in there, as
long as it is not exceeding 80 characters. However, we recommend writing
descriptive info in there. The fields are self descriptive, but for
example, in the field ‘omics_data_type’, you could write proteomics, to
remind yourself, when you look at the report after 2 years, that this
was about proteomics.</p>
</div>
</div>
<div class="section level3">
<h3 id="optional-arguments-2">Optional arguments<a class="anchor" aria-label="anchor" href="#optional-arguments-2"></a>
</h3>
<p><strong>report_dir</strong>:</p>
<div style="margin-left: 20px;">
<p>A valid path to a directory (when the dir is not existing yet, it
will be created automatically). The HTML repors will be written to this
directory.</p>
</div>
<p><strong>adj_pthresholds</strong>:</p>
<div style="margin-left: 20px;">
<p>A numeric vector, where element must be 1 &gt; and &lt; 0. This
vector contains the different values for the hyperparameter adj. p-value
thresholds.</p>
</div>
<p><strong>meta_batch_column</strong>:</p>
<div style="margin-left: 20px;">
<p>The argument meta_batch_column must be a character vector of length
== 1, containing a string that is a column name of meta. This column
contains the first batch effect of the experiment, if present. If
specified, the function explore_data() will generate a second HTML
report, containing the same plots but with the batch effect removed from
the data. The removal of the batch effect is carried out with the limma
function ‘removeBatchEffect’.</p>
</div>
<p><strong>meta_batch2_column</strong>:</p>
<div style="margin-left: 20px;">
<p>The argument meta_batch2_column must be a character vector of length
== 1, containing a string that is a column name of meta. This column
contains the second batch effect of the experiment, if present. This
argument can only be specified if meta_batch_column also is specified.
The limma function ‘removeBatchEffect’ can remove up to two batch
effects from the data.</p>
</div>
<p><strong>time_unit</strong>:</p>
<div style="margin-left: 20px;">
<p>A character vector of length == 1, that contains the string that will
label the time axis in the respective plots. Can be any string with &lt;
16 letters, but it recommendet using strings such as min for minutes and
sec for seconds, for example.</p>
</div>
<p><strong>padjust_method</strong>:</p>
<div style="margin-left: 20px;">
<p>A character vector of length == 1 that contains one of the following
strings (supported methods for adjusting the p-value): “holm”,
“hochberg”, “hommel”, “bonferroni”, “BH”, “BY”, “fdr”, “none”. When
“none” is specified, the p-value will not be adjusted (not
recommendet).</p>
</div>
</div>
<div class="section level3">
<h3 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a>
</h3>
<p><strong>Nothing</strong>:</p>
<div style="margin-left: 20px;">
<p>This function does not return anything. As a side-effect, it writes
all the HTML reports, containing the comparison results of the different
hyperparameters, to the project- or the specified dir.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="run_limma_splines">run_limma_splines()<a class="anchor" aria-label="anchor" href="#run_limma_splines"></a>
</h2>
<div class="section level3">
<h3 id="description-3">Description<a class="anchor" aria-label="anchor" href="#description-3"></a>
</h3>
<p>This function runs the limma spline analysis with the best
hyperparameter that where found in the step before (for example using
the function screen_limma_hyperparams). It returns the limma topTables,
that contain the (adjusted) p-values for all the features. There are
three different types of topTables returned: One containing the results
for the time effect, one for the average difference between the
conditions, and one for the interaction effect between condition and
time.</p>
</div>
<div class="section level3">
<h3 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_tables</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_limma_splines.html">run_limma_splines</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                                <span class="va">meta</span>,</span>
<span>                                <span class="va">design</span>,</span>
<span>                                <span class="va">condition</span>, </span>
<span>                                spline_params <span class="op">=</span> </span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>spline_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span><span class="op">)</span>,</span>
<span>                                       dof <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                padjust_method <span class="op">=</span> <span class="st">"BH"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mandatory-arguments-3">Mandatory arguments<a class="anchor" aria-label="anchor" href="#mandatory-arguments-3"></a>
</h3>
<p><strong>data</strong>:</p>
<div style="margin-left: 20px;">
<p>A dataframe, where every element is numeric and the columns represent
the samples of a time-series omics experiment. The elements are the
intensities/abundances/etc. of the individual features
(proteins/metabolites/etc.) which are the rows of this dataframe. The
row headers are the IDs of the features. (For an example see output
dataframe picture in the section extract_data() ).</p>
</div>
<p><strong>meta</strong>:</p>
<div style="margin-left: 20px;">
<p>A dataframe, that contains the meta information of the time-series
omics experiment. Each column contains different meta information,
e.g. the reactor, timepoint, etc. Each row corresponds to one specific
timepoint, so each row corresponds to a column of data. It must have the
column named ‘Time’, which must contain only numeric elements. Further,
it must have a ‘condition’ column, that divides the experiment into
different levels, for example Exponential and Stationary (two growth
phases of cells). For an example of a meta table, see explore_data(),
Mandatory arguments, meta.</p>
</div>
<p><strong>design</strong>:</p>
<div style="margin-left: 20px;">
<p>A valid limma design formula, for example “~ 1 + Phase*X + Reactor”.
The formula must contain a capital X that reperesents the Time column of
meta, and every other meta column (such as Phase and Reactor here) must
be present in the meta dataframe.</p>
</div>
<p><strong>condition</strong>:</p>
<div style="margin-left: 20px;">
<p>The argument condition must be a character vector of length == 1,
containing a string that is a column name of meta. This column contains
the levels of the experiment.</p>
</div>
</div>
<div class="section level3">
<h3 id="optional-arguments-3">Optional arguments<a class="anchor" aria-label="anchor" href="#optional-arguments-3"></a>
</h3>
<p><strong>spline_params</strong>:</p>
<div style="margin-left: 20px;">
<p>A named list, specifying the chosen parameters for the spline
analysis. The names that must be used for the respective parameters are
‘spline_type’, ‘degree’, ‘dof’, ‘knots’, and ‘bknots’, but not all must
be used, just the ones that are defined. These parameters must be
provided as vectors. If the limma design formula contains interaction
effects, then the length of each vector must be 1, so every level runs
with the same parameters. When there is no interaction effect in that
formula, for every level there must be spline parameters specified (can
also be the same one for every level). For knots and bknots, a list must
be specified, where each element is a numeric vector, defining the
positions of the knots or bknots, respectively. For design formulas with
interaction effect, the lists must have 1 element, and for design
formulas with no interaction effect, they must have an element for each
level.</p>
</div>
<p><strong>padjust_method</strong>:</p>
<div style="margin-left: 20px;">
<p>A character vector of length == 1 that contains one of the following
strings (supported methods for adjusting the p-value): “holm”,
“hochberg”, “hommel”, “bonferroni”, “BH”, “BY”, “fdr”, “none”. When
“none” is specified, the p-value will not be adjusted (not
recommendet).</p>
</div>
</div>
<div class="section level3">
<h3 id="returns-3">Returns<a class="anchor" aria-label="anchor" href="#returns-3"></a>
</h3>
<p><strong>top_tables</strong>:</p>
<div style="margin-left: 20px;">
<p>A named list, containig the elements with the names time_diff,
avrg_diff_conditions, and interaction_condition_time when the limma
design formula contained interaction effects and there are more than 1
levels. If there is just one level or the limma design formula contains
no interaction effects, than there is just one named element, time_diff.
time_diff contains a limma topTable for every level, where the p-values
describe if the spline for each feature within that level shows a
significant effect over time. avrg_diff_conditions contains a limma
topTable for every comparison of two levels, where the p-values describe
if a feature has splines with significantly different average values in
the two levels, while ignoring the time pattern.
interaction_condition_time contains a limma topTable for every
comparison of two levels, where the p-values describe if for a feature,
the level has an effect on the temporal pattern.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="create_limma_report">create_limma_report()<a class="anchor" aria-label="anchor" href="#create_limma_report"></a>
</h2>
<div class="section level3">
<h3 id="description-4">Description<a class="anchor" aria-label="anchor" href="#description-4"></a>
</h3>
<p>The create_limma_report() function takes the output of the
run_limma-splines() function and shows the result in the form of plots
in an HTML report. The plots involve p-value histograms for the
time_diff and interaction_condition_time topTables, and both p-value
histograms and volcano plots for avrg_diff_conditions.</p>
</div>
<div class="section level3">
<h3 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">create_limma_report</span><span class="op">(</span><span class="va">run_limma_splines_result</span>,</span>
<span>                    <span class="va">report_info</span>,</span>
<span>                    adj_pthresh <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                    report_dir <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mandatory-arguments-4">Mandatory arguments<a class="anchor" aria-label="anchor" href="#mandatory-arguments-4"></a>
</h3>
<p><strong>run_limma_splines_result</strong>:</p>
<div style="margin-left: 20px;">
<p>The named list returned by the function run_limma_splines(). Please
do not edit that list by hand.</p>
</div>
<p><strong>report_info</strong>:</p>
<div style="margin-left: 20px;">
<p>The argument report_info must be a named list with these mandatory
fields: “omics_data_type”, “data_description”, “data_collection_date”,
“analyst_name”, “contact_info”, “project_name”. The following fields are
optional: “method_description”, “results_summary”, “conclusions”. Any
other fields besides the mandatory and optional fields are not allowed.
All elements of the report_info list must be strings, so character
vectors of length == 1. You can write whatever you want in there, as
long as it is not exceeding 80 characters. However, we recommend writing
descriptive info in there. The fields are self descriptive, but for
example, in the field ‘omics_data_type’, you could write proteomics, to
remind yourself, when you look at the report after 2 years, that this
was about proteomics.</p>
</div>
</div>
<div class="section level3">
<h3 id="optional-arguments-4">Optional arguments<a class="anchor" aria-label="anchor" href="#optional-arguments-4"></a>
</h3>
<p><strong>adj_pthresh</strong>:</p>
<div style="margin-left: 20px;">
<p>A numeric value (float) &gt; 0 and &lt; 1, that will be the adj.
p-value threshold used to filter the features.</p>
</div>
<p><strong>report_dir</strong>:</p>
<div style="margin-left: 20px;">
<p>A valid path to a directory (when the dir is not existing yet, it
will be created automatically). The HTML repors will be written to this
directory.</p>
</div>
</div>
<div class="section level3">
<h3 id="returns-4">Returns<a class="anchor" aria-label="anchor" href="#returns-4"></a>
</h3>
<p><strong>Nothing</strong>:</p>
<div style="margin-left: 20px;">
<p>This function does not return anything. As a side-effect, it writes
the HTML report to the project- or the specified dir.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="cluster_hits">cluster_hits()<a class="anchor" aria-label="anchor" href="#cluster_hits"></a>
</h2>
<div class="section level3">
<h3 id="description-5">Description<a class="anchor" aria-label="anchor" href="#description-5"></a>
</h3>
<p>The function cluster_hits()</p>
</div>
<div class="section level3">
<h3 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clustering_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cluster_hits.html">cluster_hits</a></span><span class="op">(</span><span class="va">top_tables</span>,</span>
<span>                                   <span class="va">data</span>,</span>
<span>                                   <span class="va">meta</span>,</span>
<span>                                   <span class="va">design</span>,      </span>
<span>                                   <span class="va">condition</span>,   </span>
<span>                                   <span class="va">report_info</span>,   </span>
<span>                                   spline_params <span class="op">=</span> </span>
<span>                                    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>spline_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span><span class="op">)</span>,</span>
<span>                                         dof <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                   adj_pthresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span><span class="op">)</span>,</span>
<span>                                   clusters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span><span class="op">)</span>,</span>
<span>                                   meta_batch_column <span class="op">=</span> <span class="cn">NA</span>,   </span>
<span>                                   meta_batch2_column <span class="op">=</span> <span class="cn">NA</span>,   </span>
<span>                                   time_unit <span class="op">=</span> <span class="st">"min"</span>,    </span>
<span>                                   report_dir <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                   report <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mandatory-arguments-5">Mandatory arguments<a class="anchor" aria-label="anchor" href="#mandatory-arguments-5"></a>
</h3>
<p><strong>top_tables</strong>:</p>
<div style="margin-left: 20px;">
<p>Placeholder</p>
</div>
<p><strong>data</strong>:</p>
<div style="margin-left: 20px;">
<p>A dataframe, where every element is numeric and the columns represent
the samples of a time-series omics experiment. The elements are the
intensities/abundances/etc. of the individual features
(proteins/metabolites/etc.) which are the rows of this dataframe. The
row headers are the IDs of the features. (For an example see output
dataframe picture in the section extract_data() ).</p>
</div>
<p><strong>meta</strong>:</p>
<div style="margin-left: 20px;">
<p>A dataframe, that contains the meta information of the time-series
omics experiment. Each column contains different meta information,
e.g. the reactor, timepoint, etc. Each row corresponds to one specific
timepoint, so each row corresponds to a column of data. It must have the
column named ‘Time’, which must contain only numeric elements. Further,
it must have a ‘condition’ column, that divides the experiment into
different levels, for example Exponential and Stationary (two growth
phases of cells). For an example of a meta table, see explore_data(),
Mandatory arguments, meta.</p>
</div>
<p><strong>design</strong>:</p>
<div style="margin-left: 20px;">
<p>A valid limma design formula, for example “~ 1 + Phase*X + Reactor”.
The formula must contain a capital X that reperesents the Time column of
meta, and every other meta column (such as Phase and Reactor here) must
be present in the meta dataframe.</p>
</div>
<p><strong>condition</strong>:</p>
<div style="margin-left: 20px;">
<p>The argument condition must be a character vector of length == 1,
containing a string that is a column name of meta. This column contains
the levels of the experiment.</p>
</div>
<p><strong>report_info</strong>:</p>
<div style="margin-left: 20px;">
<p>The argument report_info must be a named list with these mandatory
fields: “omics_data_type”, “data_description”, “data_collection_date”,
“analyst_name”, “contact_info”, “project_name”. The following fields are
optional: “method_description”, “results_summary”, “conclusions”. Any
other fields besides the mandatory and optional fields are not allowed.
All elements of the report_info list must be strings, so character
vectors of length == 1. You can write whatever you want in there, as
long as it is not exceeding 80 characters. However, we recommend writing
descriptive info in there. The fields are self descriptive, but for
example, in the field ‘omics_data_type’, you could write proteomics, to
remind yourself, when you look at the report after 2 years, that this
was about proteomics.</p>
</div>
</div>
<div class="section level3">
<h3 id="optional-arguments-5">Optional arguments<a class="anchor" aria-label="anchor" href="#optional-arguments-5"></a>
</h3>
<p><strong>spline_params</strong>:</p>
<div style="margin-left: 20px;">
<p>A named list, specifying the chosen parameters for the spline
analysis. The names that must be used for the respective parameters are
‘spline_type’, ‘degree’, ‘dof’, ‘knots’, and ‘bknots’, but not all must
be used, just the ones that are defined. These parameters must be
provided as vectors. If the limma design formula contains interaction
effects, then the length of each vector must be 1, so every level runs
with the same parameters. When there is no interaction effect in that
formula, for every level there must be spline parameters specified (can
also be the same one for every level). For knots and bknots, a list must
be specified, where each element is a numeric vector, defining the
positions of the knots or bknots, respectively. For design formulas with
interaction effect, the lists must have 1 element, and for design
formulas with no interaction effect, they must have an element for each
level.</p>
</div>
<p><strong>adj_pthresholds</strong>:</p>
<div style="margin-left: 20px;">
<p>Placeholder</p>
</div>
<p><strong>clusters</strong>:</p>
<div style="margin-left: 20px;">
<p>Placeholder</p>
</div>
<p><strong>meta_batch_column</strong>:</p>
<div style="margin-left: 20px;">
<p>The argument meta_batch_column must be a character vector of length
== 1, containing a string that is a column name of meta. This column
contains the first batch effect of the experiment, if present. If
specified, the function explore_data() will generate a second HTML
report, containing the same plots but with the batch effect removed from
the data. The removal of the batch effect is carried out with the limma
function ‘removeBatchEffect’.</p>
</div>
<p><strong>meta_batch2_column</strong>:</p>
<div style="margin-left: 20px;">
<p>The argument meta_batch2_column must be a character vector of length
== 1, containing a string that is a column name of meta. This column
contains the second batch effect of the experiment, if present. This
argument can only be specified if meta_batch_column also is specified.
The limma function ‘removeBatchEffect’ can remove up to two batch
effects from the data.</p>
</div>
<p><strong>time_unit</strong>:</p>
<div style="margin-left: 20px;">
<p>A character vector of length == 1, that contains the string that will
label the time axis in the respective plots. Can be any string with &lt;
16 letters, but it recommendet using strings such as min for minutes and
sec for seconds, for example.</p>
</div>
<p><strong>report_dir</strong>:</p>
<div style="margin-left: 20px;">
<p>A valid path to a directory (when the dir is not existing yet, it
will be created automatically). The HTML repors will be written to this
directory.</p>
</div>
<p><strong>report</strong>:</p>
<div style="margin-left: 20px;">
<p>A Boolean value (either ‘TRUE’ or ‘FALSE’) specifying if the HTML
repors should be generated or not. Default is TRUE, which means the
repors will be generated. It can be set to false if you are only
interested in the plots inside your R session.</p>
</div>
</div>
<div class="section level3">
<h3 id="returns-5">Returns<a class="anchor" aria-label="anchor" href="#returns-5"></a>
</h3>
<p><strong>clustering_results</strong>:</p>
<div style="margin-left: 20px;">
<p>Placeholder</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="download_enrichr_databases">download_enrichr_databases()<a class="anchor" aria-label="anchor" href="#download_enrichr_databases"></a>
</h2>
<div class="section level3">
<h3 id="description-6">Description<a class="anchor" aria-label="anchor" href="#description-6"></a>
</h3>
</div>
<div class="section level3">
<h3 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/download_enrichr_databases.html">download_enrichr_databases</a></span><span class="op">(</span><span class="va">gene_set_lib</span>,</span>
<span>                           output_dir <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mandatory-arguments-6">Mandatory arguments<a class="anchor" aria-label="anchor" href="#mandatory-arguments-6"></a>
</h3>
<p><strong>gene_set_lib</strong>:</p>
<div style="margin-left: 20px;">
<p>Placeholder</p>
</div>
</div>
<div class="section level3">
<h3 id="optional-arguments-6">Optional arguments<a class="anchor" aria-label="anchor" href="#optional-arguments-6"></a>
</h3>
<p><strong>output_dir</strong>:</p>
<div style="margin-left: 20px;">
<p>Placeholder</p>
</div>
</div>
<div class="section level3">
<h3 id="returns-6">Returns<a class="anchor" aria-label="anchor" href="#returns-6"></a>
</h3>
<p><strong>Nothing</strong>:</p>
<div style="margin-left: 20px;">
<p>This function does not return anything. As a side-effect, it writes
the file, containing the Enrichr databases, to the project- or the
specified dir.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="run_gsea">run_gsea()<a class="anchor" aria-label="anchor" href="#run_gsea"></a>
</h2>
<div class="section level3">
<h3 id="description-7">Description<a class="anchor" aria-label="anchor" href="#description-7"></a>
</h3>
</div>
<div class="section level3">
<h3 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu">run_gsea</span><span class="op">(</span><span class="va">levels_clustered_hits</span>,</span>
<span>                  <span class="va">genes</span>,</span>
<span>                  <span class="va">databases</span>,</span>
<span>                  <span class="va">report_info</span>,</span>
<span>                  params <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                  plot_titles <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                  background <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                  report_dir <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mandatory-arguments-7">Mandatory arguments<a class="anchor" aria-label="anchor" href="#mandatory-arguments-7"></a>
</h3>
<p><strong>levels_clustered_hits</strong>:</p>
<div style="margin-left: 20px;">
<p>Placeholder</p>
</div>
<p><strong>genes</strong>:</p>
<div style="margin-left: 20px;">
<p>Placeholder</p>
</div>
<p><strong>databases</strong>:</p>
<div style="margin-left: 20px;">
<p>Placeholder</p>
</div>
<p><strong>report_info</strong>:</p>
<div style="margin-left: 20px;">
<p>The argument report_info must be a named list with these mandatory
fields: “omics_data_type”, “data_description”, “data_collection_date”,
“analyst_name”, “contact_info”, “project_name”. The following fields are
optional: “method_description”, “results_summary”, “conclusions”. Any
other fields besides the mandatory and optional fields are not allowed.
All elements of the report_info list must be strings, so character
vectors of length == 1. You can write whatever you want in there, as
long as it is not exceeding 80 characters. However, we recommend writing
descriptive info in there. The fields are self descriptive, but for
example, in the field ‘omics_data_type’, you could write proteomics, to
remind yourself, when you look at the report after 2 years, that this
was about proteomics.</p>
</div>
</div>
<div class="section level3">
<h3 id="optional-arguments-7">Optional arguments<a class="anchor" aria-label="anchor" href="#optional-arguments-7"></a>
</h3>
<p><strong>params</strong>:</p>
<div style="margin-left: 20px;">
<p>Placeholder</p>
</div>
<p><strong>plot_titles</strong>:</p>
<div style="margin-left: 20px;">
<p>Placeholder</p>
</div>
<p><strong>background</strong>:</p>
<div style="margin-left: 20px;">
<p>Placeholder</p>
</div>
<p><strong>report_dir</strong>:</p>
<div style="margin-left: 20px;">
<p>A valid path to a directory (when the dir is not existing yet, it
will be created automatically). The HTML repors will be written to this
directory.</p>
</div>
</div>
<div class="section level3">
<h3 id="returns-7">Returns<a class="anchor" aria-label="anchor" href="#returns-7"></a>
</h3>
<p><strong>plots</strong>:</p>
<div style="margin-left: 20px;">
<p>Placeholder</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Thomas Rauter.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
