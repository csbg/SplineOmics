<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>get-started • SplineOmics</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="get-started">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SplineOmics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/design_limma_design_formula.html">Designing a Limma Design Formula</a>
    </li>
    <li>
      <a href="../articles/Docker_permission_denied.html">Docker_permission_denied</a>
    </li>
    <li>
      <a href="../articles/Docker-instructions.html">Docker-instructions</a>
    </li>
    <li>
      <a href="../articles/get-started.html">get-started</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>get-started</h1>
                        <h4 data-toc-skip class="author">Thomas
Rauter</h4>
            
            <h4 data-toc-skip class="date">10 June, 2024</h4>
      

      <div class="hidden name"><code>get-started.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="about-this-tutorial">About this tutorial<a class="anchor" aria-label="anchor" href="#about-this-tutorial"></a>
</h2>
<p>This tutorial intends to showcase and explain the capabilities of the
<strong>SplineOmics</strong> package by walking through a real and
complete example, from start to finish.</p>
<div class="section level4">
<h4 id="example-overview">Example Overview<a class="anchor" aria-label="anchor" href="#example-overview"></a>
</h4>
<p>The example involves a <strong>time-series proteomics
experiment</strong>, where CHO (chinese hamster ovary) cells were
cultivated in three bioreactors (three biological replicates). The
experiment includes the following setup:</p>
<ul>
<li>Samples were taken both during the <strong>exponential</strong> and
<strong>stationary growth phases</strong>.</li>
<li>Samples were collected in triplicates from each reactor at defined
timepoints relative to cell feeding:
<ul>
<li>60 minutes before feeding</li>
<li>15, 60, 90, 120, and 240 minutes after feeding</li>
</ul>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="analysis-goals">Analysis Goals<a class="anchor" aria-label="anchor" href="#analysis-goals"></a>
</h4>
<p>The main goals of this analysis are:</p>
<ul>
<li>
<strong>Identify proteins with significant temporal
changes</strong>: Out of 7162 cellular proteins, the objective is to
detect which proteins show a significant change over time after the CHO
cells were fed (i.e., the impact of the feeding).</li>
<li>
<strong>Cluster hits based on temporal patterns</strong>: The
proteins (hits) with significant temporal changes will be clustered
according to their time-based patterns.</li>
<li>
<strong>Perform gene set enrichment analysis</strong>: For each
cluster, a gene set enrichment analysis will be performed to determine
if specific biological processes are up- or downregulated after
feeding.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="load-the-packages">Load the packages<a class="anchor" aria-label="anchor" href="#load-the-packages"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SplineOmics</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org" class="external-link">readxl</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-the-files">Load the files<a class="anchor" aria-label="anchor" href="#load-the-files"></a>
</h2>
<p>In this example, the data.xlsx file contains the numeric values (the
intensities) and also the feature descriptions, such as gene and protein
name (= annotation part)</p>
<p>The file meta.xlsx contains the meta information, which are the
descriptions of the columns of the numeric values of data.</p>
<p>(These example files are part of the package and don’t have to be
present on your system).</p>
<p>Please note that this dataset is an actual experimental dataset, but
the annotation information, such as gene names, has been removed since
it is not yet published. Instead, the dataset includes randomly
generated gene symbols and gene names corresponding to Cricetulus
griseus (Chinese Hamster) for each row. This is intended to demonstrate
the functionality of the package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">data_excel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"extdata"</span>,</span>
<span>  <span class="st">"proteomics_data.rds"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"SplineOmics"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>    <span class="st">"extdata"</span>,</span>
<span>    <span class="st">"proteomics_meta.xlsx"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">"SplineOmics"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract the annotation part from the dataframe.</span></span>
<span><span class="va">first_na_col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">data_excel</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">annotation</span> <span class="op">&lt;-</span> <span class="va">data_excel</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">(</span><span class="va">first_na_col</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data_excel</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">data_excel</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4,165 × 40</span></span></span>
<span><span class="co">#&gt;    `Sample ID` `1`   `2`   `3`   `4`   `5`   `6`   `7`   `8`   `9`   `10`  `11` </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Reactor     E09   E10   E12   E09   E10   E12   E09   E10   E12   E09   E10  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Time Point  TP01  TP01  TP01  TP02  TP02  TP02  TP03  TP03  TP03  TP04  TP04 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Phase of F… Expo… Expo… Expo… Expo… Expo… Expo… Expo… Expo… Expo… Expo… Expo…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="color: #BB0000;">NA</span>          15.2… 15.2… 15.3… 15.1… 15.2… 15.0… 15.2… 15.2… 15.2… 15.1… 15.2…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="color: #BB0000;">NA</span>          15.0… 15.1… 15.2… 15.1… 15.1… 15.2… 15.2… 15.3… 15.2… 15.1… 15.1…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="color: #BB0000;">NA</span>          14.5… 14.7… 14.6… 14.5… 14.6… 14.6… 14.5… 14.6… 14.7… 14.5… 14.6…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="color: #BB0000;">NA</span>          16.3… 16.4… 16.4… 16.4… 16.4… 16.4… 16.3… 16.3… 16.4… 16.4… 16.4…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="color: #BB0000;">NA</span>          16.7… 16.7… 16.6… 16.7… 16.7… 16.7… 16.7… 16.7… 16.6… 16.6… 16.7…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="color: #BB0000;">NA</span>          13.8… 13.7… 13.9… 13.9… 13.9… 13.9… 13.9… 13.9… 13.9… 13.9… 13.9…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="color: #BB0000;">NA</span>          21.8… 21.7… 21.6… 21.8… 21.6… 21.5… 21.5… 21.6… 21.5… 21.6… 21.5…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4,155 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 28 more variables: `12` &lt;chr&gt;, `13` &lt;chr&gt;, `14` &lt;chr&gt;, `15` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `16` &lt;chr&gt;, `17` &lt;chr&gt;, `18` &lt;chr&gt;, `19` &lt;chr&gt;, `20` &lt;chr&gt;, `21` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `22` &lt;chr&gt;, `23` &lt;chr&gt;, `24` &lt;chr&gt;, `25` &lt;chr&gt;, `26` &lt;chr&gt;, `27` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `28` &lt;chr&gt;, `29` &lt;chr&gt;, `30` &lt;chr&gt;, `31` &lt;chr&gt;, `32` &lt;chr&gt;, `33` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `34` &lt;chr&gt;, `35` &lt;chr&gt;, `36` &lt;chr&gt;, ...38 &lt;lgl&gt;, Gene_symbol &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Gene_name &lt;chr&gt;</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">annotation</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4,162 × 2</span></span></span>
<span><span class="co">#&gt;    Gene_symbol  Gene_name                                              </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> LOC113838844 cone-rod homeobox protein-like                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Wdr83os      WD repeat domain 83 opposite strand                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Cubn         cubilin                                                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Dynlt1       dynein light chain Tctex-type 1                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Ostc         oligosaccharyltransferase complex non-catalytic subunit</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Unc5cl       unc-5 family C-terminal like                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Cfl1         cofilin 1                                              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> LOC100752202 HEN methyltransferase 1                                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> LOC100755162 acyl-coenzyme A synthetase ACSM5, mitochondrial        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> LOC100768921 40S ribosomal protein S21                              </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4,152 more rows</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">meta</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 36 × 5</span></span></span>
<span><span class="co">#&gt;    Sample.ID            Reactor Time.Point Phase        Time</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> E09_TP01_Exponential E09     TP01       Exponential   -<span style="color: #BB0000;">60</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> E10_TP01_Exponential E10     TP01       Exponential   -<span style="color: #BB0000;">60</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> E12_TP01_Exponential E12     TP01       Exponential   -<span style="color: #BB0000;">60</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> E09_TP02_Exponential E09     TP02       Exponential    15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> E10_TP02_Exponential E10     TP02       Exponential    15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> E12_TP02_Exponential E12     TP02       Exponential    15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> E09_TP03_Exponential E09     TP03       Exponential    60</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> E10_TP03_Exponential E10     TP03       Exponential    60</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> E12_TP03_Exponential E12     TP03       Exponential    60</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> E09_TP04_Exponential E09     TP04       Exponential    90</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 26 more rows</span></span></span></code></pre></div>
<div class="section level3">
<h3 id="bring-the-inputs-into-the-standardized-format">Bring the Inputs into the Standardized Format<a class="anchor" aria-label="anchor" href="#bring-the-inputs-into-the-standardized-format"></a>
</h3>
<p>Since <code>data_excel</code> is not in the format required by the
<strong>SplineOmics</strong> package, it needs some processing. This can
be done with a few commands in R, but if your file has a specific
structure, the function <code><a href="../reference/extract_data.html">extract_data()</a></code> can handle this
automatically.</p>
<div class="section level4">
<h4 id="file-structure-requirements">File Structure Requirements<a class="anchor" aria-label="anchor" href="#file-structure-requirements"></a>
</h4>
<p>If your file looks like the one used here, where:</p>
<ul>
<li>The <strong>data matrix field</strong> is on the left</li>
<li>The <strong>annotation info</strong> is on the right</li>
<li>These fields are separated by one empty column</li>
</ul>
<p>Then, <code><a href="../reference/extract_data.html">extract_data()</a></code> can:</p>
<ul>
<li>
<strong>Identify the data matrix field</strong> and convert it into
a dataframe.</li>
<li>
<strong>Create column headers</strong> from the information written
in the cells above the respective columns of the data matrix field.</li>
<li>
<strong>Assign rowheaders</strong>:
<ul>
<li>If no annotation columns are specified, rowheaders will be
increasing numbers.</li>
<li>If annotation columns are specified (like
<code>"First.Protein.Description"</code> and <code>"ID"</code> in this
example), these will be combined to form the rowheaders (feature
names).</li>
</ul>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="usage-in-plotting">Usage in Plotting<a class="anchor" aria-label="anchor" href="#usage-in-plotting"></a>
</h4>
<p>The generated rowheaders will be used to label any plots where a
feature is shown individually, such as:</p>
<ul>
<li>
<strong>Spline plots</strong> with the datapoints from an individual
feature.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_data.html">extract_data</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_excel</span>,</span>
<span>  feature_name_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gene_name"</span><span class="op">)</span>,</span>
<span>  user_prompt <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="perform-eda-exploratory-data-analysis">Perform EDA (exploratory data analysis)<a class="anchor" aria-label="anchor" href="#perform-eda-exploratory-data-analysis"></a>
</h2>
<p>The first step in analyzing data is typically <strong>Exploratory
Data Analysis (EDA)</strong>. EDA involves summarizing the main
characteristics of the data, often through visualizations.</p>
<div class="section level4">
<h4 id="common-eda-plots">Common EDA Plots<a class="anchor" aria-label="anchor" href="#common-eda-plots"></a>
</h4>
<p>Some common types of EDA plots include:</p>
<ul>
<li><strong>Density distributions</strong></li>
<li><strong>Boxplots</strong></li>
<li><strong>PCA (Principal Component Analysis)</strong></li>
<li><strong>Correlation heatmaps</strong></li>
</ul>
</div>
<div class="section level4">
<h4 id="using-explore_data-for-eda">Using <code>explore_data()</code> for EDA<a class="anchor" aria-label="anchor" href="#using-explore_data-for-eda"></a>
</h4>
<p>The <strong>SplineOmics</strong> package provides the function
<code><a href="../reference/explore_data.html">explore_data()</a></code> to perform EDA. This function requires the
following arguments:</p>
<ul>
<li>
<strong>data</strong>: The data matrix.</li>
<li>
<strong>meta</strong>: The metadata table.</li>
<li>
<strong>condition</strong>: The name of the column in the metadata
that contains the levels of the experiment (e.g., “Exponential” and
“Stationary”).</li>
<li>
<strong>report_info</strong>: A list that contains general
information about the analysis.</li>
</ul>
</div>
<div class="section level4">
<h4 id="optional-arguments">Optional Arguments<a class="anchor" aria-label="anchor" href="#optional-arguments"></a>
</h4>
<p>In addition to the required arguments, <code><a href="../reference/explore_data.html">explore_data()</a></code>
offers several optional arguments:</p>
<ul>
<li><p><strong>meta_batch_column</strong>: The name of the column that
contains the first batch effect.</p></li>
<li>
<p><strong>meta_batch2_column</strong>: The name of the column that
contains the second batch effect.</p>
<p>If at least one batch column is provided, the function will:</p>
<ul>
<li>Use the <code>removeBatchEffect()</code> function from
<strong>limma</strong> to remove the batch effect from the data before
plotting.</li>
<li>Generate two EDA HTML reports: one for the <strong>uncorrected
data</strong> and one for the <strong>batch-corrected
data</strong>.</li>
</ul>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="output-and-report-options">Output and Report Options<a class="anchor" aria-label="anchor" href="#output-and-report-options"></a>
</h4>
<ul>
<li>By default, the reports are saved in the <strong>current working
directory</strong>, but this location can be changed using the
<code>report_dir</code> argument.</li>
<li>The function also <strong>returns all plots</strong> generated
during the analysis.</li>
<li>If you do not want a report to be generated, you can set the
<code>report</code> argument to <code>FALSE</code>.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">report_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  omics_data_type <span class="op">=</span> <span class="st">"PTX"</span>,</span>
<span>  data_description <span class="op">=</span> <span class="st">"Proteomics data of CHO cells"</span>,</span>
<span>  data_collection_date <span class="op">=</span> <span class="st">"February 2024"</span>,</span>
<span>  analyst_name <span class="op">=</span> <span class="st">"Thomas Rauter"</span>,</span>
<span>  contact_info <span class="op">=</span> <span class="st">"thomas.rauter@plus.ac.at"</span>,</span>
<span>  project_name <span class="op">=</span> <span class="st">"DGTX"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">report_dir</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span></span>
<span>  <span class="st">"results"</span>,</span>
<span>  <span class="st">"explore_data"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">splineomics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_splineomics.html">create_splineomics</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  meta <span class="op">=</span> <span class="va">meta</span>,</span>
<span>  annotation <span class="op">=</span> <span class="va">annotation</span>,</span>
<span>  report_info <span class="op">=</span> <span class="va">report_info</span>,</span>
<span>  condition <span class="op">=</span> <span class="st">"Phase"</span>,</span>
<span>  meta_batch_column <span class="op">=</span> <span class="st">"Reactor"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/explore_data.html">explore_data</a></span><span class="op">(</span></span>
<span>  splineomics <span class="op">=</span> <span class="va">splineomics</span>,</span>
<span>  report_dir <span class="op">=</span> <span class="va">report_dir</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="finding-the-best-hyperparameters">Finding the Best Hyperparameters<a class="anchor" aria-label="anchor" href="#finding-the-best-hyperparameters"></a>
</h3>
<p>Before running the <strong>limma spline analysis</strong>, it is
important to find the best “hyperparameters”. In this context,
hyperparameters include:</p>
<ul>
<li><strong>Degree of freedom (DoF)</strong></li>
<li>
<strong>Different versions of the data</strong> (e.g., outlier
removed vs. not removed)</li>
<li><strong>Different limma design formulas</strong></li>
</ul>
<div class="section level4">
<h4 id="challenge-of-hyperparameter-selection">Challenge of Hyperparameter Selection<a class="anchor" aria-label="anchor" href="#challenge-of-hyperparameter-selection"></a>
</h4>
<p>Rationally determining the best combination of hyperparameters can be
very challenging. Instead of manually selecting combinations, it is
often more effective to try out multiple combinations and choose the
best-performing one.</p>
</div>
<div class="section level4">
<h4 id="using-screen_limma_hyperparams">Using <code>screen_limma_hyperparams()</code><a class="anchor" aria-label="anchor" href="#using-screen_limma_hyperparams"></a>
</h4>
<p>The function <code><a href="../reference/screen_limma_hyperparams.html">screen_limma_hyperparams()</a></code> automates the
process of testing different combinations of hyperparameters. Here’s how
it works:</p>
<ul>
<li>
<strong>Specify values</strong>: For each hyperparameter, you can
specify all the values you want to test.</li>
<li>
<strong>Run combinations</strong>: The function runs the
<strong>limma spline analysis</strong> with combinations formed from the
hyperparameters you’ve provided.</li>
</ul>
</div>
<div class="section level4">
<h4 id="inner-vs--outer-hyperparameters">Inner vs. Outer Hyperparameters<a class="anchor" aria-label="anchor" href="#inner-vs--outer-hyperparameters"></a>
</h4>
<p>Not every possible combination is generated. Instead, there are
<strong>inner</strong> and <strong>outer</strong> hyperparameters:</p>
<ul>
<li>
<strong>Outer hyperparameters</strong>: These include things like
<strong>different versions of the dataset</strong> (e.g., full dataset
vs. dataset with outliers removed).
<ul>
<li>All possible combinations of outer hyperparameters are
generated.</li>
</ul>
</li>
<li>
<strong>Inner hyperparameters</strong>: These include
<strong>adjusted p-value thresholds</strong> and <strong>spline
parameters</strong> (e.g., degree of freedom).
<ul>
<li>For each version of the data (outer hyperparameter), all
combinations of inner hyperparameters are tested.</li>
</ul>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h4>
<p>For example, if you have two versions of a dataset (one full dataset,
and one with some outliers removed), these versions are considered outer
hyperparameters. The function will generate comparisons for both
versions of the dataset.</p>
<p>For each version, let’s say you specify the following inner
hyperparameters:</p>
<ul>
<li>
<strong>Spline parameters</strong>: Natural cubic splines with a
degree of freedom of either 2 or 3.</li>
<li>
<strong>Adjusted p-value threshold</strong>: 0.05 or 0.1.</li>
</ul>
<p>The function will generate and test all combinations of the spline
parameters and p-value thresholds for both versions of the data:</p>
<ul>
<li><strong>DoF = 2, threshold = 0.05</strong></li>
<li><strong>DoF = 3, threshold = 0.05</strong></li>
<li><strong>DoF = 2, threshold = 0.1</strong></li>
<li><strong>DoF = 3, threshold = 0.1</strong></li>
</ul>
<p>This allows you to systematically explore different combinations and
select the optimal hyperparameters for your analysis.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data1</span> <span class="op">&lt;-</span> <span class="va">data</span> </span>
<span><span class="va">meta1</span> <span class="op">&lt;-</span> <span class="va">meta</span></span>
<span></span>
<span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span>, <span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"E12_TP05_Exponential"</span>, </span>
<span>  <span class="st">"E10_TP10_Stationary"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">]</span></span>
<span><span class="va">meta2</span> <span class="op">&lt;-</span> <span class="va">meta</span><span class="op">[</span><span class="op">!</span><span class="va">meta</span><span class="op">$</span><span class="va">`Sample.ID`</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"E12_TP05_Exponential"</span>, </span>
<span>  <span class="st">"E10_TP10_Stationary"</span></span>
<span>  <span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">datas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">data1</span>, <span class="va">data2</span><span class="op">)</span> </span>
<span><span class="va">datas_descr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"full_data"</span>,</span>
<span>  <span class="st">"outliers_removed"</span></span>
<span>  <span class="op">)</span> </span>
<span></span>
<span><span class="va">metas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">meta1</span>, <span class="va">meta2</span><span class="op">)</span> </span>
<span><span class="va">designs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"~ 1 + Phase*X + Reactor"</span>,</span>
<span>  <span class="st">"~ 1 + X + Reactor"</span></span>
<span>  <span class="op">)</span> </span>
<span><span class="va">condition</span> <span class="op">&lt;-</span> <span class="st">"Phase"</span> </span>
<span><span class="va">report_dir</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span></span>
<span>  <span class="st">"results"</span>,</span>
<span>  <span class="st">"hyperparams_screen_reports"</span></span>
<span>  <span class="op">)</span> </span>
<span><span class="va">meta_batch_column</span> <span class="op">=</span> <span class="st">"Reactor"</span> </span>
<span><span class="va">pthresholds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0.05</span>,</span>
<span>  <span class="fl">0.1</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a dataframe with combinations of spline parameters to test</span></span>
<span><span class="co"># (every row a combo to test)</span></span>
<span><span class="va">spline_test_configs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>   <span class="co"># 'n' stands for natural cubic splines, b for B-splines.</span></span>
<span>  spline_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"n"</span>, <span class="st">"b"</span>, <span class="st">"b"</span><span class="op">)</span>,  </span>
<span>  <span class="co"># Degree is not applicable (NA) for natural splines.</span></span>
<span>  degree <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">2L</span>, <span class="fl">4L</span><span class="op">)</span>,           </span>
<span>  <span class="co"># Degrees of freedom (DoF) to test.</span></span>
<span>  <span class="co"># Higher dof means spline can fit more complex patterns.</span></span>
<span>  dof <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">3L</span>, <span class="fl">3L</span>, <span class="fl">4L</span><span class="op">)</span>         </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">spline_test_configs</span><span class="op">)</span></span>
<span><span class="co">#&gt;   spline_type degree dof</span></span>
<span><span class="co">#&gt; 1           n     NA   2</span></span>
<span><span class="co">#&gt; 2           n     NA   3</span></span>
<span><span class="co">#&gt; 3           b      2   3</span></span>
<span><span class="co">#&gt; 4           b      4   4</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/screen_limma_hyperparams.html">screen_limma_hyperparams</a></span><span class="op">(</span></span>
<span>  <span class="va">splineomics</span>,</span>
<span>  <span class="va">datas</span>,</span>
<span>  <span class="va">datas_descr</span>,</span>
<span>  <span class="va">metas</span>,</span>
<span>  <span class="va">designs</span>,</span>
<span>  <span class="va">spline_test_configs</span>,</span>
<span>  <span class="va">report_dir</span>,</span>
<span>  <span class="va">pthresholds</span>,</span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>You can view an example report <a href="https://github.com/csbg/SplineOmics_html_reports/raw/97b73e1cf1353df11a9035f576b98167699cf03c/Data_1_Design_1_vs_Data_1_Design_2_PTX_19_09_2024-13_44_10.html" class="external-link">here</a></p>
<p>This report contains the results for the comparison of the “outer”
hyperparameters data 1 and design (formula) 1 against data 1 and design
2. For both of those, all combinations of the “inner” hyperparameters
are generated (every possible combination of all specified adj. p-value
thresholds and spline configs).</p>
<p>The encoding of this is <a href="https://github.com/csbg/SplineOmics_html_reports/blob/97b73e1cf1353df11a9035f576b98167699cf03c/hyperparams_screen_meta_table_19_09_2024-13_44_10.html" class="external-link">here</a>
(This is part of the output of the screen_limma_hyperparams
function).</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="run-limma-spline-analysis">Run limma spline analysis<a class="anchor" aria-label="anchor" href="#run-limma-spline-analysis"></a>
</h2>
<p>Once we identified the hyperparameters that are likely the best ones,
we can run the limma spline analysis with them and get the results.</p>
<p>Lets just assume for now that the new parameters, with which the
SplineOmics object is updated, are the best for this analysis. The
choice depends on the analysis. For example, for this analysis, natural
cubic splines (n) with a dof of two seemed to fit the data best (not
overfitting, but also not underfitting), which was the reason those
spline parameters were chosen.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">splineomics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/update_splineomics.html">update_splineomics</a></span><span class="op">(</span></span>
<span>  splineomics <span class="op">=</span> <span class="va">splineomics</span>,</span>
<span>  design <span class="op">=</span> <span class="st">"~ 1 + Phase*X + Reactor"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data2</span>, </span>
<span>  meta <span class="op">=</span> <span class="va">meta2</span>,  </span>
<span>  spline_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    spline_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span><span class="op">)</span>,   </span>
<span>    dof <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Run the limma spline analysis</span></span>
<span><span class="va">splineomics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_limma_splines.html">run_limma_splines</a></span><span class="op">(</span></span>
<span>  <span class="va">splineomics</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Interaction terms identified in limma design formula. Selecting mode == integrated. This means that all levels are analysed using the full data.</span></span>
<span><span class="co">#&gt; Column 'Reactor' of meta will be used to remove the batch effect for the plotting</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Info</span> limma spline analysis completed successfully</span></span></code></pre></div>
<p>The output of the function run_limma_splines() is a named list, where
each element is a specific “category” of results. Refer to <a href="../inst/descriptions/limma_result_categories.pdf">this
document</a> for an explanation of the different result categories. Each
of those elements is a list, containing as elements the respective limma
topTables, either for each level or each comparison between two
levels.</p>
<p>The element “time_effect” is a list, where each element is the
topTable where the p-value for each feature for the respective level are
reported.</p>
<p>The element “avrg_diff_conditions” is a list that contains as
elements the topTables, that represent the comparison of the average
differences of the levels.</p>
<p>The element “interaction_condition_time” is a list that contains as
elements the topTables, that represent the interaction between the
levels (which includes both time and the average differences)</p>
</div>
<div class="section level2">
<h2 id="build-limma-report">Build limma report<a class="anchor" aria-label="anchor" href="#build-limma-report"></a>
</h2>
<p>The topTables of all three categories can be used to generate p-value
histograms an volcano plots.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">report_dir</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span></span>
<span>  <span class="st">"results"</span>,</span>
<span>  <span class="st">"create_limma_reports"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_limma_report.html">create_limma_report</a></span><span class="op">(</span></span>
<span>  <span class="va">splineomics</span>,</span>
<span>  report_dir <span class="op">=</span> <span class="va">report_dir</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>You can view the generated analysis report of the create_limma_report
function <a href="https://github.com/csbg/SplineOmics_html_reports/raw/97b73e1cf1353df11a9035f576b98167699cf03c/create_limma_report_PTX_19_09_2024-13_47_02.html" class="external-link">here</a>.</p>
</div>
<div class="section level2">
<h2 id="cluster-the-hits-significant-features">Cluster the hits (significant features)<a class="anchor" aria-label="anchor" href="#cluster-the-hits-significant-features"></a>
</h2>
<p>After we obtained the limma spline results, we can cluster the hits
based on their temporal pattern (their spline shape). We define what a
hit is by setting an adj. p-value threshold for every level. Then,
hierarchical clustering is used to place every hit in one of as many
clusters as we have specified for that specific level.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adj_pthresholds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0.05</span>,</span>
<span>  <span class="fl">0.05</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">6L</span>,</span>
<span>  <span class="fl">3L</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">report_dir</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span></span>
<span>  <span class="st">"results"</span>,</span>
<span>  <span class="st">"clustering_reports"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plot_info</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  y_axis_label <span class="op">=</span> <span class="st">"log2 intensity"</span>,</span>
<span>  time_unit <span class="op">=</span> <span class="st">"min"</span>,</span>
<span>  treatment_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Feeding"</span><span class="op">)</span>,</span>
<span>  treatment_timepoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">gene_column_name</span> <span class="op">&lt;-</span> <span class="st">"Gene_symbol"</span></span>
<span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="va">data_excel</span><span class="op">[[</span><span class="va">gene_column_name</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_excel</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">clustering_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cluster_hits.html">cluster_hits</a></span><span class="op">(</span></span>
<span>  splineomics <span class="op">=</span> <span class="va">splineomics</span>,</span>
<span>  analysis_type <span class="op">=</span> <span class="st">"time_effect"</span>,</span>
<span>  adj_pthresholds <span class="op">=</span> <span class="va">adj_pthresholds</span>,</span>
<span>  clusters <span class="op">=</span> <span class="va">clusters</span>,</span>
<span>  genes <span class="op">=</span> <span class="va">genes</span>,</span>
<span>  plot_info <span class="op">=</span> <span class="va">plot_info</span>,</span>
<span>  report_dir <span class="op">=</span> <span class="va">report_dir</span>,</span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>You can view the generated analysis report of the cluster_hits
function <a href="https://github.com/csbg/SplineOmics_html_reports/raw/97b73e1cf1353df11a9035f576b98167699cf03c/report_clustered_hits_PTX_19_09_2024-13_47_08.html" class="external-link">here</a>.</p>
</div>
<div class="section level2">
<h2 id="perform-gene-set-enrichment-analysis-gsea">Perform gene set enrichment analysis (GSEA)<a class="anchor" aria-label="anchor" href="#perform-gene-set-enrichment-analysis-gsea"></a>
</h2>
<p>To each clustered hit, the respective gene can be assigned and GSEA
performed. For this, the Enrichr databases of choice have to be
downloaded:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_set_lib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"WikiPathways_2019_Human"</span>,</span>
<span>  <span class="st">"NCI-Nature_2016"</span>,</span>
<span>  <span class="st">"TRRUST_Transcription_Factors_2019"</span>,</span>
<span>  <span class="st">"MSigDB_Hallmark_2020"</span>,</span>
<span>  <span class="st">"GO_Cellular_Component_2018"</span>,</span>
<span>  <span class="st">"CORUM"</span>,</span>
<span>  <span class="st">"KEGG_2019_Human"</span>,</span>
<span>  <span class="st">"TRANSFAC_and_JASPAR_PWMs"</span>,</span>
<span>  <span class="st">"ENCODE_and_ChEA_Consensus_TFs_from_ChIP-X"</span>,</span>
<span>  <span class="st">"GO_Biological_Process_2018"</span>,</span>
<span>  <span class="st">"GO_Molecular_Function_2018"</span>,</span>
<span>  <span class="st">"Human_Gene_Atlas"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/download_enrichr_databases.html">download_enrichr_databases</a></span><span class="op">(</span><span class="va">gene_set_lib</span><span class="op">)</span></span></code></pre></div>
<p>Per default the file is placed in the current working directory,
which is the root dir of the R project.</p>
<p>To run GSEA, the downloaded database file has to be loaded as a
dataframe. Further, optionally, the clusterProfiler parameters and the
report dir can be specified. The function create_gsea_report() runs GSEA
using clusterProfiler, generates an HTML report and returns the GSEA
dotplots in R.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">downloaded_dbs_filepath</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"all_databases_08_04_2024-12_41_50.tsv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">databases</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span></span>
<span>  <span class="va">downloaded_dbs_filepath</span>,</span>
<span>  col_types <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html" class="external-link">cols</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">clusterProfiler_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  adj_p_value <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  pAdjustMethod <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>  minGSSize <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  maxGSSize <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  qvalueCutoff <span class="op">=</span> <span class="fl">0.2</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">report_dir</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span></span>
<span>  <span class="st">"results"</span>,</span>
<span>  <span class="st">"gsea_reports"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">create_gsea_report</span><span class="op">(</span></span>
<span>  levels_clustered_hits <span class="op">=</span> <span class="va">clustering_results</span><span class="op">$</span><span class="va">clustered_hits_levels</span>,</span>
<span>  databases <span class="op">=</span> <span class="va">databases</span>,</span>
<span>  params <span class="op">=</span> <span class="va">clusterProfiler_params</span>,</span>
<span>  report_info <span class="op">=</span> <span class="va">report_info</span>,</span>
<span>  report_dir <span class="op">=</span> <span class="va">report_dir</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>You can view the generated analysis report of the cluster_hits
function <a href="https://github.com/csbg/SplineOmics_html_reports/raw/97b73e1cf1353df11a9035f576b98167699cf03c/create_gsea_report_PTX_19_09_2024-13_47_33.html" class="external-link">here</a>.</p>
<p>Every row in the dotplots is a term from a specific database, and the
columns are the respective clusters. The color scale contains the info
about the odds ratio and the size the -log10 adj. p-value. Only terms
that have &gt; 2 genes as support are included in the plot. Further, for
each cluster, just maximally 5 terms are shown (the terms with the
highest odds ratios). Note that when for example cluster 1 already has 5
terms, and cluster 2 does not, and gets a term which was also found for
cluster 1, than this term would be included as the sixth term for
cluster 1, so this is a way the maximum of 5 can be exceeded.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Thomas Rauter.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
