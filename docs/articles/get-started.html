<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>get-started • SplineOmics</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="get-started">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SplineOmics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/design_limma_design_formula.html">Designing a Limma Design Formula</a></li>
    <li><a class="dropdown-item" href="../articles/Docker_permission_denied.html">Docker_permission_denied</a></li>
    <li><a class="dropdown-item" href="../articles/Docker-instructions.html">Docker-instructions</a></li>
    <li><a class="dropdown-item" href="../articles/get-started.html">get-started</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>get-started</h1>
                        <h4 data-toc-skip class="author">Thomas
Rauter</h4>
            
            <h4 data-toc-skip class="date">20 September, 2024</h4>
      

      <div class="d-none name"><code>get-started.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="about-this-tutorial">About this tutorial<a class="anchor" aria-label="anchor" href="#about-this-tutorial"></a>
</h2>
<p>This tutorial intends to showcase and explain the capabilities of the
<strong>SplineOmics</strong> package by walking through a real and
complete example, from start to finish.</p>
<div class="section level4">
<h4 id="example-overview">Example Overview<a class="anchor" aria-label="anchor" href="#example-overview"></a>
</h4>
<p>The example involves a <strong>time-series proteomics
experiment</strong>, where CHO (chinese hamster ovary) cells were
cultivated in three bioreactors (three biological replicates). The
experiment includes the following setup:</p>
<ul>
<li>Samples were taken both during the <strong>exponential</strong> and
<strong>stationary growth phases</strong>.</li>
<li>Samples were collected in triplicates from each reactor at defined
timepoints relative to cell feeding:
<ul>
<li>60 minutes before feeding</li>
<li>15, 60, 90, 120, and 240 minutes after feeding</li>
</ul>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="analysis-goals">Analysis Goals<a class="anchor" aria-label="anchor" href="#analysis-goals"></a>
</h4>
<p>The main goals of this analysis are:</p>
<ul>
<li>
<strong>Identify proteins with significant temporal
changes</strong>: Out of 7162 cellular proteins, the objective is to
detect which proteins show a significant change over time after the CHO
cells were fed (i.e., the impact of the feeding).</li>
<li>
<strong>Cluster hits based on temporal patterns</strong>: The
proteins (hits) with significant temporal changes will be clustered
according to their time-based patterns.</li>
<li>
<strong>Perform gene set enrichment analysis</strong>: For each
cluster, a gene set enrichment analysis will be performed to determine
if specific biological processes are up- or downregulated after
feeding.</li>
</ul>
</div>
<div class="section level4">
<h4 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h4>
<p>The documentation of all the <strong>SplineOmics</strong> package
functions can be viewed <a href="https://csbg.github.io/SplineOmics/reference">here</a></p>
</div>
</div>
<div class="section level2">
<h2 id="load-the-packages">Load the packages<a class="anchor" aria-label="anchor" href="#load-the-packages"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://csbg.github.io/SplineOmics">SplineOmics</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org" class="external-link">readxl</a></span><span class="op">)</span>  <span class="co"># for loading Excel files</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span>    <span class="co"># For managing filepaths</span></span>
<span><span class="co">#&gt; here() starts at /home/thomasrauter/Documents/PhD/projects/DGTX/R_packages/SplineOmics</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>   <span class="co"># For data manipulation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-the-files">Load the files<a class="anchor" aria-label="anchor" href="#load-the-files"></a>
</h2>
<p>In this example, the proteomics_data.rds file contains the numeric
values (the intensities) and also the feature descriptions, such as gene
and protein name (= annotation part). Usually, you would load the data
from for example an Excel file, but the .rds file is more compressed,
which is the reason this format was chosen here to limit the size of the
SplineOmics package.</p>
<p>The file meta.xlsx contains the meta information, which are the
descriptions of the columns of the numeric values of data.</p>
<p>(These example files are part of the package and don’t have to be
present on your system).</p>
<p>Please note that this dataset is an actual experimental dataset, but
the annotation information, such as gene names, has been removed since
it was not yet published at the time of making the SplineOmics package
public. Instead, the dataset includes randomly generated gene symbols
and gene names corresponding to Cricetulus griseus (Chinese Hamster) for
each row. This is intended to demonstrate the functionality of the
package.</p>
<p>The left part of data contains the numeric values, and the right part
the annotation info, which can be copied in a separate dataframe, as
shown below.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"extdata"</span>,</span>
<span>  <span class="st">"proteomics_data.rds"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"SplineOmics"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>    <span class="st">"extdata"</span>,</span>
<span>    <span class="st">"proteomics_meta.xlsx"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">"SplineOmics"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract the annotation part from the dataframe.</span></span>
<span><span class="va">first_na_col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">annotation</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">(</span><span class="va">first_na_col</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4,165 × 40</span></span></span>
<span><span class="co">#&gt;    `Sample ID` `1`   `2`   `3`   `4`   `5`   `6`   `7`   `8`   `9`   `10`  `11` </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Reactor     E09   E10   E12   E09   E10   E12   E09   E10   E12   E09   E10  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Time Point  TP01  TP01  TP01  TP02  TP02  TP02  TP03  TP03  TP03  TP04  TP04 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Phase of F… Expo… Expo… Expo… Expo… Expo… Expo… Expo… Expo… Expo… Expo… Expo…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="color: #BB0000;">NA</span>          15.2… 15.2… 15.3… 15.1… 15.2… 15.0… 15.2… 15.2… 15.2… 15.1… 15.2…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="color: #BB0000;">NA</span>          15.0… 15.1… 15.2… 15.1… 15.1… 15.2… 15.2… 15.3… 15.2… 15.1… 15.1…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="color: #BB0000;">NA</span>          14.5… 14.7… 14.6… 14.5… 14.6… 14.6… 14.5… 14.6… 14.7… 14.5… 14.6…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="color: #BB0000;">NA</span>          16.3… 16.4… 16.4… 16.4… 16.4… 16.4… 16.3… 16.3… 16.4… 16.4… 16.4…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="color: #BB0000;">NA</span>          16.7… 16.7… 16.6… 16.7… 16.7… 16.7… 16.7… 16.7… 16.6… 16.6… 16.7…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="color: #BB0000;">NA</span>          13.8… 13.7… 13.9… 13.9… 13.9… 13.9… 13.9… 13.9… 13.9… 13.9… 13.9…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="color: #BB0000;">NA</span>          21.8… 21.7… 21.6… 21.8… 21.6… 21.5… 21.5… 21.6… 21.5… 21.6… 21.5…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4,155 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 28 more variables: `12` &lt;chr&gt;, `13` &lt;chr&gt;, `14` &lt;chr&gt;, `15` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `16` &lt;chr&gt;, `17` &lt;chr&gt;, `18` &lt;chr&gt;, `19` &lt;chr&gt;, `20` &lt;chr&gt;, `21` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `22` &lt;chr&gt;, `23` &lt;chr&gt;, `24` &lt;chr&gt;, `25` &lt;chr&gt;, `26` &lt;chr&gt;, `27` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `28` &lt;chr&gt;, `29` &lt;chr&gt;, `30` &lt;chr&gt;, `31` &lt;chr&gt;, `32` &lt;chr&gt;, `33` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `34` &lt;chr&gt;, `35` &lt;chr&gt;, `36` &lt;chr&gt;, ...38 &lt;lgl&gt;, Gene_symbol &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Gene_name &lt;chr&gt;</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">meta</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 36 × 5</span></span></span>
<span><span class="co">#&gt;    Sample.ID            Reactor Time.Point Phase        Time</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> E09_TP01_Exponential E09     TP01       Exponential   -<span style="color: #BB0000;">60</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> E10_TP01_Exponential E10     TP01       Exponential   -<span style="color: #BB0000;">60</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> E12_TP01_Exponential E12     TP01       Exponential   -<span style="color: #BB0000;">60</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> E09_TP02_Exponential E09     TP02       Exponential    15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> E10_TP02_Exponential E10     TP02       Exponential    15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> E12_TP02_Exponential E12     TP02       Exponential    15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> E09_TP03_Exponential E09     TP03       Exponential    60</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> E10_TP03_Exponential E10     TP03       Exponential    60</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> E12_TP03_Exponential E12     TP03       Exponential    60</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> E09_TP04_Exponential E09     TP04       Exponential    90</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 26 more rows</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">annotation</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4,162 × 2</span></span></span>
<span><span class="co">#&gt;    Gene_symbol  Gene_name                                              </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> LOC113838844 cone-rod homeobox protein-like                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Wdr83os      WD repeat domain 83 opposite strand                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Cubn         cubilin                                                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Dynlt1       dynein light chain Tctex-type 1                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Ostc         oligosaccharyltransferase complex non-catalytic subunit</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Unc5cl       unc-5 family C-terminal like                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Cfl1         cofilin 1                                              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> LOC100752202 HEN methyltransferase 1                                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> LOC100755162 acyl-coenzyme A synthetase ACSM5, mitochondrial        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> LOC100768921 40S ribosomal protein S21                              </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4,152 more rows</span></span></span></code></pre></div>
<div class="section level3">
<h3 id="bring-the-inputs-into-the-standardized-format">Bring the Inputs into the Standardized Format<a class="anchor" aria-label="anchor" href="#bring-the-inputs-into-the-standardized-format"></a>
</h3>
<p>Since <code>data</code> is not in the format required by the
<strong>SplineOmics</strong> package, it needs some processing. The
SplineOmics package requires data to be a numeric matrix, so no element
is allowed to be anything else than a number. This can be done with a
few commands in R, but if your file has a specific structure, the
function <code><a href="../reference/extract_data.html">extract_data()</a></code> can handle this automatically.</p>
<div class="section level4">
<h4 id="file-structure-requirements">File Structure Requirements<a class="anchor" aria-label="anchor" href="#file-structure-requirements"></a>
</h4>
<p>If your file looks like the one used here, where:</p>
<ul>
<li>The <strong>data matrix field</strong> is on the left</li>
<li>The <strong>annotation info</strong> is on the right</li>
<li>These fields are separated by one empty column</li>
</ul>
</div>
<div class="section level4">
<h4 id="usage-of-the-extract_data-function">Usage of the extract_data() function<a class="anchor" aria-label="anchor" href="#usage-of-the-extract_data-function"></a>
</h4>
<p>Then, <code><a href="../reference/extract_data.html">extract_data()</a></code> can:</p>
<ul>
<li>
<strong>Identify the data matrix field</strong> and return it as a
numeric matrix.</li>
<li>
<strong>Create column headers</strong> from the information written
in the cells above the respective columns of the data matrix field.</li>
<li>
<strong>Assign rowheaders</strong>:
<ul>
<li>If no annotation columns are specified, rowheaders will be
increasing numbers.</li>
<li>If annotation columns are specified (like
<code>"First.Protein.Description"</code> and <code>"ID"</code> in this
example), these will be combined to form the rowheaders (feature
names).</li>
</ul>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="usage-in-plotting">Usage in Plotting<a class="anchor" aria-label="anchor" href="#usage-in-plotting"></a>
</h4>
<p>The generated rowheaders will be used to label any plots where a
feature is shown individually, such as:</p>
<ul>
<li>
<strong>Spline plots</strong> with the datapoints from an individual
feature.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/extract_data.html">extract_data</a></span><span class="op">(</span></span>
<span>  <span class="co"># The dataframe with the numbers on the left and info on the right.</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  <span class="co"># Use this annotation column for the feature names.</span></span>
<span>  feature_name_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gene_name"</span><span class="op">)</span>,  </span>
<span>  <span class="co"># When TRUE, you must confirm that data is in the required format.</span></span>
<span>  user_prompt <span class="op">=</span> <span class="cn">FALSE</span>   </span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="perform-eda-exploratory-data-analysis">Perform EDA (exploratory data analysis)<a class="anchor" aria-label="anchor" href="#perform-eda-exploratory-data-analysis"></a>
</h2>
<p>Now that we have the data in the required format (numeric matrix) we
can go on.</p>
<p>The first step in analyzing data is typically <strong>Exploratory
Data Analysis (EDA)</strong>. EDA involves summarizing the main
characteristics of the data, often through visualizations.</p>
<div class="section level4">
<h4 id="common-eda-plots">Common EDA Plots<a class="anchor" aria-label="anchor" href="#common-eda-plots"></a>
</h4>
<p>Some common types of EDA plots include:</p>
<ul>
<li><strong>Density distributions</strong></li>
<li><strong>Boxplots</strong></li>
<li><strong>PCA (Principal Component Analysis)</strong></li>
<li><strong>Correlation heatmaps</strong></li>
</ul>
<p>Again, you can generate those plots yourself with a few lines of R
code. However, if you prefer, for convenience, the
<code><a href="../reference/explore_data.html">explore_data()</a></code> function can handle this for you.</p>
</div>
<div class="section level4">
<h4 id="using-explore_data-for-eda">Using <code>explore_data()</code> for EDA<a class="anchor" aria-label="anchor" href="#using-explore_data-for-eda"></a>
</h4>
<p>The <strong>SplineOmics</strong> package provides the function
<code><a href="../reference/explore_data.html">explore_data()</a></code> to perform EDA. This function requires the
following arguments:</p>
<ul>
<li>
<strong>data</strong>: The numeric data matrix.</li>
<li>
<strong>meta</strong>: The metadata table.</li>
<li>
<strong>condition</strong>: The name of the column in the metadata
that contains the levels of the experiment (e.g., “Exponential” and
“Stationary”).</li>
<li>
<strong>report_info</strong>: A list that contains general
information about the analysis, such as the name of the analyst and the
datatype (e.g. proteomics)</li>
</ul>
</div>
<div class="section level4">
<h4 id="optional-arguments">Optional Arguments<a class="anchor" aria-label="anchor" href="#optional-arguments"></a>
</h4>
<p>In addition to the required arguments, <code><a href="../reference/explore_data.html">explore_data()</a></code>
offers several optional arguments:</p>
<ul>
<li><p><strong>meta_batch_column</strong>: The name of the column that
contains the first batch effect.</p></li>
<li>
<p><strong>meta_batch2_column</strong>: The name of the column that
contains the second batch effect.</p>
<p>If at least one batch column is provided, the function will:</p>
<ul>
<li>Use the <code>removeBatchEffect()</code> function from
<strong>limma</strong> to remove the batch effect from the data before
plotting.</li>
<li>Generate two EDA HTML reports: one for the <strong>uncorrected
data</strong> and one for the <strong>batch-corrected
data</strong>.</li>
</ul>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="output-and-report-options">Output and Report Options<a class="anchor" aria-label="anchor" href="#output-and-report-options"></a>
</h4>
<ul>
<li>By default, the reports are saved in the <strong>current working
directory</strong>, but this location can be changed using the
<code>report_dir</code> argument.</li>
<li>The function also <strong>returns all plots</strong> generated
during the analysis, so that you can modify them according to your own
needs.</li>
<li>If you do not want a report to be generated, you can set the
<code>report</code> argument to <code>FALSE</code> (when you for example
just want the figures in the R environment)</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Those fields are mandatory, because we believe that when such a report is</span></span>
<span><span class="co"># opened after half a year, those infos can be very helpful. </span></span>
<span><span class="va">report_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  omics_data_type <span class="op">=</span> <span class="st">"PTX"</span>,</span>
<span>  data_description <span class="op">=</span> <span class="st">"Proteomics data of CHO cells"</span>,</span>
<span>  data_collection_date <span class="op">=</span> <span class="st">"February 2024"</span>,</span>
<span>  analyst_name <span class="op">=</span> <span class="st">"Thomas Rauter"</span>,</span>
<span>  contact_info <span class="op">=</span> <span class="st">"thomas.rauter@plus.ac.at"</span>,</span>
<span>  project_name <span class="op">=</span> <span class="st">"DGTX"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">report_dir</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span></span>
<span>  <span class="st">"results"</span>,</span>
<span>  <span class="st">"explore_data"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="splineomics-object">SplineOmics Object<a class="anchor" aria-label="anchor" href="#splineomics-object"></a>
</h3>
<p>In the SplineOmics package, multiple functions take the same
arguments as input. To make this easier and to avoid errors, we decided
that those arguments are not provided individually to the functions, but
are all stored in an R6 object (which is of type ‘SplineOmics’) and then
this object is passed to the functions. Additionally, some functions
generate intermediate output, which is just necessary for the next
function in the workflow, which is then also just passed along by
updating the SplineOmics object. But you don’t have to worry about
this.</p>
<div class="section level4">
<h4 id="functionality">Functionality<a class="anchor" aria-label="anchor" href="#functionality"></a>
</h4>
<p>The SplineOmics object can be seen as a container where all necessary
arguments are stored. Each function retrieves the required arguments
from the object and potentially adds new data or results back into
it.</p>
</div>
<div class="section level4">
<h4 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h4>
<p>The documentation of the function that creates the SplineOmics object
can be found <a href="https://csbg.github.io/SplineOmics/reference/create_splineomics.html">here</a>
and the documentation of the function that updates it [<a href="https://csbg.github.io/SplineOmics/reference/update_splineomics.html">here</a></p>
<p>The documentation for each function that takes the SplineOmics object
as input specifies which arguments must be present in the SplineOmics
object when it is passed to the respective function.</p>
</div>
</div>
<div class="section level3">
<h3 id="required-arguments-create_splineomics">Required Arguments <code>create_splineomics()</code><a class="anchor" aria-label="anchor" href="#required-arguments-create_splineomics"></a>
</h3>
<ul>
<li>
<strong>data</strong>: A matrix with the data</li>
<li>
<strong>meta</strong>: Metadata associated with the data.</li>
<li>
<strong>condition</strong>: Meta column name of the levels (e.g.,
Exponential and Stationary).</li>
</ul>
</div>
<div class="section level3">
<h3 id="optional-arguments-create_splineomics">Optional Arguments <code>create_splineomics()</code><a class="anchor" aria-label="anchor" href="#optional-arguments-create_splineomics"></a>
</h3>
<ul>
<li>
<strong>rna_seq_data</strong>: An object containing the preprocessed
RNA-seq data, such as the output from <code><a href="https://rdrr.io/pkg/limma/man/voom.html" class="external-link">limma::voom</a></code>
function.</li>
<li>
<strong>annotation</strong>: A dataframe with the feature
descriptions of data.</li>
<li>
<strong>report_info</strong>: A list containing general information
about the analysis.</li>
<li>
<strong>meta_batch_column</strong>: Column for meta batch
information.</li>
<li>
<strong>meta_batch2_column</strong>: Column for secondary meta batch
information.</li>
<li>
<strong>design</strong>: A limma design formula</li>
<li>
<strong>spline_params</strong>: Parameters for the spline
functions.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># splineomics now contains the SplineOmics object.</span></span>
<span><span class="va">splineomics</span> <span class="op">&lt;-</span> <span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/create_splineomics.html">create_splineomics</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  meta <span class="op">=</span> <span class="va">meta</span>,</span>
<span>  annotation <span class="op">=</span> <span class="va">annotation</span>,</span>
<span>  report_info <span class="op">=</span> <span class="va">report_info</span>,</span>
<span>  condition <span class="op">=</span> <span class="st">"Phase"</span>,  <span class="co"># Column of meta that contains the levels.</span></span>
<span>  meta_batch_column <span class="op">=</span> <span class="st">"Reactor"</span>  <span class="co"># For batch effect removal</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now that we have the SplineOmics object defined, we can perform our
exploratory data analysis.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/explore_data.html">explore_data</a></span><span class="op">(</span></span>
<span>  splineomics <span class="op">=</span> <span class="va">splineomics</span>,   <span class="co"># SplineOmics object</span></span>
<span>  report_dir <span class="op">=</span> <span class="va">report_dir</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><a href="https://csbg.github.io/SplineOmics_html_reports/explore_data_PTX_19_09_2024-13_43_21.html">Here</a>
you can see the HTML report of the explore_data() function with the NOT
batch-corrected data, and <a href="https://csbg.github.io/SplineOmics_html_reports/explore_batch_corrected_data_PTX_19_09_2024-13_43_21.html">here</a>
the report for the batch-corrected data.</p>
<p>The EDA plots can tell you a range of things. The plots in the HTML
report are grouped into three categories: Distribution and Variability
Analysis, Time Series Analysis, and Dimensionality Reduction and
Clustering.</p>
<p>If you look at the correlation heatmaps in the HTML report, you can
see that the samples E12_TP05_Exponential and E10_TP10_Stationary stick
out. Seeing this, you might want to remove them from the data. You can
test out what happens when you do this, along with testing how other
hyperparameter choices influence the results, with the package function
screen_limma_hyperparams().</p>
</div>
<div class="section level3">
<h3 id="finding-the-best-hyperparameters">Finding the Best Hyperparameters<a class="anchor" aria-label="anchor" href="#finding-the-best-hyperparameters"></a>
</h3>
<p>Before running the <strong>limma spline analysis</strong>, it is
important to find the best “hyperparameters”. In this context,
hyperparameters include:</p>
<ul>
<li><strong>Degree of freedom (DoF)</strong></li>
<li>
<strong>Different versions of the data</strong> (e.g., outlier
removed vs. not removed)</li>
<li><strong>Different limma design formulas</strong></li>
</ul>
<div class="section level4">
<h4 id="challenge-of-hyperparameter-selection">Challenge of Hyperparameter Selection<a class="anchor" aria-label="anchor" href="#challenge-of-hyperparameter-selection"></a>
</h4>
<p>Rationally determining the best combination of hyperparameters can be
very challenging. By rationally, I mean deciding upon the final
hyperparameters without ever testing any, just by scientific reasoning.
It is much easier just testing a few and seeing how they actually
behave. However, manually selecting combinations can be tedious, and you
have to work very systematically, which can be challenging. To solve
this problem, the <code><a href="../reference/screen_limma_hyperparams.html">screen_limma_hyperparams()</a></code> function was
written.</p>
</div>
<div class="section level4">
<h4 id="using-screen_limma_hyperparams">Using <code>screen_limma_hyperparams()</code><a class="anchor" aria-label="anchor" href="#using-screen_limma_hyperparams"></a>
</h4>
<p>The function <code><a href="../reference/screen_limma_hyperparams.html">screen_limma_hyperparams()</a></code> automates the
process of testing different combinations of hyperparameters. Here’s how
it works:</p>
<ul>
<li>
<strong>Specify values</strong>: For each hyperparameter, you can
specify all the values you want to test.</li>
<li>
<strong>Run combinations</strong>: The function runs the
<strong>limma spline analysis</strong> with combinations formed from the
hyperparameters you’ve provided in a semi combinatorial way.</li>
</ul>
</div>
<div class="section level4">
<h4 id="inner-vs--outer-hyperparameters">Inner vs. Outer Hyperparameters<a class="anchor" aria-label="anchor" href="#inner-vs--outer-hyperparameters"></a>
</h4>
<p>Semi combinatorial here means that not every possible combination is
generated. Instead, there are <strong>inner</strong> and
<strong>outer</strong> hyperparameters:</p>
<ul>
<li>
<strong>Outer hyperparameters</strong>: These include things like
<strong>different versions of the dataset</strong> (e.g., full dataset
vs. dataset with outliers removed).
<ul>
<li>All possible combinations of outer hyperparameters are
generated.</li>
</ul>
</li>
<li>
<strong>Inner hyperparameters</strong>: These include
<strong>adjusted p-value thresholds</strong> and <strong>spline
parameters</strong> (e.g., degree of freedom).
<ul>
<li>For each version of the data (outer hyperparameter), all
combinations of inner hyperparameters are tested.</li>
</ul>
</li>
</ul>
<p>This approach is neccessary, because otherwise the amount of combos
would explode.</p>
</div>
<div class="section level4">
<h4 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h4>
<p>For example, if you have two versions of a dataset (one full dataset,
and one with some outliers removed), these versions are considered outer
hyperparameters. Additionaly, lets say, you want to test two different
limma design formulas, formula 1 and 2. The function will test out all
combinations of those outer hyperparameters and compare them with each
other, which results in a total of 6 combinations here:</p>
<ul>
<li><p><strong>Full Dataset Formula 1</strong> vs <strong>Full Dataset
Formula 2</strong></p></li>
<li><p><strong>Full Dataset Formula 1</strong> vs <strong>Outliers
Removed Dataset Formula 1</strong></p></li>
<li><p><strong>Full Dataset Formula 1</strong> vs <strong>Outliers
Removed Dataset Formula 2</strong></p></li>
<li><p><strong>Full Dataset Formula 2</strong> vs <strong>Outliers
Removed Dataset Formula 1</strong></p></li>
<li><p><strong>Full Dataset Formula 2</strong> vs <strong>Outliers
Removed Dataset Formula 2</strong></p></li>
<li><p><strong>Outliers Removed Dataset Formula 1</strong> vs
<strong>Outliers Removed Dataset Formula 2</strong></p></li>
</ul>
<p>Let’s say you specified the following inner hyperparameters:</p>
<ul>
<li>
<strong>Spline parameters</strong>: Natural cubic splines with a
degree of freedom of either 2 or 3.</li>
<li>
<strong>Adjusted p-value threshold</strong>: 0.05 or 0.1.</li>
</ul>
<p>The function will generate and test all combinations of the spline
parameters and p-value thresholds for all 4 combos:</p>
<p>Combo 1:</p>
<ul>
<li><p><strong>DoF = 2, threshold = 0.05</strong></p></li>
<li><p><strong>DoF = 3, threshold = 0.05</strong></p></li>
<li><p><strong>DoF = 2, threshold = 0.1</strong></p></li>
<li><p><strong>DoF = 3, threshold = 0.1</strong></p></li>
</ul>
<p>Combo 2:</p>
<ul>
<li><p><strong>DoF = 2, threshold = 0.05</strong></p></li>
<li><p><strong>DoF = 3, threshold = 0.05</strong></p></li>
<li><p><strong>DoF = 2, threshold = 0.1</strong></p></li>
<li><p><strong>DoF = 3, threshold = 0.1</strong></p></li>
</ul>
<p>Combo 3: …</p>
<p>This allows you to systematically explore different combinations and
select the optimal hyperparameters for your analysis.</p>
<p>Below is an example for our proteomics data:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data1</span> <span class="op">&lt;-</span> <span class="va">data</span> </span>
<span><span class="va">meta1</span> <span class="op">&lt;-</span> <span class="va">meta</span></span>
<span></span>
<span><span class="co"># Remove the "outliers"</span></span>
<span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span>, <span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"E12_TP05_Exponential"</span>, </span>
<span>  <span class="st">"E10_TP10_Stationary"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Adjust meta so that it matches data2</span></span>
<span><span class="va">meta2</span> <span class="op">&lt;-</span> <span class="va">meta</span><span class="op">[</span><span class="op">!</span><span class="va">meta</span><span class="op">$</span><span class="va">`Sample.ID`</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"E12_TP05_Exponential"</span>, </span>
<span>  <span class="st">"E10_TP10_Stationary"</span></span>
<span>  <span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># As mentioned above, all the values of one hyperparameter are stored </span></span>
<span><span class="co"># and provided as a list.</span></span>
<span><span class="va">datas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">data1</span>, <span class="va">data2</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># This will be used to describe the versions of the data.</span></span>
<span><span class="va">datas_descr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"full_data"</span>,</span>
<span>  <span class="st">"outliers_removed"</span></span>
<span>  <span class="op">)</span> </span>
<span></span>
<span><span class="va">metas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">meta1</span>, <span class="va">meta2</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Test two different limma designs</span></span>
<span><span class="va">designs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"~ 1 + Phase*X + Reactor"</span>,</span>
<span>  <span class="st">"~ 1 + X + Reactor"</span></span>
<span>  <span class="op">)</span> </span>
<span></span>
<span><span class="co"># Specify the meta "level" column</span></span>
<span><span class="va">condition</span> <span class="op">&lt;-</span> <span class="st">"Phase"</span> </span>
<span></span>
<span><span class="va">report_dir</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span></span>
<span>  <span class="st">"results"</span>,</span>
<span>  <span class="st">"hyperparams_screen_reports"</span></span>
<span>  <span class="op">)</span> </span>
<span></span>
<span><span class="co"># To remove the batch effect</span></span>
<span><span class="va">meta_batch_column</span> <span class="op">=</span> <span class="st">"Reactor"</span> </span>
<span></span>
<span><span class="co"># Test out two different p-value thresholds (inner hyperparameter)</span></span>
<span><span class="va">pthresholds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0.05</span>,</span>
<span>  <span class="fl">0.1</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a dataframe with combinations of spline parameters to test</span></span>
<span><span class="co"># (every row a combo to test)</span></span>
<span><span class="va">spline_test_configs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>   <span class="co"># 'n' stands for natural cubic splines, b for B-splines.</span></span>
<span>  spline_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"n"</span>, <span class="st">"b"</span>, <span class="st">"b"</span><span class="op">)</span>,  </span>
<span>  <span class="co"># Degree is not applicable (NA) for natural splines.</span></span>
<span>  degree <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">2L</span>, <span class="fl">4L</span><span class="op">)</span>,           </span>
<span>  <span class="co"># Degrees of freedom (DoF) to test.</span></span>
<span>  <span class="co"># Higher dof means spline can fit more complex patterns.</span></span>
<span>  dof <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span>, <span class="fl">3L</span>, <span class="fl">3L</span>, <span class="fl">4L</span><span class="op">)</span>         </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">spline_test_configs</span><span class="op">)</span></span>
<span><span class="co">#&gt;   spline_type degree dof</span></span>
<span><span class="co">#&gt; 1           n     NA   2</span></span>
<span><span class="co">#&gt; 2           n     NA   3</span></span>
<span><span class="co">#&gt; 3           b      2   3</span></span>
<span><span class="co">#&gt; 4           b      4   4</span></span></code></pre></div>
<p>Now that we specified all the values for each hyperparameter that we
want to test, we can run the <code><a href="../reference/screen_limma_hyperparams.html">screen_limma_hyperparams()</a></code>
function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/screen_limma_hyperparams.html">screen_limma_hyperparams</a></span><span class="op">(</span></span>
<span>  <span class="va">splineomics</span>,</span>
<span>  <span class="va">datas</span>,</span>
<span>  <span class="va">datas_descr</span>,</span>
<span>  <span class="va">metas</span>,</span>
<span>  <span class="va">designs</span>,</span>
<span>  <span class="va">spline_test_configs</span>,</span>
<span>  <span class="va">report_dir</span>,</span>
<span>  <span class="va">pthresholds</span>,</span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>As mentioned, this function generates a report for each comparison of
the outer hyperparameters, which are too many to show here. You can view
an example report <a href="https://csbg.github.io/SplineOmics_html_reports/Data_1_Design_1_vs_Data_1_Design_2_PTX_19_09_2024-13_44_10.html">here</a></p>
<p>This report contains the results for the comparison of the “outer”
hyperparameters data 1 and design (formula) 1 compared against data 1
and design 2. For both of those, all combinations of the “inner”
hyperparameters are generated (every possible combination of all
specified adj. p-value thresholds and spline configs).</p>
<p>The encoding used in the reports and the titles is <a href="https://csbg.github.io/SplineOmics_html_reports/hyperparams_screen_meta_table_19_09_2024-13_44_10.html">here</a>
(This is part of the output of the screen_limma_hyperparams
function).</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="run-limma-spline-analysis">Run limma spline analysis<a class="anchor" aria-label="anchor" href="#run-limma-spline-analysis"></a>
</h2>
<p>Once we identified the hyperparameters that are likely the best ones,
we can run the limma spline analysis with them and get the results.</p>
<p>Lets just assume for now that the new parameters, with which the
SplineOmics object is updated, are the best for this analysis. The
choice depends on the analysis. For example, for this analysis, natural
cubic splines (n) with a dof of two seemed to fit the data best (not
overfitting, but also not underfitting), which was the reason those
spline parameters were chosen.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">splineomics</span> <span class="op">&lt;-</span> <span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/update_splineomics.html">update_splineomics</a></span><span class="op">(</span></span>
<span>  splineomics <span class="op">=</span> <span class="va">splineomics</span>,</span>
<span>  design <span class="op">=</span> <span class="st">"~ 1 + Phase*X + Reactor"</span>,  <span class="co"># best design formula</span></span>
<span>  data <span class="op">=</span> <span class="va">data2</span>,   <span class="co"># data without "outliers" was better</span></span>
<span>  meta <span class="op">=</span> <span class="va">meta2</span>,  </span>
<span>  spline_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    spline_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span><span class="op">)</span>,   <span class="co"># natural cubic splines</span></span>
<span>    dof <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2L</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Run the <code><a href="../reference/run_limma_splines.html">run_limma_splines()</a></code> function with the updated
SplineOmics object:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">splineomics</span> <span class="op">&lt;-</span> <span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/run_limma_splines.html">run_limma_splines</a></span><span class="op">(</span></span>
<span>  <span class="va">splineomics</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Interaction terms identified in limma design formula. Selecting mode == integrated. This means that all levels are analysed using the full data.</span></span>
<span><span class="co">#&gt; Column 'Reactor' of meta will be used to remove the batch effect for the plotting</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Info</span> limma spline analysis completed successfully</span></span></code></pre></div>
<p>The output of the function run_limma_splines() is a named list, where
each element is a specific “category” of results. Refer to <a href="https://csbg.github.io/SplineOmics/articles/limma_result_categories.html">this
document</a> for an explanation of the different result categories. Each
of those elements is a list, containing as elements the respective limma
topTables, either for each level or each comparison between two
levels.</p>
<p>The element “time_effect” is a list, where each element is the
topTable where the p-value for each feature for the respective level are
reported.</p>
<p>The element “avrg_diff_conditions” is a list that contains as
elements the topTables, that represent the comparison of the average
differences of the levels.</p>
<p>The element “interaction_condition_time” is a list that contains as
elements the topTables, that represent the interaction between the
levels (which includes both time and the average differences)</p>
</div>
<div class="section level2">
<h2 id="build-limma-report">Build limma report<a class="anchor" aria-label="anchor" href="#build-limma-report"></a>
</h2>
<p>The topTables of all three categories can be used to generate p-value
histograms an volcano plots.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">report_dir</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span></span>
<span>  <span class="st">"results"</span>,</span>
<span>  <span class="st">"create_limma_reports"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/create_limma_report.html">create_limma_report</a></span><span class="op">(</span></span>
<span>  <span class="va">splineomics</span>,</span>
<span>  report_dir <span class="op">=</span> <span class="va">report_dir</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>You can view the generated analysis report of the create_limma_report
function <a href="https://csbg.github.io/SplineOmics_html_reports/create_limma_report_PTX_19_09_2024-13_47_02.html">here</a>.</p>
</div>
<div class="section level2">
<h2 id="cluster-the-hits-significant-features">Cluster the hits (significant features)<a class="anchor" aria-label="anchor" href="#cluster-the-hits-significant-features"></a>
</h2>
<p>After we obtained the limma spline results, we can cluster the hits
based on their temporal pattern (their spline shape). We define what a
hit is by setting an adj. p-value threshold for every level. Hits are
features (e.g. proteins) that have an adj. p-value below the threshold.
Hierarchical clustering is used to place every hit in one of as many
clusters as we have specified for that specific level.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">adj_pthresholds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>  <span class="co"># 0.05 for both levels</span></span>
<span>  <span class="fl">0.05</span>,  <span class="co"># exponential</span></span>
<span>  <span class="fl">0.05</span>   <span class="co"># stationary</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">6L</span>,  <span class="co"># 6 clusters for the exponential phase level</span></span>
<span>  <span class="fl">3L</span>   <span class="co"># 3 clusters for the stationary phase level</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">report_dir</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span></span>
<span>  <span class="st">"results"</span>,</span>
<span>  <span class="st">"clustering_reports"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plot_info</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>  <span class="co"># For the spline plots</span></span>
<span>  y_axis_label <span class="op">=</span> <span class="st">"log2 intensity"</span>,</span>
<span>  time_unit <span class="op">=</span> <span class="st">"min"</span>,  <span class="co"># our measurements were in minutes</span></span>
<span>  treatment_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Feeding"</span><span class="op">)</span>,  </span>
<span>  treatment_timepoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>  <span class="co"># Feeding was at 0 minutes.</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get all the gene names. They are used for generating files</span></span>
<span><span class="co"># which contents can be directly used as the input for the Enrichr webtool,</span></span>
<span><span class="co"># if you prefer to manually perform the enrichment. Those files are</span></span>
<span><span class="co"># embedded in the output HTML report and can be downloaded from there.</span></span>
<span><span class="va">gene_column_name</span> <span class="op">&lt;-</span> <span class="st">"Gene_symbol"</span></span>
<span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="va">data_excel</span><span class="op">[[</span><span class="va">gene_column_name</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_excel</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">clustering_results</span> <span class="op">&lt;-</span> <span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/cluster_hits.html">cluster_hits</a></span><span class="op">(</span></span>
<span>  splineomics <span class="op">=</span> <span class="va">splineomics</span>,</span>
<span>  <span class="co"># Cluster the hits from the time_effect results. You can also cluster</span></span>
<span>  <span class="co"># the hits from the other two limma result categories by specifying</span></span>
<span>  <span class="co"># it here with this argument.</span></span>
<span>  analysis_type <span class="op">=</span> <span class="st">"time_effect"</span>,  </span>
<span>  adj_pthresholds <span class="op">=</span> <span class="va">adj_pthresholds</span>,</span>
<span>  clusters <span class="op">=</span> <span class="va">clusters</span>,</span>
<span>  genes <span class="op">=</span> <span class="va">genes</span>,</span>
<span>  plot_info <span class="op">=</span> <span class="va">plot_info</span>,</span>
<span>  report_dir <span class="op">=</span> <span class="va">report_dir</span>,</span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>You can view the generated analysis report of the cluster_hits
function <a href="https://csbg.github.io/SplineOmics_html_reports/report_clustered_hits_PTX_19_09_2024-13_47_08.html">here</a>.</p>
</div>
<div class="section level2">
<h2 id="perform-gene-set-enrichment-analysis-gsea">Perform gene set enrichment analysis (GSEA)<a class="anchor" aria-label="anchor" href="#perform-gene-set-enrichment-analysis-gsea"></a>
</h2>
<p>Usually, the final step in such a bioinformatics analysis is GSEA. To
each clustered hit, the respective gene can be assigned and GSEA
performed. For this, the Enrichr databases of choice have to be
downloaded:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify which databases you want to download from Enrichr</span></span>
<span><span class="va">gene_set_lib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"WikiPathways_2019_Human"</span>,</span>
<span>  <span class="st">"NCI-Nature_2016"</span>,</span>
<span>  <span class="st">"TRRUST_Transcription_Factors_2019"</span>,</span>
<span>  <span class="st">"MSigDB_Hallmark_2020"</span>,</span>
<span>  <span class="st">"GO_Cellular_Component_2018"</span>,</span>
<span>  <span class="st">"CORUM"</span>,</span>
<span>  <span class="st">"KEGG_2019_Human"</span>,</span>
<span>  <span class="st">"TRANSFAC_and_JASPAR_PWMs"</span>,</span>
<span>  <span class="st">"ENCODE_and_ChEA_Consensus_TFs_from_ChIP-X"</span>,</span>
<span>  <span class="st">"GO_Biological_Process_2018"</span>,</span>
<span>  <span class="st">"GO_Molecular_Function_2018"</span>,</span>
<span>  <span class="st">"Human_Gene_Atlas"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/download_enrichr_databases.html">download_enrichr_databases</a></span><span class="op">(</span><span class="va">gene_set_lib</span><span class="op">)</span></span></code></pre></div>
<p>Per default the file is placed in the current working directory,
which is the root dir of the R project.</p>
<p>To run GSEA, the downloaded database file has to be loaded as a
dataframe. Further, optionally, the clusterProfiler parameters and the
report dir can be specified. The function create_gsea_report() runs GSEA
using clusterProfiler, generates an HTML report and returns the GSEA
dotplots in R.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify the filepath of the TSV file with the database info</span></span>
<span><span class="va">downloaded_dbs_filepath</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"all_databases_08_04_2024-12_41_50.tsv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the file</span></span>
<span><span class="va">databases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span></span>
<span>  <span class="va">downloaded_dbs_filepath</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify the clusterProfiler parameters</span></span>
<span><span class="va">clusterProfiler_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  adj_p_value <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  pAdjustMethod <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>  minGSSize <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  maxGSSize <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  qvalueCutoff <span class="op">=</span> <span class="fl">0.2</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">report_dir</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span></span>
<span>  <span class="st">"results"</span>,</span>
<span>  <span class="st">"gsea_reports"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>The function below runs the clusterProfiler for all clusters and all
levels, and generates the HTML report:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/run_gsea.html">run_gsea</a></span><span class="op">(</span></span>
<span>  <span class="co"># A dataframe with three columns: feature, cluster, and gene. Feature contains</span></span>
<span>  <span class="co"># the integer index of the feature, cluster the integer specifying the cluster</span></span>
<span>  <span class="co"># number, and gene the string of the gene, such as "CLSTN2".</span></span>
<span>  levels_clustered_hits <span class="op">=</span> <span class="va">clustering_results</span><span class="op">$</span><span class="va">clustered_hits_levels</span>,</span>
<span>  databases <span class="op">=</span> <span class="va">databases</span>,</span>
<span>  clusterProfiler_params <span class="op">=</span> <span class="va">clusterProfiler_params</span>,</span>
<span>  report_info <span class="op">=</span> <span class="va">report_info</span>,</span>
<span>  report_dir <span class="op">=</span> <span class="va">report_dir</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>You can view the generated analysis report of the cluster_hits
function <a href="https://csbg.github.io/SplineOmics_html_reports/create_gsea_report_PTX_19_09_2024-13_47_33.html">here</a>.</p>
<p>This report first shows all enrichment results, where more than 2
genes supported a term, in a tabular format. The table with all the
terms with &lt; 2 genes supporting it can be downloaded by clicking on a
button below that table.</p>
<p>For the dotplots below that, every row is a term from a specific
database, and the columns are the respective clusters. The color scale
contains the info about the odds ratio and the size the -log10 adj.
p-value. Only terms that have &gt; 2 genes as support are included in
the plot. Further, for each cluster, just maximally 5 terms are shown
(the terms with the highest odds ratios). Note that when for example
cluster 1 already has 5 terms, and cluster 2 does not, and gets a term
which was also found for cluster 1, than this term would be included as
the sixth term for cluster 1, so this is a way the maximum of 5 can be
exceeded.</p>
<p>If a phase, like stationary here, does not lead to any enrichment
results, that is stated with a red message.</p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This example showed most functionalities of the SplineOmics package.
You can also run other datatypes with it, including timeseries RNA-seq
and glycan data (for those, refer to the documentation in the README
file on the GitHub page under Usage/RNA-seq and Glycan Data).</p>
<p>To get an interactive version of this example, download the
SplineOmics package and run the function <code><a href="../reference/open_tutorial.html">open_tutorial()</a></code>
which opens an R Markdown file, where you can run the different code
blocks and if your are working in R Studio (which is recommendet) you
can easily check out the values of the individual variables and generate
the output reports yourself.</p>
<p>When you run the function <code><a href="../reference/open_template.html">open_template()</a></code> you get a
minimal R Markdown file, where the code is written so that you can use
it as a skeleton to plug in your own data and run it.</p>
<p>We hope that the SplineOmics package makes your scientific data
analysis easier. If you face any problems (bugs in the code) or are not
satisfied with the documentation, open an issue on GitHub or check out
the other options under the Feedback section of the README on GitHub.
Thank you!</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Rauter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
