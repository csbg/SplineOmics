<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Changelog • SplineOmics</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Changelog">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SplineOmics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/get_started.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Further use cases</h6></li>
    <li><a class="dropdown-item" href="../articles/RNA-seq-analysis.html">RNA-seq analysis</a></li>
    <li><a class="dropdown-item" href="../articles/glycan-analysis.html">Glycan analysis</a></li>
    <li><a class="dropdown-item" href="../articles/PVC_analysis.html">Peak-Valley-Cliff (PVC) analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Gene_centric_multiomics_clustering.html">Gene-centric multiomics clustering</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/limma_result_categories.html">limma result categories</a></li>
    <li><a class="dropdown-item" href="../articles/design_limma_design_formula.html">Designing a limma design formula</a></li>
    <li><a class="dropdown-item" href="../articles/Docker-instructions.html">Docker container instructions</a></li>
    <li><a class="dropdown-item" href="../articles/Docker_permission_denied.html">Docker permission denied</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/faq.html">FAQ</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/CHANGELOG.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/csbg/SplineOmics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Changelog</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/csbg/SplineOmics/blob/HEAD/vignettes/CHANGELOG.Rmd" class="external-link"><code>vignettes/CHANGELOG.Rmd</code></a></small>
      <div class="d-none name"><code>CHANGELOG.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="changelog">Changelog<a class="anchor" aria-label="anchor" href="#changelog"></a>
</h2>
<p>All notable changes to this project will be documented in this
file.</p>
<p>The format is based on <a href="https://keepachangelog.com/en/1.0.0/" class="external-link">Keep a Changelog</a>, and
this project adheres to <a href="https://semver.org/spec/v2.0.0.html" class="external-link">Semantic Versioning</a>.</p>
<div class="section level3">
<h3 id="template-for-changelog-entries">Template for Changelog Entries<a class="anchor" aria-label="anchor" href="#template-for-changelog-entries"></a>
</h3>
<p>Each release section should follow the structure below:</p>
<div class="section level4">
<h4 id="version---yyyy-mm-dd">[Version] - YYYY-MM-DD<a class="anchor" aria-label="anchor" href="#version---yyyy-mm-dd"></a>
</h4>
<div class="section level5">
<h5 id="added">Added<a class="anchor" aria-label="anchor" href="#added"></a>
</h5>
<ul>
<li>New features or functionality introduced in this release.</li>
</ul>
</div>
<div class="section level5">
<h5 id="changed">Changed<a class="anchor" aria-label="anchor" href="#changed"></a>
</h5>
<ul>
<li>Updates or modifications to existing features.</li>
</ul>
</div>
<div class="section level5">
<h5 id="fixed">Fixed<a class="anchor" aria-label="anchor" href="#fixed"></a>
</h5>
<ul>
<li>Bugs that have been resolved.</li>
</ul>
</div>
<div class="section level5">
<h5 id="deprecated">Deprecated<a class="anchor" aria-label="anchor" href="#deprecated"></a>
</h5>
<ul>
<li>Features that are still functional but are slated for removal in the
future.</li>
</ul>
</div>
<div class="section level5">
<h5 id="removed">Removed<a class="anchor" aria-label="anchor" href="#removed"></a>
</h5>
<ul>
<li>Features or functionality that have been removed.</li>
</ul>
</div>
<div class="section level5">
<h5 id="security">Security<a class="anchor" aria-label="anchor" href="#security"></a>
</h5>
<ul>
<li>Any security-related updates or patches.</li>
</ul>
<hr>
</div>
</div>
<div class="section level4">
<h4 id="v0-4-3-in-preparation">[v0.4.3] (in preparation)<a class="anchor" aria-label="anchor" href="#v0-4-3-in-preparation"></a>
</h4>
<div class="section level5">
<h5 id="added-1">Added<a class="anchor" aria-label="anchor" href="#added-1"></a>
</h5>
<ul>
<li><p>condition_colours support to plot options. Users can now provide
a named list mapping condition levels to colours. When supplied, these
colours override the default condition colours in plots, enabling
consistent and user-defined visual styling across figures.</p></li>
<li><p>min_cluster_r2 pruning with explicit ‘other’ cluster. Introduce
a<br>
min_cluster_r2 parameter to enforce a minimum r²-to-centroid constraint
after k-means clustering.</p></li>
</ul>
</div>
<div class="section level5">
<h5 id="changed-1">Changed<a class="anchor" aria-label="anchor" href="#changed-1"></a>
</h5>
<ul>
<li><p>Quality control reporting and modality normalization in
cluster_genes_multiomics().</p></li>
<li><p>Separated statistical computations and plot/HTML-report
generation for: cluster_hits(), run_ora(), and find_pvc(). Therefore,
the new functions: create_clustering_report(), create_ora_report(), and
create_pvc_report(); are now containing the plotting/HTML-report
generation code for the mentioned statistical functions.</p></li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="v0-4-2">[v0.4.2]<a class="anchor" aria-label="anchor" href="#v0-4-2"></a>
</h4>
<div class="section level5">
<h5 id="added-2">Added<a class="anchor" aria-label="anchor" href="#added-2"></a>
</h5>
<ul>
<li><p><code><a href="../reference/cluster_genes_multiomics.html">cluster_genes_multiomics()</a></code>, a gene-centric
multi-omics clustering function that integrates multiple data modalities
within analytical blocks via weighted gene–gene distance aggregation.
The function returns both per-gene cluster assignments and
modality-specific cluster centroid summaries, enabling interpretation of
cluster structure, coverage, and within-cluster coherence across omics
layers.</p></li>
<li><p><code><a href="../reference/run_ora.html">run_ora()</a></code>: Gene names additional safety
checks</p></li>
</ul>
</div>
<div class="section level5">
<h5 id="fixed-1">Fixed<a class="anchor" aria-label="anchor" href="#fixed-1"></a>
</h5>
<ul>
<li><p><code><a href="../reference/cluster_hits.html">cluster_hits()</a></code>: cT and cDT results sheet
bug</p></li>
<li><p>1 condition bug in <code><a href="../reference/explore_data.html">explore_data()</a></code>.</p></li>
<li><p><code>extract_effect()</code> internal function, made it much
more robustly (had clear weaknesses before)</p></li>
<li><p>Part of the documentation</p></li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="v0-4-1">[v0.4.1]<a class="anchor" aria-label="anchor" href="#v0-4-1"></a>
</h4>
<div class="section level5">
<h5 id="added-3">Added<a class="anchor" aria-label="anchor" href="#added-3"></a>
</h5>
<ul>
<li><p>Effect size thresholds are now reported in the HTML report
generated by the cluster_hits() function.</p></li>
<li><p>Double spline plots now better inform about non significant (ns)
and not relevant (nr) results, and filter better based on this.</p></li>
<li><p>cluster_genes_multiomics(): Gene-centric multi-omics clustering
function that integrates multiple layers per block, supports many-to-one
mappings, computes weighted distance matrices, assigns gene clusters,
and returns centroid-level summaries for visualization. However, this is
still a beta addition, so it might not work as intendet! Also, no
vignette was added yet. This will be done in a future version.</p></li>
</ul>
</div>
<div class="section level5">
<h5 id="fixed-2">Fixed<a class="anchor" aria-label="anchor" href="#fixed-2"></a>
</h5>
<ul>
<li><p>use_array_weights behavior for variancePartition linear mixed
models.</p></li>
<li><p>Non-significant category 2 and 3 results plots shown in HTML
report. This was now fixed (now they are not shown anymore).</p></li>
<li><p>Multi condition bug in the contrasts in run_limma_splines(). For
the average diff condition and interaction condition time results, it
did not correctly create the intended pair contrasts. Now, the code
overall was refactored, and this issue fixed in this refactoring. Now, a
joint contrast matrix L is created before the model is fit, and is used
in the fit for variancePartion, and in the limma case after model
fitting with contrast.fit.</p></li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="v0-4-0">[v0.4.0]<a class="anchor" aria-label="anchor" href="#v0-4-0"></a>
</h4>
<div class="section level5">
<h5 id="changed-2">Changed<a class="anchor" aria-label="anchor" href="#changed-2"></a>
</h5>
<ul>
<li><p>SplineOmics now supports any amount of conditions (values in the
meta condition column).</p></li>
<li><p>adj_pthresholds argument of cluster_hits() renamed to
adj_pthresh_time_effect. Now, it instead requires a single numeric input
specifying the adj. p-value treshold for all conditions (e.g. 0.05), and
does not support anymore setting a separate value for each condition.
This is because using separate values break the uniformity of inference
and introduces uncontrolled type I error inflation.</p></li>
<li><p>plot_info argument of cluster_hits() now does not accept anymore
the value ‘double_spline_plots’ in the treatment_labels and
treatment_timepoints lists. Instead, the treatment lines specified for
the conditions will automatically be applied to all pairwise comparisons
where this condition appears.</p></li>
<li><p>Updated ORA workflow to disable internal filtering, apply
database-wise multiple-testing correction across all clusters via a new
<code>p_adj_by_db</code> column, and use this value for all downstream
significance filtering to ensure consistent FDR control.</p></li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="removed-1">Removed<a class="anchor" aria-label="anchor" href="#removed-1"></a>
</h4>
<ul>
<li>qvalueCutoff value in clusterProfiler_params argument of run_ora().
The reason is that the qvalueCutoff is no longer statistically
meaningfull with the new way the raw p-values are adjusted (see
above).</li>
</ul>
</div>
<div class="section level4">
<h4 id="v0-3-4">[v0.3.4]<a class="anchor" aria-label="anchor" href="#v0-3-4"></a>
</h4>
<div class="section level5">
<h5 id="changed-3">Changed<a class="anchor" aria-label="anchor" href="#changed-3"></a>
</h5>
<ul>
<li><p>Renamed the function download_bioconductor_database() to
extract_gene_sets().</p></li>
<li><p>Stylistic changes to cluster_hits HTML report, such as font sizes
for plots.</p></li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="v0-3-3">[v0.3.3]<a class="anchor" aria-label="anchor" href="#v0-3-3"></a>
</h4>
<div class="section level5">
<h5 id="fixed-3">Fixed<a class="anchor" aria-label="anchor" href="#fixed-3"></a>
</h5>
<ul>
<li>Bugs occuring in the functions extract_data(), explore_data(), and
cluster_hits()</li>
</ul>
</div>
<div class="section level5">
<h5 id="removed-2">Removed<a class="anchor" aria-label="anchor" href="#removed-2"></a>
</h5>
<ul>
<li>Removed the report argument of the cluster_hits() and run_ora()
function. Instead, now, the report_dir argument is per default NULL,
which means that no HTML report is generated. Only when a directory path
is provided with the report_dir argument, a HTML report is
generated.</li>
</ul>
</div>
<div class="section level5">
<h5 id="added-4">Added<a class="anchor" aria-label="anchor" href="#added-4"></a>
</h5>
<ul>
<li>The signed r² as the quality score for the cluster members is now
also written in the downloadable topTables inside the cluster_hits()
HTML report.</li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="v0-3-2">[v0.3.2]<a class="anchor" aria-label="anchor" href="#v0-3-2"></a>
</h4>
<div class="section level5">
<h5 id="fixed-4">Fixed<a class="anchor" aria-label="anchor" href="#fixed-4"></a>
</h5>
<ul>
<li>The cluster_hits() function now does not modify the gene symbols
anymore. Before, it attempted to clean them by removing characters that
are not valid and making them uppercase. This is implicit behavior (even
though the user was informed) and was removed in the favor of the user
now having to explicitly cleaning them himself and he is responsible for
that.</li>
</ul>
</div>
<div class="section level5">
<h5 id="changed-4">Changed<a class="anchor" aria-label="anchor" href="#changed-4"></a>
</h5>
<ul>
<li><p>Changed cluster quality metric from Silhouette score to signed
r^2 (variance explained). This is because Silhouette score focuses on
determining how well a cluster member fits in this cluster compared to
other clusters, but does not quantify how well the cluster centroid
represents each member (which is what is desired).</p></li>
<li><p>Identifying the best amount of clusters in the case the user
specified a range of clusters is now again done with the Bayesian
Information Criterion. This is because in order to use the Silhouette
score, a new dependency is needed, and one aim is to minimize
dependencies.</p></li>
</ul>
</div>
<div class="section level5">
<h5 id="removed-3">Removed<a class="anchor" aria-label="anchor" href="#removed-3"></a>
</h5>
<ul>
<li><p>Removed the double spline clustering and cat3 now forms the
clusters by combining the cluster assignments of the time effect
clusters. This was done to simplify the task, because one now needs to
only focus on nicely clustering the time effect hits.</p></li>
<li><p>Gene check inside run_ora(). Now, the user is responsible of
providing appropriate symbols.</p></li>
<li><p>report argument of the cluster_hits() and run_ora() functions.
This was a Boolean argument specifying if a report should be generated.
Now, this was removed, and the functions only generate a report when a
directory path to write was provided. Now also the default for the
directory path is NULL, instead of the project dir. This means that per
default, no HMTL report is generated.</p></li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="v0-3-1">[v0.3.1]<a class="anchor" aria-label="anchor" href="#v0-3-1"></a>
</h4>
<div class="section level5">
<h5 id="added-5">Added<a class="anchor" aria-label="anchor" href="#added-5"></a>
</h5>
<ul>
<li><p>Effect size computations and thresholding for the splines.
Because with enough statistical power, also tiny differences can be
significant, it can make sense to determine the hits by not just
filtering with the adj.p-value threshold, but also with an effect size
threshold. Therefore, the cluster_hits() function now computes the
spline effect sizes via cumulative travel and accepts a threshold
argument that is used for the cutoffs. For category 2 with the average
difference between the conditions, the effect size is already in the
topTable from limma.</p></li>
<li><p>Double spline clustering for the hits for category 3. Those
clusters are assigned to those hits and serve for the following
clustered enrichment. To control this, a new argument of the
cluster_hits() function, nr_clusters_interaction, was defined.</p></li>
<li><p>Cluster quality metric (Silhouette score). Now, in the HTML
reports of the cluster_hits() function, for every hit, there is the
Silhouette score reported. Additionally, in the beginning of the time
effect results sections, histograms show the distribution of Silhouette
scores in all clusters.</p></li>
<li><p>The functions preprocess_rna_seq_data, run_limma_splines, and
cluster_hits now report the amount of time it took for them to
run.</p></li>
</ul>
</div>
<div class="section level5">
<h5 id="fixed-5">Fixed<a class="anchor" aria-label="anchor" href="#fixed-5"></a>
</h5>
<ul>
<li><p>Some documentation was outdated or too vague. Improved
that.</p></li>
<li><p>Some smaller things were fixed, such as remnants of the
screen_limma_hyperparams() function in the code in other places, or
input control functions that still expected older argument
names.</p></li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="section">[0.3.0]<a class="anchor" aria-label="anchor" href="#section"></a>
</h4>
<div class="section level5">
<h5 id="changed-5">Changed<a class="anchor" aria-label="anchor" href="#changed-5"></a>
</h5>
<ul>
<li><p>cluster_hits() returns. Now it returns only the plots and a large
table, summarizing all clustering results, including the results from
the limma result categories 2 and 3.</p></li>
<li><p>run_ora() now takes the cluster_hits() summary table return as
input, and performs enrichment analysis with all three limma result
categories.</p></li>
<li><p>More info in run_ora() reports: The HTML reports generated by the
run_ora() function contained too little information about the inputs and
the results to which the ora report is connected. To adress this, the
ora report now contains downloadable files with the foreground and
background genes, reports the clusterProfiler parameters used, and the
run_ora() function has a new argument which allows to pass a string
which is the name of the corresponding cluster_hits() HTML report, that
contains the results that are the basis for the respective run_ora()
report.</p></li>
<li><p>Separated isolated and integrated mode computations: Before,
there was a part in the code that generated the limma time_effect
category results. This was used both for the isolated and integrated
mode, because they share those results. However, this meant that the
analysis for the integrated mode was run more often then necessary,
because it was run once for each condition to the the time_effect
results, and then once to get the average diff condition and interaction
results. This was unnecessary, since all the integrated results can be
derived with a single global model (with the help of contrasts).
Therefore, I now completely separated the compuations for the isolated
and integrated approach, and for the integrated approach, just one
global model is run and all the three limma result categories extracted
from there with the help of contrasts.</p></li>
<li><p>Made cluster_hits() usable for many hits: Introduced a new
function argument, called max_hit_number. This controls the plotting
logic of the report generation, so it limits the amount of plots and
amount of detail shown in the plots to a maximum number of hits per
cluster. This allows to also generate clustering reports for analyses
with many hits, because nowbody anyways looks at thousands of spline
plots.</p></li>
<li><p>Switched from hierarchical clustering to kmeans. This was done
because kmeans is much faster (more efficient in terms of computations).
Also, now the number of clusters is always specified as a range
(min:max, e.g. 2:4) and all of those cluster numbers are tried out and
the best one identified with the help of the silhuette score. Also if
you want to have just one definite amount of clusters, you still specify
it as a range due to technical reasons. Additionally, when the datasets
is large, it uses the minibatch version of kmeans, which is a lot faster
(while sacrificing a bit of the cluster quality).</p></li>
</ul>
</div>
<div class="section level5">
<h5 id="added-6">Added<a class="anchor" aria-label="anchor" href="#added-6"></a>
</h5>
<ul>
<li><p>Auto-dof with loocv: Introduced new capability, that
automatically finds the best spline dof based on the error on loocv. For
every linear model fit, it performs the analytical loocv and then looks
at the error sum of all features. It does this with every dof from 2 to
min(timepoints, 10). Autodof is activated when the the dof = 0L is
selected.</p></li>
<li><p>Added cross-species gene mapping: Added optional support for
automatic gene symbol conversion between species via gprofiler2 or
orthogene. Controlled through the new mapping_cfg argument in run_ora(),
this enables mapping from from_species to to_species using either
method. The conversion applies across all cluster hit tables, preserves
order, and retains unmapped genes. No suffix stripping is done, but
users are warned if trailing _digits are detected. The qvalue package is
now optionally required to enable stricter FDR filtering in enrichment
results.</p></li>
<li><p>Cross-platform and memory-safe parallelization support for
dream() via a new helper function bp_setup(). This function sets up a
BiocParallel backend using either MulticoreParam (Unix) or SnowParam
(Windows), based on user-supplied configuration (bp_cfg). BLAS threads
per worker are throttled using RhpcBLASctl to avoid oversubscription.
Cleanup with bpstop() is conditionally applied for SnowParam backends.
Includes validation of bp_cfg input. Enables efficient multi-core
execution of dream() and eBayes() while preventing system resource
exhaustion.</p></li>
<li><p>download_bioconductor_database() function. This one allows to
conveniently download a database from a specific organism from
BioConductor (see function documentation).</p></li>
<li><p>Introduced clusterProfiler::enrichGO() along with
clusterProfiler::simplify into SplineOmics::run_ora(). This allows to
run the enrichment of the BioConductor GO databases with the enrichGO
function, followed by the simplify function, to collapse hierarchical
terms. This behavior is controlled over a new argument of run_ora(),
namely enrichGO_cfg (see documentation).</p></li>
<li><p>Better documentation in the limma and cluster_hits HTML reports
about the heteroscedasticity arguments and the result of the Levene
test.</p></li>
</ul>
</div>
<div class="section level5">
<h5 id="fixed-6">Fixed<a class="anchor" aria-label="anchor" href="#fixed-6"></a>
</h5>
<ul>
<li><p>Red spline curves: Before, it was just generated with the help of
the spline coefficients, and the intercept. But this is not the full
linear model that is used by limma. Now, it generates the spline also
with the help of the other variables used in the linear model. The
predicted splines are now generated at the very beginning of the
cluster_hits() function, and used for clustering AND plotting.</p></li>
<li><p>Wrong coefficients passes to topTable() function. For the limma
result category average difference conditions, not all necessary
coefficients were passed. Before, it just checked if there is a
difference between the conditions for the reference time point (the
first timepoint). Now it passes all the necessary coefficients, and then
performs a joint F-test to get the average difference between the
conditions across the whole timecourse.</p></li>
<li><p>The use_array_weights argument internally was always set to FALSE
when it was set to TRUE by the user. This is why setting it to TRUE
seemingly had no effect. This was now fixed.</p></li>
</ul>
<hr>
</div>
</div>
<div class="section level4">
<h4 id="section-1">[0.2.0] - 2025-05-08<a class="anchor" aria-label="anchor" href="#section-1"></a>
</h4>
<div class="section level5">
<h5 id="fixed-7">Fixed<a class="anchor" aria-label="anchor" href="#fixed-7"></a>
</h5>
<ul>
<li><p>Bug that prevented the generation of the double spline plots when
the condition column of meta was a factor instead of a string. This is
now solved (it internally in the code converts it to a string), so
having the condition column as a factor now does not cause problems
anymore (as having it as factor is perfectly valid).</p></li>
<li><p>Bug that occured in the internal clean_gene_symbols() function
when one of the gene names was NA. Now, this does not cause a problem
anymore and instead of the gene name on the respective spline plot it
will write NA.</p></li>
<li><p>The error message when more clusters where specified than hits in
a condition was very cryptic. Now, it gives a message that is easy to
understand.</p></li>
<li><p>A bug in input control that threw an error indicating that there
are rows in the dataset that contains just zeros, even though this was
not true.</p></li>
<li><p>When running cluster_hits() with report = FALSE, but there where
many hits, it anyways warned the user that the report generation will
take long. This was fixed, because when report = FALSE, no report is
generated, which means the user does not have to be warned then (that
would just confuse the user).</p></li>
</ul>
</div>
<div class="section level5">
<h5 id="changed-6">Changed<a class="anchor" aria-label="anchor" href="#changed-6"></a>
</h5>
<ul>
<li>
<p>Replicates in the double spline plots (limma result category 2
and</p>
<ol start="3" style="list-style-type: decimal">
<li>are now shown with shapes instead of numbers besides the data
points. This is now possible because the imputed values are not anymore
shown with shapes in those plots, like in the single spline plots (limma
result category 1), but with colors (red = imputed values for condition
1, dodgerblue = imputed values for condition 2).</li>
</ol>
</li>
<li><p>The images in the HTML reports are now considerably smaller, but
zoomable, with the option to drag within the zoomed image. A single
left-click with the mouse starts the zoom process. Then, you can zoom
with the mouse wheel. If you reach the max zoom, you can move in the
image by further zooming with the mouse wheel but placing the mouse in
one of the corners. Further, one can zoom by holding left-click pressed
and dragging (you can then also let go).</p></li>
<li><p>SplineOmics can now handle datasets with NA values. limma can do
that, and since SplineOmics is based on limma, it can in principle do it
to. The issue before was just that there were checks in place that
prevented NA values from entering the pipeline, and also other steps in
the code caused problems, raised warnings, or stopped the execution when
facing NA values.</p></li>
<li><p>Changed extract_data() function so that it can handle missing
values correctly, and so that it now is fully explicit and does not do
any internal magic.</p></li>
<li><p>When there where less than two hits in all levels for the
cluster_hits() function, then this function provided a message that
informed about this and threw an error. This was fine when just running
the function to generate one result. However, when using this function
in an outside loop to generate multiple results, this behavior is
suboptimal, because it then must be captured with a tryCatch clause.
Now, if there are less than two hits in all levels, it simply returns
NULL, which is a cleaner behavior that does not break loops if one
result cannot be generated.</p></li>
<li><p>extract_data() function, so that now it does not work with an
implicit logic, but instead with an explicit logic. Before, it tried to
automatically find the numeric matrix field. Now, it requires to
specific the top- and bottom row, and the left and right column. This
then marks the field where the matrix is. The rest of the logic (the
logic about the row name columns) is still the same.</p></li>
<li><p>make_scatter_plot_html() (now renamed to
make_scatter_plots_html()).</p></li>
<li><p>renamed run_gsea() to run_ora(), because the function uses
clusterProfiler, which performs ora (overrepresentation analysis) and
not gsea (gene set enrichment analysis) in the stricter sense.</p></li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="added-7">Added<a class="anchor" aria-label="anchor" href="#added-7"></a>
</h4>
<ul>
<li><p>find_pvc() function. This function performs a compount contrast
for every timepoint triple in the data (adjacent timepoints) to find
peaks, valley, and cliffs as a form of local temporal patterns. It
generates an HTML report containing all findings in files and also
containing the plots.</p></li>
<li><p>New vignette showcasing the find_pvc() function.</p></li>
<li><p>Implicit (default) and explicit heteroscedasticity handling of
the linear model input. Controlled by the <code>robust_fit</code>
Boolean flag indicating whether the robust modeling strategy should be
used to account for heteroscedasticity. If omitted (i.e.,
<code>robust_fit = NULL</code>), the decision is made implicitly based
on the result of the Breusch–Pagan test, which is applied independently
to each feature. This test fits a linear model of the form
<code>expression ~ time</code> and checks whether the residual variance
systematically depends on the fitted values. If a significant violation
of homoscedasticity is detected in a sufficient fraction of features
(default: 10%), the robust strategy is applied. For RNA-seq data, this
means using <code>voomWithQualityWeights()</code> instead of the
standard <code>voom()</code> function. For other, non-count-based data,
<code><a href="https://rdrr.io/pkg/limma/man/arrayWeights.html" class="external-link">limma::arrayWeights()</a></code> is used during model fitting,
combined with <code>robust = TRUE</code> in
<code><a href="https://rdrr.io/pkg/limma/man/ebayes.html" class="external-link">limma::eBayes()</a></code>. These strategies downweight samples with
higher residual variance to prevent bias in the linear modeling step, as
violations of the homoscedasticity assumption can lead to misleading
p-values and unreliable inference.</p></li>
<li><p>New note in the HTML report of the cluster_hits() function, that
informs the user that the splines shown in the plots can appear to have
the wrong intercept. This can occur when a batch effect and/or random
effect is modeled with limma or the linear mixed models, but the
plotting data is batch corrected only with the dedicated limma batch
correction function. For a reason, there is a gap. The results are fine!
Just the plotting is off!</p></li>
<li><p>New user-available function called compare_results() that allows
to correlate the topTable results from two SplineOmics results (for
example intergrated vs. isolated approach with the same data).</p></li>
</ul>
<hr>
</div>
<div class="section level4">
<h4 id="section-2">[0.1.2] - 2025-02-11<a class="anchor" aria-label="anchor" href="#section-2"></a>
</h4>
<div class="section level5">
<h5 id="added-8">Added<a class="anchor" aria-label="anchor" href="#added-8"></a>
</h5>
<ul>
<li>Level name in title of overall spline plots.</li>
</ul>
</div>
<div class="section level5">
<h5 id="fixed-8">Fixed<a class="anchor" aria-label="anchor" href="#fixed-8"></a>
</h5>
<ul>
<li>Small bug that made it impossible having no treatment label for a
condition.</li>
<li>Small bug that did not allow to specify two treatment labels.</li>
<li>mode == isolated for RNA-seq data. Before, it caused an error,
because it splits up the meta into the different conditions, but does
not do so for the data. Now, it informs the user that it cannot do this,
and the user has to split up the data himself outside (just for RNA-seq
data).</li>
</ul>
</div>
<div class="section level5">
<h5 id="removed-4">Removed<a class="anchor" aria-label="anchor" href="#removed-4"></a>
</h5>
<ul>
<li>open_template() function. This was a function that opened a template
for your own analysis. I removed it, because otherwise, whenever I
change the code, I have to update the get-started vignette (tutorial)
and this, which is twice the maintainance effort.</li>
</ul>
<hr>
</div>
</div>
<div class="section level4">
<h4 id="section-3">[0.1.1] - 2025-01-29<a class="anchor" aria-label="anchor" href="#section-3"></a>
</h4>
</div>
<div class="section level4">
<h4 id="changed-7">Changed<a class="anchor" aria-label="anchor" href="#changed-7"></a>
</h4>
<ul>
<li>The design formula must now contain the string ‘Time’ rather than
‘X’ like it was before. X from before stood for the time. This change is
intended to make the design formula more explicit and self
explanatory.</li>
<li>Random effects can now be directly be specified in the design
formula, rather than being passed as part of the dream_params.</li>
</ul>
</div>
<div class="section level4">
<h4 id="added-9">Added<a class="anchor" aria-label="anchor" href="#added-9"></a>
</h4>
<ul>
<li>Added linear mixed models for modeling random effects. The
variancePartition package is used for that –&gt; voomWithDreamWeights
for RNA-seq data processing, and dream as the replacement for limma. For
example, if you Reactor is your random effect, you can write the design
formula like this: design &lt;- “~ 1 + Condition*Time + Plate +
(1|Reactor)” and SplineOmics will automatically run the
variancePartition functions voomWithDreamWeights() and dream() instead
of the limma::voom and lmfit. dream() has additional parameters, such as
the method and the degree of freedom (different than the degree of
freedom used for the splines in this package) and you can pass these
with the dream_params argument. See RNA-seq analysis vignette or the
respective function references for more info.</li>
<li>Raw data plotting function –&gt; make_scatter_plot_html() –&gt; see
references.</li>
<li>Imputed values are marked with triangle symbols in cluster_hits()
spline plots if raw data is passed.</li>
<li>Package version is written in each HTML report (the tag) and the
session info is added as an embedded text file.</li>
<li>Standard error written on top of “double spline” plots (limma result
category 2 and 3).</li>
<li>Used analysis script is embedded as a text file in the reports.</li>
<li>The mode (integrated or isolated) is written on top of the reports
in a separate field.</li>
<li>Now there are 4 significance stars.</li>
<li>Treatment lines for the double spline plots (limma result category 2
and 3).</li>
</ul>
<div class="section level5">
<h5 id="fixed-9">Fixed<a class="anchor" aria-label="anchor" href="#fixed-9"></a>
</h5>
<ul>
<li>A few smaller visual things for the HTML reports.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<pre><code><span><span class="co">## R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.5 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=de_AT.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=de_AT.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=de_AT.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=de_AT.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Europe/Vienna</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices datasets  utils     methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] desc_1.4.3          digest_0.6.39       R6_2.6.1           </span></span>
<span><span class="co">##  [4] fastmap_1.2.0       xfun_0.56           cachem_1.1.0       </span></span>
<span><span class="co">##  [7] knitr_1.51          htmltools_0.5.9     rmarkdown_2.30     </span></span>
<span><span class="co">## [10] lifecycle_1.0.5     cli_3.6.5           sass_0.4.10        </span></span>
<span><span class="co">## [13] pkgdown_2.2.0       textshaping_1.0.4   jquerylib_0.1.4    </span></span>
<span><span class="co">## [16] renv_1.1.7          systemfonts_1.3.1   compiler_4.5.2     </span></span>
<span><span class="co">## [19] rstudioapi_0.18.0   tools_4.5.2         ragg_1.5.0         </span></span>
<span><span class="co">## [22] bslib_0.10.0        evaluate_1.0.5      yaml_2.3.12        </span></span>
<span><span class="co">## [25] otel_0.2.0          BiocManager_1.30.27 jsonlite_2.0.0     </span></span>
<span><span class="co">## [28] htmlwidgets_1.6.4   rlang_1.1.7         fs_1.6.6</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Rauter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
