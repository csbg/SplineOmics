<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>RNA-seq analysis • SplineOmics</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="RNA-seq analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SplineOmics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/design_limma_design_formula.html">Designing a Limma Design Formula</a></li>
    <li><a class="dropdown-item" href="../articles/Docker_permission_denied.html">Docker_permission_denied</a></li>
    <li><a class="dropdown-item" href="../articles/Docker-instructions.html">Docker-instructions</a></li>
    <li><a class="dropdown-item" href="../articles/get-started.html">get-started</a></li>
    <li><a class="dropdown-item" href="../articles/RNA-seq%20analysis.html">RNA-seq analysis</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/csbg/SplineOmics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>RNA-seq analysis</h1>
                        <h4 data-toc-skip class="author">Thomas
Rauter</h4>
            
            <h4 data-toc-skip class="date">13 January, 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/csbg/SplineOmics/blob/HEAD/vignettes/RNA-seq%20analysis.Rmd" class="external-link"><code>vignettes/RNA-seq analysis.Rmd</code></a></small>
      <div class="d-none name"><code>RNA-seq analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="about-this-vignette">About this vignette<a class="anchor" aria-label="anchor" href="#about-this-vignette"></a>
</h2>
<p>This tutorial intends to showcase and explain the capabilities of the
<strong>SplineOmics</strong> package by walking through a real and
complete RNA-seq example, from start to finish.
<strong>SplineOmics</strong> is explained in more detail in the
<strong>get-started</strong> vignette, where a proteomics example is
covered. This vignette is more focused on showing how RNA-seq data can
be used, and because of this, less details about the overall package are
provided here.</p>
<div class="section level3">
<h3 id="data-overview">Data Overview<a class="anchor" aria-label="anchor" href="#data-overview"></a>
</h3>
<p>This dataset originates from a <strong>time-series RNA-seq
experiment</strong> designed to study Chinese Hamster Ovary (CHO) cells.
The experiment involved cultivating cells in <strong>eight
bioreactors</strong>, with <strong>four bioreactors</strong> subjected
to a temperature shift after 146 hours (experimental condition) and the
remaining <strong>four bioreactors</strong> maintained without a
temperature shift (control condition).</p>
<p>Samples were collected at <strong>17 distinct time points</strong>
throughout the experiment, specifically: <code>"72h"</code>,
<code>"76h"</code>, <code>"96h"</code>, <code>"120h"</code>,
<code>"124h"</code>, <code>"144h"</code>, <code>"148h"</code>,
<code>"152h"</code>, <code>"168h"</code>, <code>"192h"</code>,
<code>"216h"</code>, <code>"220h"</code>, <code>"240h"</code>,
<code>"264h"</code>, <code>"268h"</code>, <code>"288h"</code>, and
<code>"312h"</code> after cultivation start. Each time point was sampled
from all eight bioreactors, resulting in a total of <strong>136
samples</strong>.</p>
<p>There are two batch effects: Reactor and Plate. Different
bioreactors, where the cells are cultivated, can show big variablity.
Plate refers to two different plates used in the RNA-seq analysis of the
samples. A fully random design was used to distribute the samples to the
two plates. In this vignette, we will just remove the plate batch
effect.</p>
<p>The data matrix comprises <strong>genes as rows</strong> and
<strong>samples as columns</strong>, providing gene expression
measurements for all time points. Each sample was initially sequenced in
<strong>three technical replicates</strong> across <strong>two NovaSeq X
flow cells</strong>. These technical replicates were collapsed to
generate the final dataset used in this analysis.</p>
<p>The goal of this experiment is to investigate the effect of a
temperature shift during CHO cell cultivation on gene expression
dynamics over time.</p>
<p>Note: This is not the original dataset, as it has not yet been
published at the time of this vignette’s creation. For demonstration
purposes, the genes have been randomly shuffled, and only a subset of
the data has been included to reduce the dataset size.</p>
</div>
<div class="section level3">
<h3 id="analysis-goals">Analysis Goals<a class="anchor" aria-label="anchor" href="#analysis-goals"></a>
</h3>
<p>The main objectives of this analysis are:</p>
<ul>
<li><p><strong>Identify genes with significant temporal
changes</strong>: Among the thousands of genes measured, the goal is to
identify those that exhibit significant changes in expression over
time.</p></li>
<li><p><strong>Cluster genes based on temporal patterns</strong>: Genes
showing significant temporal changes (hits) will be grouped into
clusters based on their time-dependent expression patterns.</p></li>
<li><p><strong>Perform gene set enrichment analysis</strong>: For each
cluster, a gene set enrichment analysis will be conducted to identify
whether specific biological pathways or processes are up- or
downregulated in response to feeding and how these processes are
influenced by the temperature shift.</p></li>
<li><p><strong>Assess the impact of temperature shifts on temporal
patterns</strong>: The analysis will determine whether the temporal
patterns of gene expression are affected by the temperature shift, i.e.,
whether gene expression dynamics differ over time under temperature
shift conditions compared to controls.</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="load-the-packages">Load the packages<a class="anchor" aria-label="anchor" href="#load-the-packages"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://csbg.github.io/SplineOmics">SplineOmics</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'limma::topTable' by</span></span>
<span><span class="co">#&gt; 'variancePartition::topTable' when loading 'SplineOmics'</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span> <span class="co"># For reading the meta CSV file</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span>  <span class="co"># For managing filepaths</span></span>
<span><span class="co">#&gt; here() starts at /tmp/RtmpCTvFNy</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span> <span class="co"># For data manipulation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span> <span class="co"># For Showing the head of the data and the meta tables.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-the-files">Load the files<a class="anchor" aria-label="anchor" href="#load-the-files"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">xzfile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"extdata"</span>,</span>
<span>  <span class="st">"rna_seq_data.rds.xz"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"SplineOmics"</span></span>
<span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>    <span class="st">"extdata"</span>,</span>
<span>    <span class="st">"rna_seq_meta.csv"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">"SplineOmics"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  show_col_types <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="show-top-rows-of-data">Show top rows of data<a class="anchor" aria-label="anchor" href="#show-top-rows-of-data"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"markdown"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="1%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">Sample1</th>
<th align="right">Sample57</th>
<th align="right">Sample80</th>
<th align="right">Sample68</th>
<th align="right">Sample29</th>
<th align="right">Sample121</th>
<th align="right">Sample129</th>
<th align="right">Sample46</th>
<th align="right">Sample49</th>
<th align="right">Sample75</th>
<th align="right">Sample103</th>
<th align="right">Sample41</th>
<th align="right">Sample52</th>
<th align="right">Sample120</th>
<th align="right">Sample107</th>
<th align="right">Sample23</th>
<th align="right">Sample71</th>
<th align="right">Sample56</th>
<th align="right">Sample12</th>
<th align="right">Sample86</th>
<th align="right">Sample5</th>
<th align="right">Sample98</th>
<th align="right">Sample37</th>
<th align="right">Sample22</th>
<th align="right">Sample94</th>
<th align="right">Sample62</th>
<th align="right">Sample106</th>
<th align="right">Sample21</th>
<th align="right">Sample119</th>
<th align="right">Sample11</th>
<th align="right">Sample40</th>
<th align="right">Sample114</th>
<th align="right">Sample28</th>
<th align="right">Sample77</th>
<th align="right">Sample82</th>
<th align="right">Sample20</th>
<th align="right">Sample31</th>
<th align="right">Sample125</th>
<th align="right">Sample110</th>
<th align="right">Sample92</th>
<th align="right">Sample27</th>
<th align="right">Sample61</th>
<th align="right">Sample105</th>
<th align="right">Sample70</th>
<th align="right">Sample55</th>
<th align="right">Sample102</th>
<th align="right">Sample39</th>
<th align="right">Sample48</th>
<th align="right">Sample116</th>
<th align="right">Sample60</th>
<th align="right">Sample16</th>
<th align="right">Sample132</th>
<th align="right">Sample6</th>
<th align="right">Sample124</th>
<th align="right">Sample67</th>
<th align="right">Sample113</th>
<th align="right">Sample115</th>
<th align="right">Sample9</th>
<th align="right">Sample15</th>
<th align="right">Sample45</th>
<th align="right">Sample74</th>
<th align="right">Sample123</th>
<th align="right">Sample85</th>
<th align="right">Sample24</th>
<th align="right">Sample26</th>
<th align="right">Sample59</th>
<th align="right">Sample65</th>
<th align="right">Sample88</th>
<th align="right">Sample118</th>
<th align="right">Sample101</th>
<th align="right">Sample18</th>
<th align="right">Sample136</th>
<th align="right">Sample72</th>
<th align="right">Sample35</th>
<th align="right">Sample128</th>
<th align="right">Sample87</th>
<th align="right">Sample73</th>
<th align="right">Sample100</th>
<th align="right">Sample84</th>
<th align="right">Sample135</th>
<th align="right">Sample25</th>
<th align="right">Sample34</th>
<th align="right">Sample81</th>
<th align="right">Sample131</th>
<th align="right">Sample97</th>
<th align="right">Sample64</th>
<th align="right">Sample17</th>
<th align="right">Sample134</th>
<th align="right">Sample93</th>
<th align="right">Sample8</th>
<th align="right">Sample104</th>
<th align="right">Sample44</th>
<th align="right">Sample30</th>
<th align="right">Sample10</th>
<th align="right">Sample109</th>
<th align="right">Sample91</th>
<th align="right">Sample4</th>
<th align="right">Sample7</th>
<th align="right">Sample36</th>
<th align="right">Sample111</th>
<th align="right">Sample54</th>
<th align="right">Sample99</th>
<th align="right">Sample38</th>
<th align="right">Sample133</th>
<th align="right">Sample51</th>
<th align="right">Sample58</th>
<th align="right">Sample14</th>
<th align="right">Sample43</th>
<th align="right">Sample53</th>
<th align="right">Sample63</th>
<th align="right">Sample130</th>
<th align="right">Sample112</th>
<th align="right">Sample3</th>
<th align="right">Sample33</th>
<th align="right">Sample127</th>
<th align="right">Sample42</th>
<th align="right">Sample117</th>
<th align="right">Sample122</th>
<th align="right">Sample108</th>
<th align="right">Sample90</th>
<th align="right">Sample50</th>
<th align="right">Sample76</th>
<th align="right">Sample126</th>
<th align="right">Sample19</th>
<th align="right">Sample96</th>
<th align="right">Sample79</th>
<th align="right">Sample83</th>
<th align="right">Sample47</th>
<th align="right">Sample2</th>
<th align="right">Sample32</th>
<th align="right">Sample13</th>
<th align="right">Sample69</th>
<th align="right">Sample95</th>
<th align="right">Sample78</th>
<th align="right">Sample66</th>
<th align="right">Sample89</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">LOC113838358</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">LOC113836143</td>
<td align="right">1227</td>
<td align="right">1288</td>
<td align="right">1303</td>
<td align="right">1494</td>
<td align="right">1380</td>
<td align="right">1679</td>
<td align="right">1620</td>
<td align="right">1305</td>
<td align="right">1243</td>
<td align="right">1526</td>
<td align="right">1889</td>
<td align="right">1079</td>
<td align="right">1386</td>
<td align="right">1612</td>
<td align="right">1880</td>
<td align="right">1503</td>
<td align="right">1262</td>
<td align="right">1590</td>
<td align="right">1260</td>
<td align="right">1385</td>
<td align="right">1631</td>
<td align="right">1976</td>
<td align="right">1348</td>
<td align="right">1143</td>
<td align="right">998</td>
<td align="right">1903</td>
<td align="right">1579</td>
<td align="right">1253</td>
<td align="right">2115</td>
<td align="right">1218</td>
<td align="right">1309</td>
<td align="right">1977</td>
<td align="right">1255</td>
<td align="right">1522</td>
<td align="right">1362</td>
<td align="right">1465</td>
<td align="right">1587</td>
<td align="right">1893</td>
<td align="right">2166</td>
<td align="right">1776</td>
<td align="right">1411</td>
<td align="right">2065</td>
<td align="right">1678</td>
<td align="right">1763</td>
<td align="right">1182</td>
<td align="right">1881</td>
<td align="right">989</td>
<td align="right">1512</td>
<td align="right">1828</td>
<td align="right">1495</td>
<td align="right">1306</td>
<td align="right">2169</td>
<td align="right">1511</td>
<td align="right">1963</td>
<td align="right">1304</td>
<td align="right">1947</td>
<td align="right">1816</td>
<td align="right">1510</td>
<td align="right">1528</td>
<td align="right">1483</td>
<td align="right">1197</td>
<td align="right">1911</td>
<td align="right">1652</td>
<td align="right">1248</td>
<td align="right">1214</td>
<td align="right">1688</td>
<td align="right">1279</td>
<td align="right">1802</td>
<td align="right">3340</td>
<td align="right">2441</td>
<td align="right">1502</td>
<td align="right">1208</td>
<td align="right">1179</td>
<td align="right">1406</td>
<td align="right">1870</td>
<td align="right">1903</td>
<td align="right">1628</td>
<td align="right">2386</td>
<td align="right">1651</td>
<td align="right">1650</td>
<td align="right">1439</td>
<td align="right">1777</td>
<td align="right">2009</td>
<td align="right">2521</td>
<td align="right">1839</td>
<td align="right">1569</td>
<td align="right">1550</td>
<td align="right">3951</td>
<td align="right">2018</td>
<td align="right">1843</td>
<td align="right">2807</td>
<td align="right">1675</td>
<td align="right">1488</td>
<td align="right">1353</td>
<td align="right">2205</td>
<td align="right">2261</td>
<td align="right">1634</td>
<td align="right">1571</td>
<td align="right">2161</td>
<td align="right">2230</td>
<td align="right">1512</td>
<td align="right">2207</td>
<td align="right">1426</td>
<td align="right">3082</td>
<td align="right">1445</td>
<td align="right">1421</td>
<td align="right">1840</td>
<td align="right">1908</td>
<td align="right">1779</td>
<td align="right">1944</td>
<td align="right">2394</td>
<td align="right">3384</td>
<td align="right">1771</td>
<td align="right">1780</td>
<td align="right">3673</td>
<td align="right">1601</td>
<td align="right">2786</td>
<td align="right">2196</td>
<td align="right">2504</td>
<td align="right">2384</td>
<td align="right">1543</td>
<td align="right">1961</td>
<td align="right">2433</td>
<td align="right">1403</td>
<td align="right">3074</td>
<td align="right">1577</td>
<td align="right">1846</td>
<td align="right">2136</td>
<td align="right">1981</td>
<td align="right">1655</td>
<td align="right">2160</td>
<td align="right">1542</td>
<td align="right">2777</td>
<td align="right">1426</td>
<td align="right">1723</td>
<td align="right">2858</td>
</tr>
<tr class="odd">
<td align="left">Coro7_1</td>
<td align="right">2</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">2</td>
<td align="right">6</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">13</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">14</td>
<td align="right">3</td>
<td align="right">7</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="right">15</td>
<td align="right">4</td>
<td align="right">9</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">8</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">7</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">8</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">6</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">9</td>
<td align="right">10</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">12</td>
<td align="right">10</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">7</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">2</td>
<td align="right">6</td>
<td align="right">8</td>
<td align="right">13</td>
<td align="right">6</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">27</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="left">LOC100765316_1</td>
<td align="right">778</td>
<td align="right">826</td>
<td align="right">886</td>
<td align="right">759</td>
<td align="right">854</td>
<td align="right">845</td>
<td align="right">851</td>
<td align="right">881</td>
<td align="right">797</td>
<td align="right">1097</td>
<td align="right">1119</td>
<td align="right">880</td>
<td align="right">564</td>
<td align="right">704</td>
<td align="right">1244</td>
<td align="right">941</td>
<td align="right">781</td>
<td align="right">583</td>
<td align="right">727</td>
<td align="right">958</td>
<td align="right">987</td>
<td align="right">1061</td>
<td align="right">807</td>
<td align="right">823</td>
<td align="right">527</td>
<td align="right">63</td>
<td align="right">724</td>
<td align="right">635</td>
<td align="right">1070</td>
<td align="right">752</td>
<td align="right">702</td>
<td align="right">893</td>
<td align="right">746</td>
<td align="right">859</td>
<td align="right">786</td>
<td align="right">777</td>
<td align="right">897</td>
<td align="right">931</td>
<td align="right">959</td>
<td align="right">1014</td>
<td align="right">760</td>
<td align="right">128</td>
<td align="right">628</td>
<td align="right">55</td>
<td align="right">628</td>
<td align="right">736</td>
<td align="right">304</td>
<td align="right">645</td>
<td align="right">902</td>
<td align="right">55</td>
<td align="right">623</td>
<td align="right">663</td>
<td align="right">655</td>
<td align="right">674</td>
<td align="right">837</td>
<td align="right">803</td>
<td align="right">784</td>
<td align="right">505</td>
<td align="right">594</td>
<td align="right">665</td>
<td align="right">440</td>
<td align="right">777</td>
<td align="right">473</td>
<td align="right">618</td>
<td align="right">329</td>
<td align="right">196</td>
<td align="right">313</td>
<td align="right">566</td>
<td align="right">717</td>
<td align="right">494</td>
<td align="right">281</td>
<td align="right">414</td>
<td align="right">556</td>
<td align="right">354</td>
<td align="right">499</td>
<td align="right">768</td>
<td align="right">205</td>
<td align="right">106</td>
<td align="right">264</td>
<td align="right">161</td>
<td align="right">285</td>
<td align="right">182</td>
<td align="right">341</td>
<td align="right">468</td>
<td align="right">162</td>
<td align="right">171</td>
<td align="right">224</td>
<td align="right">224</td>
<td align="right">441</td>
<td align="right">342</td>
<td align="right">447</td>
<td align="right">454</td>
<td align="right">171</td>
<td align="right">169</td>
<td align="right">240</td>
<td align="right">186</td>
<td align="right">279</td>
<td align="right">263</td>
<td align="right">171</td>
<td align="right">486</td>
<td align="right">624</td>
<td align="right">273</td>
<td align="right">156</td>
<td align="right">178</td>
<td align="right">798</td>
<td align="right">85</td>
<td align="right">51</td>
<td align="right">167</td>
<td align="right">409</td>
<td align="right">285</td>
<td align="right">151</td>
<td align="right">60</td>
<td align="right">201</td>
<td align="right">85</td>
<td align="right">80</td>
<td align="right">197</td>
<td align="right">102</td>
<td align="right">227</td>
<td align="right">101</td>
<td align="right">51</td>
<td align="right">1013</td>
<td align="right">70</td>
<td align="right">46</td>
<td align="right">167</td>
<td align="right">80</td>
<td align="right">212</td>
<td align="right">71</td>
<td align="right">42</td>
<td align="right">65</td>
<td align="right">26</td>
<td align="right">33</td>
<td align="right">60</td>
<td align="right">67</td>
<td align="right">132</td>
<td align="right">489</td>
<td align="right">62</td>
</tr>
<tr class="odd">
<td align="left">Slc7a14_1</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">10</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">12</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">8</td>
<td align="right">4</td>
<td align="right">9</td>
<td align="right">11</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">19</td>
<td align="right">19</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">19</td>
<td align="right">12</td>
<td align="right">10</td>
<td align="right">12</td>
<td align="right">4</td>
<td align="right">7</td>
<td align="right">2</td>
<td align="right">11</td>
<td align="right">5</td>
<td align="right">21</td>
<td align="right">12</td>
<td align="right">7</td>
<td align="right">15</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">3</td>
<td align="right">10</td>
<td align="right">8</td>
<td align="right">10</td>
<td align="right">11</td>
<td align="right">9</td>
<td align="right">10</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">12</td>
<td align="right">0</td>
<td align="right">14</td>
<td align="right">3</td>
<td align="right">11</td>
<td align="right">6</td>
<td align="right">4</td>
<td align="right">13</td>
<td align="right">8</td>
<td align="right">11</td>
<td align="right">5</td>
<td align="right">8</td>
<td align="right">24</td>
<td align="right">12</td>
<td align="right">29</td>
<td align="right">17</td>
<td align="right">19</td>
<td align="right">12</td>
<td align="right">0</td>
<td align="right">20</td>
<td align="right">22</td>
<td align="right">12</td>
<td align="right">16</td>
<td align="right">14</td>
<td align="right">16</td>
<td align="right">18</td>
<td align="right">8</td>
<td align="right">22</td>
<td align="right">11</td>
<td align="right">4</td>
<td align="right">24</td>
<td align="right">26</td>
<td align="right">7</td>
<td align="right">11</td>
<td align="right">43</td>
<td align="right">13</td>
<td align="right">5</td>
<td align="right">19</td>
<td align="right">7</td>
<td align="right">13</td>
<td align="right">13</td>
<td align="right">30</td>
<td align="right">15</td>
<td align="right">12</td>
<td align="right">25</td>
<td align="right">13</td>
<td align="right">30</td>
<td align="right">8</td>
<td align="right">4</td>
<td align="right">9</td>
<td align="right">32</td>
<td align="right">5</td>
<td align="right">16</td>
<td align="right">2</td>
<td align="right">36</td>
<td align="right">8</td>
<td align="right">18</td>
<td align="right">15</td>
<td align="right">24</td>
<td align="right">8</td>
<td align="right">15</td>
<td align="right">12</td>
<td align="right">5</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">22</td>
<td align="right">15</td>
<td align="right">0</td>
<td align="right">13</td>
<td align="right">12</td>
<td align="right">10</td>
<td align="right">29</td>
<td align="right">8</td>
<td align="right">4</td>
<td align="right">8</td>
<td align="right">29</td>
<td align="right">12</td>
<td align="right">14</td>
<td align="right">15</td>
<td align="right">36</td>
<td align="right">8</td>
<td align="right">7</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">LOC100751623_1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>data</strong>: A numeric matrix where each row represents a
gene (features) and each column corresponds to a sample. The row names
of the matrix contain the gene identifiers, while the columns are
aligned with the sample metadata in meta. The matrix contains expression
values for 136 samples.</p>
<p>Note that the study was conducted in a blinded manner, with samples
randomly distributed across two plates for RNA-seq analysis. As a
result, the sample numbers (e.g., 1, 2, 3, etc.) are not in sequential
order with respect to time, condition, or plate.</p>
<p>For the data analysis involving splines over time, it is essential to
sort the samples based on time to establish a valid temporal sequence.
Additionally, organizing the data in this way improves clarity and
ensures consistency. Within each time point, samples were further sorted
by condition (e.g., constant before <code>temp_shift</code>) and,
subsequently, by plate (e.g., <code>plate_1</code> before
<code>plate_2</code>).</p>
</div>
<div class="section level3">
<h3 id="show-top-rows-of-meta">Show top rows of meta<a class="anchor" aria-label="anchor" href="#show-top-rows-of-meta"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">meta</span><span class="op">)</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"markdown"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">SampleNr</th>
<th align="left">Reactor</th>
<th align="right">Time</th>
<th align="left">Condition</th>
<th align="left">Plate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">E13</td>
<td align="right">72</td>
<td align="left">constant</td>
<td align="left">plate_1</td>
</tr>
<tr class="even">
<td align="right">57</td>
<td align="left">E15</td>
<td align="right">72</td>
<td align="left">constant</td>
<td align="left">plate_1</td>
</tr>
<tr class="odd">
<td align="right">80</td>
<td align="left">E17</td>
<td align="right">72</td>
<td align="left">constant</td>
<td align="left">plate_1</td>
</tr>
<tr class="even">
<td align="right">68</td>
<td align="left">E19</td>
<td align="right">72</td>
<td align="left">constant</td>
<td align="left">plate_1</td>
</tr>
<tr class="odd">
<td align="right">29</td>
<td align="left">E14</td>
<td align="right">72</td>
<td align="left">temp_shift</td>
<td align="left">plate_1</td>
</tr>
<tr class="even">
<td align="right">121</td>
<td align="left">E16</td>
<td align="right">72</td>
<td align="left">temp_shift</td>
<td align="left">plate_2</td>
</tr>
</tbody>
</table>
<p><strong>meta</strong>: A data frame containing metadata information
about the samples in data. Each row in meta corresponds to a column in
data, ensuring a 1:1 alignment between metadata entries and expression
data samples. The columns in meta describe various attributes of the
samples, such as SampleNr, Reactor, Time, Condition, and Plate.</p>
</div>
</div>
<div class="section level2">
<h2 id="preprocess-the-data">Preprocess the data<a class="anchor" aria-label="anchor" href="#preprocess-the-data"></a>
</h2>
<p>Filter out data rows (genes) with zero counts across all samples.
This step is a standard preprocessing procedure in RNA-seq data
analysis, as genes with zero counts in all samples provide no
information for downstream analyses.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rows_before</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter data rows</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">rows_after</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">rows_removed</span> <span class="op">&lt;-</span> <span class="va">rows_before</span> <span class="op">-</span> <span class="va">rows_after</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span></span>
<span>  <span class="st">"Rows before filtering: %d\nRows after filtering: %d\nRows removed: %d\n"</span>, </span>
<span>  <span class="va">rows_before</span>,</span>
<span>  <span class="va">rows_after</span>,</span>
<span>  <span class="va">rows_removed</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows before filtering: 1000</span></span>
<span><span class="co">#&gt; Rows after filtering: 944</span></span>
<span><span class="co">#&gt; Rows removed: 56</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="perform-eda-exploratory-data-analysis">Perform EDA (exploratory data analysis)<a class="anchor" aria-label="anchor" href="#perform-eda-exploratory-data-analysis"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">report_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  omics_data_type <span class="op">=</span> <span class="st">"RNA"</span>,</span>
<span>  data_description <span class="op">=</span> <span class="st">"RNA-seq data of CHO cells"</span>,</span>
<span>  data_collection_date <span class="op">=</span> <span class="st">"December 2024"</span>,</span>
<span>  analyst_name <span class="op">=</span> <span class="st">"Thomas Rauter"</span>,</span>
<span>  contact_info <span class="op">=</span> <span class="st">"thomas.rauter@plus.ac.at"</span>,</span>
<span>  project_name <span class="op">=</span> <span class="st">"DGTX"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">report_dir</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span></span>
<span>  <span class="st">"results"</span>,</span>
<span>  <span class="st">"explore_data"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">splineomics</span> <span class="op">&lt;-</span> <span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/create_splineomics.html">create_splineomics</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  meta <span class="op">=</span> <span class="va">meta</span>,</span>
<span>  report_info <span class="op">=</span> <span class="va">report_info</span>,</span>
<span>  condition <span class="op">=</span> <span class="st">"Condition"</span>,    <span class="co"># Column of meta that contains the levels.</span></span>
<span>  meta_batch_column <span class="op">=</span> <span class="st">"Plate"</span> <span class="co"># Remove batch effect for plotting.</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/explore_data.html">explore_data</a></span><span class="op">(</span></span>
<span>  splineomics <span class="op">=</span> <span class="va">splineomics</span>, </span>
<span>  report_dir <span class="op">=</span> <span class="va">report_dir</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><a href="https://drive.google.com/uc?export=view&amp;id=1mE7FFXFO9ZZ907in3M5Cf1w7yRxRFHiy" class="external-link">Here</a>
you can see the HTML report of the explore_data() function with the NOT
batch-corrected data, and <a href="https://drive.google.com/uc?export=view&amp;id=1g_Lt4kO4H79GnVh_f7KfXqIzxfTnMrmq" class="external-link">here</a>
the report for the batch-corrected data.</p>
</div>
<div class="section level2">
<h2 id="run-limma-spline-analysis">Run limma spline analysis<a class="anchor" aria-label="anchor" href="#run-limma-spline-analysis"></a>
</h2>
<p>In this example, we are skipping finding the best hyperparameters
with the screen_limma_hyperparams() function, because we already have a
clear idea of what do use.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spline_params</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  spline_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span><span class="op">)</span>,    <span class="co"># natural cubic splines</span></span>
<span>  dof <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3L</span><span class="op">)</span>              <span class="co"># Degree of freedom of 2 for the splines.</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">voom_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/preprocess_rna_seq_data.html">preprocess_rna_seq_data</a></span><span class="op">(</span></span>
<span>  raw_counts <span class="op">=</span> <span class="va">data</span>,</span>
<span>  meta <span class="op">=</span> <span class="va">meta</span>,</span>
<span>  spline_params <span class="op">=</span> <span class="va">spline_params</span>,</span>
<span>  design <span class="op">=</span> <span class="st">"~ 1 + Condition*X + Plate"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Preprocessing RNA-seq data (normalization + voom)...</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">voom_obj</span><span class="op">$</span><span class="va">E</span></span></code></pre></div>
<p>You can customize the normalization method by providing a specific
normalization function through the <code>normalize_func</code> argument
in the <code><a href="../reference/preprocess_rna_seq_data.html">preprocess_rna_seq_data()</a></code> function. For details on
how to use this feature, please refer to the function documentation
available under ‘References’ on the website.</p>
<p>Additionally, the use of <code><a href="../reference/preprocess_rna_seq_data.html">preprocess_rna_seq_data()</a></code> is
optional for your RNA-seq data. Alternatively, you can use the
<code><a href="https://rdrr.io/pkg/limma/man/voom.html" class="external-link">limma::voom</a></code> function directly and pass the resulting
<code>voom</code> object to the <code>rna_seq_data</code> argument of
<code><a href="../reference/create_splineomics.html">create_splineomics()</a></code> or <code><a href="../reference/update_splineomics.html">update_splineomics()</a></code>.
Alongside this, you must pass the <code>$E</code> data matrix as the
<code>data</code> argument.</p>
<p>In general, as long as the <code>data</code> argument contains the
actual data matrix and the <code>rna_seq_data</code> argument contains
an object compatible with <code>limma</code>, your data will be
correctly processed.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">splineomics</span> <span class="op">&lt;-</span> <span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/update_splineomics.html">update_splineomics</a></span><span class="op">(</span></span>
<span>  splineomics <span class="op">=</span> <span class="va">splineomics</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  rna_seq_data <span class="op">=</span> <span class="va">voom_obj</span>,</span>
<span>  design <span class="op">=</span> <span class="st">"~ 1 + Condition*X + Plate"</span>, </span>
<span>  mode <span class="op">=</span> <span class="st">"integrated"</span>, <span class="co"># means limma uses the full data for each condition.</span></span>
<span>  spline_params <span class="op">=</span> <span class="va">spline_params</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Run the <code><a href="../reference/run_limma_splines.html">run_limma_splines()</a></code> function with the updated
SplineOmics object:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">splineomics</span> <span class="op">&lt;-</span> <span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/run_limma_splines.html">run_limma_splines</a></span><span class="op">(</span></span>
<span>  splineomics <span class="op">=</span> <span class="va">splineomics</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Hint: The data contains negative values. This may occur if the data has been transformed (e.g., log-transformed or normalized) and is valid in such cases. Ensure that the data preprocessing  aligns with your analysis requirements.</span></span>
<span><span class="co">#&gt; Column 'Plate' of meta will be used to remove the batch effect for the plotting</span></span>
<span><span class="co">#&gt; Make sure that the design formula contains no interaction between the condition and time (X) for mode == isolated, and that it contains an interaction for mode == integrated. Otherwise, you will get an uncaught error of 'coefficients not estimable' or 'subscript out of bounds'.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Info</span> limma spline analysis completed successfully</span></span></code></pre></div>
<p>The output of the function run_limma_splines() is a named list, where
each element is a specific “category” of results. Refer to <a href="https://csbg.github.io/SplineOmics/articles/limma_result_categories.html">this
document</a> for an explanation of the different result categories. Each
of those elements is a list, containing as elements the respective limma
topTables, either for each level or each comparison between two
levels.</p>
<p>The element “time_effect” is a list, where each element is the
topTable where the p-value for each feature for the respective level are
reported.</p>
<p>The element “avrg_diff_conditions” is a list that contains as
elements the topTables, that represent the comparison of the average
differences of the levels.</p>
<p>The element “interaction_condition_time” is a list that contains as
elements the topTables, that represent the interaction between the
levels (which includes both time and the average differences)</p>
</div>
<div class="section level2">
<h2 id="build-limma-report">Build limma report<a class="anchor" aria-label="anchor" href="#build-limma-report"></a>
</h2>
<p>The topTables of all three limma result categories can be used to
generate p-value histograms an volcano plots.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">report_dir</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span></span>
<span>  <span class="st">"results"</span>,</span>
<span>  <span class="st">"limma_reports"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/create_limma_report.html">create_limma_report</a></span><span class="op">(</span></span>
<span>  splineomics <span class="op">=</span> <span class="va">splineomics</span>,</span>
<span>  report_dir <span class="op">=</span> <span class="va">report_dir</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>You can view the generated analysis report of the create_limma_report
function <a href="https://drive.google.com/uc?export=view&amp;id=1hvKloiaHQA5CO4Y6io8qC2lOpBJ54ypJ" class="external-link">here</a>.</p>
</div>
<div class="section level2">
<h2 id="cluster-the-hits-significant-features">Cluster the hits (significant features)<a class="anchor" aria-label="anchor" href="#cluster-the-hits-significant-features"></a>
</h2>
<p>After we obtained the limma spline results, we can cluster the hits
based on their temporal pattern (their spline shape). We define what a
hit is by setting an adj. p-value threshold for every level. Hits are
features (genes here) that have an adj. p-value below the threshold.
Hierarchical clustering is used to place every hit in one of as many
clusters as we have specified for that specific level.</p>
<p>Note that for this dataset, we have a vast amount of hits. Because it
is not useful to have thousands of individual plots, and also it takes a
long time to compute and the resulting HTML is very large in size, we
want to limit the hits that are plotted. We have several options:</p>
<ul>
<li><p><strong>Use a very low adjusted p-value</strong>: This approach
filters for the most significant features (genes) before proceeding with
analysis and visualization.</p></li>
<li><p><strong>Access and customize the data</strong>: Modify the
dataframes inside the <code>SplineOmics</code> object by removing all
but a selected set of features (genes) for plotting.</p></li>
<li><p><strong>Optimize clustering without generating a report</strong>:
Set the <code>report</code> argument in the <code><a href="../reference/cluster_hits.html">cluster_hits()</a></code>
function to <code>FALSE</code> (default is <code>TRUE</code>). This
skips the generation of an HTML report, significantly speeding up
computation by omitting the creation and export of plots.</p></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Note: The low adj. p-values are to have less results, so that the HTML report</span></span>
<span><span class="co"># is smaller in file size.</span></span>
<span><span class="va">adj_pthresholds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="co"># 0.05 for both levels</span></span>
<span>  <span class="fl">0.0000001</span>, <span class="co"># constant (temperature)    0.00001</span></span>
<span>  <span class="fl">0.0000001</span>  <span class="co"># temp_shift</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">4L</span>,  <span class="co"># 4 clusters for constant</span></span>
<span>  <span class="fl">4L</span>   <span class="co"># 4 clusters for temp_shift</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">report_dir</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span></span>
<span>  <span class="st">"results"</span>,</span>
<span>  <span class="st">"clustering_reports"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Note: The treatment_labels and treatment_timepoints variable can be defined</span></span>
<span><span class="co"># much simpler for this experiment, because all plots should have the same </span></span>
<span><span class="co"># treatment line (it can be done like shown by the commented out arguments of</span></span>
<span><span class="co"># plot_info below). The reason why this is done in the explicit way here is to</span></span>
<span><span class="co"># show how it is possible to potentially have different treatment lines for the</span></span>
<span><span class="co"># "double spline" plots (the ones that compare limma result category 2 and 3). </span></span>
<span><span class="co"># constant_temp_shift is the first condition of the double spline plot and the</span></span>
<span><span class="co"># second condition separated by an underscore (it must be exactly like this,</span></span>
<span><span class="co"># otherwise it does not work. The first condition is always the one that occurs</span></span>
<span><span class="co"># first from the top in the respective meta column).</span></span>
<span><span class="va">treatment_labels</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  constant <span class="op">=</span> <span class="st">"temp shift"</span>, </span>
<span>  temp_shift <span class="op">=</span> <span class="st">"temp shift"</span>,  </span>
<span>  constant_temp_shift <span class="op">=</span> <span class="st">"temp shift"</span> </span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">treatment_timepoints</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  constant <span class="op">=</span> <span class="fl">146</span>,</span>
<span>  temp_shift <span class="op">=</span> <span class="fl">146</span>,  </span>
<span>  constant_temp_shift <span class="op">=</span> <span class="fl">146</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">plot_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="co"># For the spline plots</span></span>
<span>  y_axis_label <span class="op">=</span> <span class="st">"log2 intensity"</span>,</span>
<span>  time_unit <span class="op">=</span> <span class="st">"min"</span>, <span class="co"># our measurements were in minutes</span></span>
<span>  <span class="co"># treatment_labels = list("temp shift"), # add this for all conditions</span></span>
<span>  <span class="co"># treatment_timepoints = list(146)       # temp shift was at 146 hours.</span></span>
<span>  treatment_labels <span class="op">=</span> <span class="va">treatment_labels</span>,</span>
<span>  treatment_timepoints <span class="op">=</span> <span class="va">treatment_timepoints</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_options</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="co"># When meta_replicate_column is not there, all datapoints are blue.</span></span>
<span>  meta_replicate_column <span class="op">=</span> <span class="st">"Reactor"</span> <span class="co"># Colors the data points based on Reactor</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">clustering_results</span> <span class="op">&lt;-</span> <span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/cluster_hits.html">cluster_hits</a></span><span class="op">(</span></span>
<span>  splineomics <span class="op">=</span> <span class="va">splineomics</span>,</span>
<span>  adj_pthresholds <span class="op">=</span> <span class="va">adj_pthresholds</span>,</span>
<span>  clusters <span class="op">=</span> <span class="va">clusters</span>,</span>
<span>  genes <span class="op">=</span> <span class="va">genes</span>,</span>
<span>  plot_info <span class="op">=</span> <span class="va">plot_info</span>,</span>
<span>  plot_options <span class="op">=</span> <span class="va">plot_options</span>,</span>
<span>  report_dir <span class="op">=</span> <span class="va">report_dir</span>,</span>
<span>  adj_pthresh_avrg_diff_conditions <span class="op">=</span> <span class="fl">0.0000001</span>,</span>
<span>  adj_pthresh_interaction_condition_time <span class="op">=</span> <span class="fl">0.0000001</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>You can view the generated analysis report of the cluster_hits
function <a href="https://drive.google.com/uc?export=view&amp;id=1EvPiEwHyGnBQFxRets00s87tochgyGK4" class="external-link">here</a>.</p>
<p>As discussed before, there are three limma result categories. The
cluster_hits() report shows the results of all three, if they are
present (category 2 and 3 can only be generated when the design formula
contains an interaction effect).</p>
</div>
<div class="section level2">
<h2 id="perform-gene-set-enrichment-analysis-gsea">Perform gene set enrichment analysis (GSEA)<a class="anchor" aria-label="anchor" href="#perform-gene-set-enrichment-analysis-gsea"></a>
</h2>
<p>Once the clustered hits are identified, a subsequent step to gain
biological insights is to perform GSEA. For this, the respective genes
can be assigned to each clustered hit, and GSEA can be carried out. To
proceed, the Enrichr databases of choice need to be downloaded:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify which databases you want to download from Enrichr</span></span>
<span><span class="va">gene_set_lib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"WikiPathways_2019_Human"</span>,</span>
<span>  <span class="st">"NCI-Nature_2016"</span>,</span>
<span>  <span class="st">"TRRUST_Transcription_Factors_2019"</span>,</span>
<span>  <span class="st">"MSigDB_Hallmark_2020"</span>,</span>
<span>  <span class="st">"GO_Cellular_Component_2018"</span>,</span>
<span>  <span class="st">"CORUM"</span>,</span>
<span>  <span class="st">"KEGG_2019_Human"</span>,</span>
<span>  <span class="st">"TRANSFAC_and_JASPAR_PWMs"</span>,</span>
<span>  <span class="st">"ENCODE_and_ChEA_Consensus_TFs_from_ChIP-X"</span>,</span>
<span>  <span class="st">"GO_Biological_Process_2018"</span>,</span>
<span>  <span class="st">"GO_Molecular_Function_2018"</span>,</span>
<span>  <span class="st">"Human_Gene_Atlas"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/download_enrichr_databases.html">download_enrichr_databases</a></span><span class="op">(</span></span>
<span>  gene_set_lib <span class="op">=</span> <span class="va">gene_set_lib</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>,   <span class="co"># output into the current working dir (default)</span></span>
<span>  filename <span class="op">=</span> <span class="st">"databases.tsv"</span>   <span class="co"># just the name of the file, not the full path</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Per default the file is placed in the current working directory,
which is the root dir of the R project.</p>
<p>To run GSEA, the downloaded database file has to be loaded as a
dataframe. Further, optionally, the clusterProfiler parameters and the
report dir can be specified. The function create_gsea_report() runs GSEA
using clusterProfiler, generates an HTML report and returns the GSEA
dotplots in R.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify the filepath of the TSV file with the database info</span></span>
<span><span class="va">downloaded_dbs_filepath</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span></span>
<span>  <span class="st">"databases.tsv"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the file</span></span>
<span><span class="va">databases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span></span>
<span>  <span class="va">downloaded_dbs_filepath</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">"\t"</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specify the clusterProfiler parameters</span></span>
<span><span class="va">clusterProfiler_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  pvalueCutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  pAdjustMethod <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>  minGSSize <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  maxGSSize <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  qvalueCutoff <span class="op">=</span> <span class="fl">0.2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">report_dir</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span></span>
<span>  <span class="st">"results"</span>,</span>
<span>  <span class="st">"gsea_reports"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The function below runs the clusterProfiler for all clusters and all
levels, and generates the HTML report:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/run_gsea.html">run_gsea</a></span><span class="op">(</span></span>
<span>  <span class="co"># A dataframe with three columns: feature, cluster, and gene. Feature contains</span></span>
<span>  <span class="co"># the integer index of the feature, cluster the integer specifying the cluster</span></span>
<span>  <span class="co"># number, and gene the string of the gene, such as "CLSTN2".</span></span>
<span>  levels_clustered_hits <span class="op">=</span> <span class="va">clustering_results</span><span class="op">$</span><span class="va">clustered_hits_levels</span>,</span>
<span>  databases <span class="op">=</span> <span class="va">databases</span>,</span>
<span>  clusterProfiler_params <span class="op">=</span> <span class="va">clusterProfiler_params</span>,</span>
<span>  report_info <span class="op">=</span> <span class="va">report_info</span>,</span>
<span>  report_dir <span class="op">=</span> <span class="va">report_dir</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>You can view the generated analysis report of the run_gsea function
<a href="https://drive.google.com/uc?export=view&amp;id=1EvPiEwHyGnBQFxRets00s87tochgyGK4" class="external-link">here</a>.</p>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<pre><code><span><span class="co">#&gt; R version 4.3.3 (2024-02-29)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.5 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/local/R-4.3.3/lib/R/lib/libRblas.so </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=de_AT.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=de_AT.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=de_AT.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=de_AT.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Vienna</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices datasets  utils     methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] knitr_1.48        dplyr_1.1.4       here_1.0.1        readr_2.1.5      </span></span>
<span><span class="co">#&gt; [5] SplineOmics_0.1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] RColorBrewer_1.1-3       rstudioapi_0.16.0        jsonlite_1.8.9          </span></span>
<span><span class="co">#&gt;   [4] shape_1.4.6.1            magrittr_2.0.3           farver_2.1.2            </span></span>
<span><span class="co">#&gt;   [7] nloptr_2.1.1             rmarkdown_2.28           GlobalOptions_0.1.2     </span></span>
<span><span class="co">#&gt;  [10] fs_1.6.4                 ragg_1.3.3               vctrs_0.6.5             </span></span>
<span><span class="co">#&gt;  [13] minqa_1.2.8              base64enc_0.1-3          htmltools_0.5.8.1       </span></span>
<span><span class="co">#&gt;  [16] progress_1.2.3           broom_1.0.7              variancePartition_1.32.5</span></span>
<span><span class="co">#&gt;  [19] sass_0.4.9               KernSmooth_2.23-22       bslib_0.8.0             </span></span>
<span><span class="co">#&gt;  [22] htmlwidgets_1.6.4        desc_1.4.3               pbkrtest_0.5.3          </span></span>
<span><span class="co">#&gt;  [25] plyr_1.8.9               cachem_1.1.0             lifecycle_1.0.4         </span></span>
<span><span class="co">#&gt;  [28] iterators_1.0.14         pkgconfig_2.0.3          Matrix_1.6-5            </span></span>
<span><span class="co">#&gt;  [31] R6_2.5.1                 fastmap_1.2.0            rbibutils_2.3           </span></span>
<span><span class="co">#&gt;  [34] clue_0.3-65              digest_0.6.37            numDeriv_2016.8-1.1     </span></span>
<span><span class="co">#&gt;  [37] colorspace_2.1-1         patchwork_1.3.0          S4Vectors_0.40.2        </span></span>
<span><span class="co">#&gt;  [40] rprojroot_2.0.4          textshaping_0.4.0        fansi_1.0.6             </span></span>
<span><span class="co">#&gt;  [43] compiler_4.3.3           withr_3.0.1              bit64_4.5.2             </span></span>
<span><span class="co">#&gt;  [46] aod_1.3.3                doParallel_1.0.17        backports_1.5.0         </span></span>
<span><span class="co">#&gt;  [49] BiocParallel_1.36.0      viridis_0.6.5            dendextend_1.18.0       </span></span>
<span><span class="co">#&gt;  [52] gplots_3.2.0             MASS_7.3-60.0.1          rjson_0.2.23            </span></span>
<span><span class="co">#&gt;  [55] corpcor_1.6.10           gtools_3.9.5             caTools_1.18.3          </span></span>
<span><span class="co">#&gt;  [58] tools_4.3.3              zip_2.3.1                remaCor_0.0.18          </span></span>
<span><span class="co">#&gt;  [61] glue_1.8.0               nlme_3.1-164             grid_4.3.3              </span></span>
<span><span class="co">#&gt;  [64] cluster_2.1.6            reshape2_1.4.4           generics_0.1.3          </span></span>
<span><span class="co">#&gt;  [67] gtable_0.3.5             tzdb_0.4.0               tidyr_1.3.1             </span></span>
<span><span class="co">#&gt;  [70] hms_1.1.3                utf8_1.2.4               BiocGenerics_0.48.1     </span></span>
<span><span class="co">#&gt;  [73] ggrepel_0.9.6            foreach_1.5.2            pillar_1.9.0            </span></span>
<span><span class="co">#&gt;  [76] stringr_1.5.1            vroom_1.6.5              limma_3.58.1            </span></span>
<span><span class="co">#&gt;  [79] circlize_0.4.16          splines_4.3.3            lattice_0.22-5          </span></span>
<span><span class="co">#&gt;  [82] renv_1.0.10              bit_4.5.0                tidyselect_1.2.1        </span></span>
<span><span class="co">#&gt;  [85] locfit_1.5-9.10          ComplexHeatmap_2.18.0    gridExtra_2.3           </span></span>
<span><span class="co">#&gt;  [88] IRanges_2.36.0           edgeR_4.0.16             svglite_2.1.3           </span></span>
<span><span class="co">#&gt;  [91] RhpcBLASctl_0.23-42      stats4_4.3.3             xfun_0.48               </span></span>
<span><span class="co">#&gt;  [94] Biobase_2.62.0           statmod_1.5.0            matrixStats_1.4.1       </span></span>
<span><span class="co">#&gt;  [97] pheatmap_1.0.12          stringi_1.8.4            yaml_2.3.10             </span></span>
<span><span class="co">#&gt; [100] boot_1.3-29              evaluate_1.0.0           codetools_0.2-19        </span></span>
<span><span class="co">#&gt; [103] tibble_3.2.1             BiocManager_1.30.25      cli_3.6.3               </span></span>
<span><span class="co">#&gt; [106] systemfonts_1.1.0        Rdpack_2.6.1             munsell_0.5.1           </span></span>
<span><span class="co">#&gt; [109] jquerylib_0.1.4          Rcpp_1.0.13              EnvStats_3.0.0          </span></span>
<span><span class="co">#&gt; [112] png_0.1-8                parallel_4.3.3           pkgdown_2.1.1           </span></span>
<span><span class="co">#&gt; [115] ggplot2_3.5.1            prettyunits_1.2.0        bitops_1.0-9            </span></span>
<span><span class="co">#&gt; [118] lme4_1.1-35.5            viridisLite_0.4.2        mvtnorm_1.3-1           </span></span>
<span><span class="co">#&gt; [121] lmerTest_3.1-3           scales_1.3.0             openxlsx_4.2.7.1        </span></span>
<span><span class="co">#&gt; [124] purrr_1.0.2              crayon_1.5.3             fANCOVA_0.6-1           </span></span>
<span><span class="co">#&gt; [127] GetoptLong_1.0.5         rlang_1.1.4</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Rauter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
