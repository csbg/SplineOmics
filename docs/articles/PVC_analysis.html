<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>PVC_analysis • SplineOmics</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="PVC_analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SplineOmics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/CHANGELOG.html">Changelog</a></li>
    <li><a class="dropdown-item" href="../articles/design_limma_design_formula.html">Designing a Limma Design Formula</a></li>
    <li><a class="dropdown-item" href="../articles/Docker_permission_denied.html">Docker_permission_denied</a></li>
    <li><a class="dropdown-item" href="../articles/Docker-instructions.html">Docker-instructions</a></li>
    <li><a class="dropdown-item" href="../articles/get-started.html">get-started</a></li>
    <li><a class="dropdown-item" href="../articles/glycan-analysis.html">Glycan-analysis</a></li>
    <li><a class="dropdown-item" href="../articles/limma_result_categories.html">limma_result_categories</a></li>
    <li><a class="dropdown-item" href="../articles/PVC_analysis.html">PVC_analysis</a></li>
    <li><a class="dropdown-item" href="../articles/RNA-seq-analysis.html">RNA-seq-analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/CHANGELOG.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/csbg/SplineOmics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>PVC_analysis</h1>
                        <h4 data-toc-skip class="author">Thomas
Rauter</h4>
            
            <h4 data-toc-skip class="date">23 April, 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/csbg/SplineOmics/blob/HEAD/vignettes/PVC_analysis.Rmd" class="external-link"><code>vignettes/PVC_analysis.Rmd</code></a></small>
      <div class="d-none name"><code>PVC_analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="about-this-tutorial">About this tutorial<a class="anchor" aria-label="anchor" href="#about-this-tutorial"></a>
</h2>
<p>This tutorial demonstrates the <strong>excursion-analysis</strong>
capabilities of the <code>SplineOmics</code> package by walking through
a complete, real-world example from start to finish.</p>
<p>In the context of time series data, an <strong>excursion</strong>
refers to a <strong>transient deviation from a baseline</strong> — a
concept borrowed from signal processing. These short-term, local shifts
can reveal biologically meaningful events that are not captured by
global trends.</p>
<p>Details of how excursions are detected are described in the section
on the <strong>PVC test</strong>, a method specifically designed to
identify such local patterns.</p>
<p>While the core strength of <code>SplineOmics</code> lies in modeling
<strong>global temporal patterns</strong> using smoothing splines, many
biologically important phenomena present as <strong>localized
events</strong>. These may not be well captured by standard spline fits
due to their smooth and global nature.</p>
<p>For example, in phosphoproteomics data, you might observe a
<strong>sharp, temporary phosphorylation spike</strong> at a specific
timepoint following a stimulus — a pattern that returns to baseline
shortly afterward. Such a transient peak can indicate a key signaling
activation event that is <strong>functionally critical</strong>, but
would be smoothed out or diluted in traditional spline-based
analyses.</p>
<p>To handle these scenarios, we developed the <strong>PVC test</strong>
(described below), which is specifically designed to detect such
<strong>sharp, local excursions</strong> in time-resolved omics
data.</p>
<div class="section level3">
<h3 id="note-1">Note 1<a class="anchor" aria-label="anchor" href="#note-1"></a>
</h3>
<p>The documentation of all the <strong>SplineOmics</strong> package
functions can be viewed <a href="https://csbg.github.io/SplineOmics/reference">here</a></p>
</div>
<div class="section level3">
<h3 id="note-2">Note 2<a class="anchor" aria-label="anchor" href="#note-2"></a>
</h3>
<p>This vignette focuses on the <strong>excursion-analysis</strong>. The
general functionalities of <code>SplineOmics</code> are explained in the
<strong>get-started</strong> vignette.</p>
</div>
</div>
<div class="section level2">
<h2 id="the-pvc-test">The PVC Test<a class="anchor" aria-label="anchor" href="#the-pvc-test"></a>
</h2>
<p><strong>PVC</strong> stands for <strong>P</strong>eak,
<strong>V</strong>alley, and <strong>C</strong>liff. The PVC test is a
method to identify these distinct local patterns (called excursions) in
time series data using a compound contrast approach within the
<strong>limma</strong> framework.</p>
<p>In this context:</p>
<ul>
<li>A <strong>peak</strong> occurs when a timepoint is significantly
<strong>higher</strong> than both its immediate neighbors.</li>
<li>A <strong>valley</strong> occurs when a timepoint is significantly
<strong>lower</strong> than both its neighbors.</li>
<li>A <strong>cliff</strong> describes a sharp directional shift: when
one neighbor is similar in value, but the other is <strong>significantly
different</strong> (higher or lower).</li>
</ul>
<div class="section level3">
<h3 id="method">Method<a class="anchor" aria-label="anchor" href="#method"></a>
</h3>
<p>The PVC analysis is implemented as a <strong>rolling, compound
contrast</strong> applied across the time series. Specifically, a window
of three consecutive timepoints is evaluated at a time:<br><code>(Tᵢ₋₁, Tᵢ, Tᵢ₊₁)</code><br>
where <code>Tᵢ</code> is the center of the window.</p>
<p>The first and last timepoints are excluded from this analysis, since
they lack both left and right neighbors.</p>
<p>For each triplet, a contrast is defined as:</p>
<p>2*Tᵢ - Tᵢ₋₁ - Tᵢ₊₁</p>
<p>This contrast measures whether the center point <code>Tᵢ</code>
deviates from both its neighbors in the same direction:</p>
<ul>
<li>If <code>Tᵢ</code> is <strong>greater than both neighbors</strong> →
large positive contrast → indicates a <strong>peak</strong>
</li>
<li>If <code>Tᵢ</code> is <strong>lower than both neighbors</strong> →
large negative contrast → indicates a <strong>valley</strong>
</li>
<li>If <code>Tᵢ</code> lies <strong>between</strong> its neighbors →
effects cancel → contrast is near zero → <strong>no signal</strong>
</li>
</ul>
<p>This contrast is tested using <code>limma</code>, and the result is a
p-value that indicates whether the observed pattern is statistically
significant for each feature (e.g., gene, phosphosite).</p>
</div>
<div class="section level3">
<h3 id="multiple-testing-correction">Multiple Testing Correction<a class="anchor" aria-label="anchor" href="#multiple-testing-correction"></a>
</h3>
<p>Because the test is performed independently at each center timepoint
across all features, <strong>multiple testing correction</strong> is
applied at the <strong>timepoint level</strong>. This ensures that
significance is not inflated due to repeated testing across
features.</p>
<p>Importantly, PVC does <strong>not</strong> assess whether an entire
feature contains a full peak/valley/cliff pattern over time — it
evaluates <strong>each timepoint independently</strong> for such local
patterns.</p>
</div>
</div>
<div class="section level2">
<h2 id="details-about-the-dataset">Details about the dataset<a class="anchor" aria-label="anchor" href="#details-about-the-dataset"></a>
</h2>
<p>The example dataset used here involves a <strong>time-series
proteomics experiment</strong>, where CHO (chinese hamster ovary) cells
were cultivated in three bioreactors (three biological replicates). The
experiment includes the following setup:</p>
<ul>
<li>Samples were taken both during the <strong>exponential</strong> and
<strong>stationary growth phases</strong>.</li>
<li>Samples were collected in triplicates from each reactor at defined
timepoints relative to cell feeding:
<ul>
<li>60 minutes before feeding</li>
<li>15, 60, 90, 120, and 240 minutes after feeding</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="load-the-packages">Load the packages<a class="anchor" aria-label="anchor" href="#load-the-packages"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://csbg.github.io/SplineOmics">SplineOmics</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span> <span class="co"># For managing filepaths</span></span>
<span><span class="co">#&gt; here() starts at /home/thomas/Documents/PhD/projects/DGTX/SplineOmics_hub/SplineOmics</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span> <span class="co"># For data manipulation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-the-files">Load the files<a class="anchor" aria-label="anchor" href="#load-the-files"></a>
</h2>
<p>In this example, the proteomics_data.rds file contains the numeric
values (the intensities) and also the feature descriptions, such as gene
and protein name (= annotation part). Usually, you would load the data
from for example an Excel file, but the .rds file is more compressed,
which is the reason this format was chosen here to limit the size of the
SplineOmics package.</p>
<p>The file meta.xlsx contains the meta information, which are the
descriptions of the columns of the numeric values of data.</p>
<p>(These example files are part of the package and don’t have to be
present on your system).</p>
<p>Please note that this dataset is an actual experimental dataset, but
the annotation information, such as gene names, has been removed since
it was not yet published at the time of making the SplineOmics package
public. Instead, the dataset includes randomly generated gene symbols
and gene names corresponding to Cricetulus griseus (Chinese Hamster) for
each row. This is intended to demonstrate the functionality of the
package.</p>
<p>The left part of data contains the numeric values, and the right part
the annotation info, which can be copied in a separate dataframe, as
shown below.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">xzfile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"extdata"</span>,</span>
<span>  <span class="st">"proteomics_data.rds.xz"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"SplineOmics"</span></span>
<span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>    <span class="st">"extdata"</span>,</span>
<span>    <span class="st">"proteomics_meta.csv"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">"SplineOmics"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract the annotation part from the dataframe.</span></span>
<span><span class="va">first_na_col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">annotation</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">(</span><span class="va">first_na_col</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 40</span></span></span>
<span><span class="co">#&gt;   `Sample ID`  `1`   `2`   `3`   `4`   `5`   `6`   `7`   `8`   `9`   `10`  `11` </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Reactor      E09   E10   E12   E09   E10   E12   E09   E10   E12   E09   E10  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Time Point   TP01  TP01  TP01  TP02  TP02  TP02  TP03  TP03  TP03  TP04  TP04 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Phase of Fe… Expo… Expo… Expo… Expo… Expo… Expo… Expo… Expo… Expo… Expo… Expo…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> <span style="color: #BB0000;">NA</span>           15.2… 15.2… 15.3… 15.1… 15.2… 15.0… 15.2… 15.2… 15.2… 15.1… 15.2…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> <span style="color: #BB0000;">NA</span>           15.0… 15.1… 15.2… 15.1… 15.1… 15.2… 15.2… 15.3… 15.2… 15.1… 15.1…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> <span style="color: #BB0000;">NA</span>           14.5… 14.7… 14.6… 14.5… 14.6… 14.6… 14.5… 14.6… 14.7… 14.5… 14.6…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 28 more variables: `12` &lt;chr&gt;, `13` &lt;chr&gt;, `14` &lt;chr&gt;, `15` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `16` &lt;chr&gt;, `17` &lt;chr&gt;, `18` &lt;chr&gt;, `19` &lt;chr&gt;, `20` &lt;chr&gt;, `21` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `22` &lt;chr&gt;, `23` &lt;chr&gt;, `24` &lt;chr&gt;, `25` &lt;chr&gt;, `26` &lt;chr&gt;, `27` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `28` &lt;chr&gt;, `29` &lt;chr&gt;, `30` &lt;chr&gt;, `31` &lt;chr&gt;, `32` &lt;chr&gt;, `33` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `34` &lt;chr&gt;, `35` &lt;chr&gt;, `36` &lt;chr&gt;, ...38 &lt;lgl&gt;, Gene_symbol &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   Gene_name &lt;chr&gt;</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">meta</span><span class="op">)</span></span>
<span><span class="co">#&gt;               Sample.ID Reactor Time.Point       Phase Time</span></span>
<span><span class="co">#&gt; 1  E09_TP01_Exponential     E09       TP01 Exponential  -60</span></span>
<span><span class="co">#&gt; 2  E10_TP01_Exponential     E10       TP01 Exponential  -60</span></span>
<span><span class="co">#&gt; 3  E12_TP01_Exponential     E12       TP01 Exponential  -60</span></span>
<span><span class="co">#&gt; 4  E09_TP02_Exponential     E09       TP02 Exponential   15</span></span>
<span><span class="co">#&gt; 5  E10_TP02_Exponential     E10       TP02 Exponential   15</span></span>
<span><span class="co">#&gt; 6  E12_TP02_Exponential     E12       TP02 Exponential   15</span></span>
<span><span class="co">#&gt; 7  E09_TP03_Exponential     E09       TP03 Exponential   60</span></span>
<span><span class="co">#&gt; 8  E10_TP03_Exponential     E10       TP03 Exponential   60</span></span>
<span><span class="co">#&gt; 9  E12_TP03_Exponential     E12       TP03 Exponential   60</span></span>
<span><span class="co">#&gt; 10 E09_TP04_Exponential     E09       TP04 Exponential   90</span></span>
<span><span class="co">#&gt; 11 E10_TP04_Exponential     E10       TP04 Exponential   90</span></span>
<span><span class="co">#&gt; 12 E12_TP04_Exponential     E12       TP04 Exponential   90</span></span>
<span><span class="co">#&gt; 13 E09_TP05_Exponential     E09       TP05 Exponential  120</span></span>
<span><span class="co">#&gt; 14 E10_TP05_Exponential     E10       TP05 Exponential  120</span></span>
<span><span class="co">#&gt; 15 E12_TP05_Exponential     E12       TP05 Exponential  120</span></span>
<span><span class="co">#&gt; 16 E09_TP06_Exponential     E09       TP06 Exponential  240</span></span>
<span><span class="co">#&gt; 17 E10_TP06_Exponential     E10       TP06 Exponential  240</span></span>
<span><span class="co">#&gt; 18 E12_TP06_Exponential     E12       TP06 Exponential  240</span></span>
<span><span class="co">#&gt; 19  E09_TP07_Stationary     E09       TP07  Stationary  -60</span></span>
<span><span class="co">#&gt; 20  E10_TP07_Stationary     E10       TP07  Stationary  -60</span></span>
<span><span class="co">#&gt; 21  E12_TP07_Stationary     E12       TP07  Stationary  -60</span></span>
<span><span class="co">#&gt; 22  E09_TP08_Stationary     E09       TP08  Stationary   15</span></span>
<span><span class="co">#&gt; 23  E10_TP08_Stationary     E10       TP08  Stationary   15</span></span>
<span><span class="co">#&gt; 24  E12_TP08_Stationary     E12       TP08  Stationary   15</span></span>
<span><span class="co">#&gt; 25  E09_TP09_Stationary     E09       TP09  Stationary   60</span></span>
<span><span class="co">#&gt; 26  E10_TP09_Stationary     E10       TP09  Stationary   60</span></span>
<span><span class="co">#&gt; 27  E12_TP09_Stationary     E12       TP09  Stationary   60</span></span>
<span><span class="co">#&gt; 28  E09_TP10_Stationary     E09       TP10  Stationary   90</span></span>
<span><span class="co">#&gt; 29  E10_TP10_Stationary     E10       TP10  Stationary   90</span></span>
<span><span class="co">#&gt; 30  E12_TP10_Stationary     E12       TP10  Stationary   90</span></span>
<span><span class="co">#&gt; 31  E09_TP11_Stationary     E09       TP11  Stationary  120</span></span>
<span><span class="co">#&gt; 32  E10_TP11_Stationary     E10       TP11  Stationary  120</span></span>
<span><span class="co">#&gt; 33  E12_TP11_Stationary     E12       TP11  Stationary  120</span></span>
<span><span class="co">#&gt; 34  E09_TP12_Stationary     E09       TP12  Stationary  240</span></span>
<span><span class="co">#&gt; 35  E10_TP12_Stationary     E10       TP12  Stationary  240</span></span>
<span><span class="co">#&gt; 36  E12_TP12_Stationary     E12       TP12  Stationary  240</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">annotation</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4,162 × 2</span></span></span>
<span><span class="co">#&gt;    Gene_symbol  Gene_name                                              </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> LOC113838844 cone-rod homeobox protein-like                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Wdr83os      WD repeat domain 83 opposite strand                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Cubn         cubilin                                                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Dynlt1       dynein light chain Tctex-type 1                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Ostc         oligosaccharyltransferase complex non-catalytic subunit</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Unc5cl       unc-5 family C-terminal like                           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Cfl1         cofilin 1                                              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> LOC100752202 HEN methyltransferase 1                                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> LOC100755162 acyl-coenzyme A synthetase ACSM5, mitochondrial        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> LOC100768921 40S ribosomal protein S21                              </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4,152 more rows</span></span></span></code></pre></div>
<div class="section level3">
<h3 id="bring-the-inputs-into-the-standardized-format">Bring the Inputs into the Standardized Format<a class="anchor" aria-label="anchor" href="#bring-the-inputs-into-the-standardized-format"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/extract_data.html">extract_data</a></span><span class="op">(</span></span>
<span>  <span class="co"># The dataframe with the numbers on the left and info on the right.</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  <span class="co"># Use this annotation column for the feature names.</span></span>
<span>  feature_name_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gene_name"</span><span class="op">)</span>,</span>
<span>  top_row <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  bottom_row <span class="op">=</span> <span class="fl">4165</span>,</span>
<span>  right_col <span class="op">=</span> <span class="fl">37</span>,</span>
<span>  left_col <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="splineomics-object">SplineOmics Object<a class="anchor" aria-label="anchor" href="#splineomics-object"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Those fields are mandatory, because we believe that when such a report is</span></span>
<span><span class="co"># opened after half a year, those infos can be very helpful.</span></span>
<span><span class="va">report_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  omics_data_type <span class="op">=</span> <span class="st">"PTX"</span>,</span>
<span>  data_description <span class="op">=</span> <span class="st">"Proteomics data of CHO cells"</span>,</span>
<span>  data_collection_date <span class="op">=</span> <span class="st">"February 2024"</span>,</span>
<span>  analyst_name <span class="op">=</span> <span class="st">"Thomas Rauter"</span>,</span>
<span>  contact_info <span class="op">=</span> <span class="st">"thomas.rauter@plus.ac.at"</span>,</span>
<span>  project_name <span class="op">=</span> <span class="st">"DGTX"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># splineomics now contains the SplineOmics object.</span></span>
<span><span class="va">splineomics</span> <span class="op">&lt;-</span> <span class="fu">SplineOmics</span><span class="fu">::</span><span class="fu"><a href="../reference/create_splineomics.html">create_splineomics</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  meta <span class="op">=</span> <span class="va">meta</span>,</span>
<span>  annotation <span class="op">=</span> <span class="va">annotation</span>,</span>
<span>  report_info <span class="op">=</span> <span class="va">report_info</span>,</span>
<span>  condition <span class="op">=</span> <span class="st">"Phase"</span>, <span class="co"># Column of meta that contains the levels.</span></span>
<span>  meta_batch_column <span class="op">=</span> <span class="st">"Reactor"</span>, <span class="co"># For batch effect removal</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="run-the-pvc-analysis">Run the PVC-analysis<a class="anchor" aria-label="anchor" href="#run-the-pvc-analysis"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_info</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  y_axis_label <span class="op">=</span> <span class="st">"log2 intensity"</span>,</span>
<span>  time_unit <span class="op">=</span> <span class="st">"min"</span>,</span>
<span>  treatment_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"feeding"</span><span class="op">)</span>,</span>
<span>  treatment_timepoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Column 'Reactor' of meta will be used to remove the batch effect for the plotting</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Detected 0 total pattern hits for condition level: Exponential</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Summary by pattern type:</span></span>
<span><span class="co">#&gt; p: 0, v: 0, b: 0, t: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Breakdown by timepoint:</span></span>
<span><span class="co">#&gt; -60: p=0; v=0; b=0; t=0</span></span>
<span><span class="co">#&gt; 15: p=0; v=0; b=0; t=0</span></span>
<span><span class="co">#&gt; 60: p=0; v=0; b=0; t=0</span></span>
<span><span class="co">#&gt; 90: p=0; v=0; b=0; t=0</span></span>
<span><span class="co">#&gt; 120: p=0; v=0; b=0; t=0</span></span>
<span><span class="co">#&gt; 240: p=0; v=0; b=0; t=0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Detected 0 total pattern hits for condition level: Stationary</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Summary by pattern type:</span></span>
<span><span class="co">#&gt; p: 0, v: 0, b: 0, t: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Breakdown by timepoint:</span></span>
<span><span class="co">#&gt; -60: p=0; v=0; b=0; t=0</span></span>
<span><span class="co">#&gt; 15: p=0; v=0; b=0; t=0</span></span>
<span><span class="co">#&gt; 60: p=0; v=0; b=0; t=0</span></span>
<span><span class="co">#&gt; 90: p=0; v=0; b=0; t=0</span></span>
<span><span class="co">#&gt; 120: p=0; v=0; b=0; t=0</span></span>
<span><span class="co">#&gt; 240: p=0; v=0; b=0; t=0</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Info</span> PVC report generation completed successfully.</span></span>
<span><span class="co">#&gt;  Your HTML reports are located in the directory:  /home/thomas/Documents/PhD/projects/DGTX/SplineOmics_hub/SplineOmics/results/pvc_report .</span></span>
<span><span class="co">#&gt;  Please note that due to embedded files, the reports might be flagged as</span></span>
<span><span class="co">#&gt;  harmful by other software. Rest assured that they provide no harm.</span></span></code></pre>
<p>The terminal output of the function gives information about the total
amount of excursions found in each level, and also a breakdown by
timepoint and type of excursion (p = peak, v = valley, b = bottom of
cliff, t = top of cliff, always for the respective timepoint that is
mentioned in that row). <a href="https://csbg.github.io/SplineOmics_html_reports/pvc_report_PTX.html">Here</a>
you can see the resulting HTML report.</p>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<pre><code><span><span class="co">#&gt; R version 4.3.3 (2024-02-29)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.5 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/local/R-4.3.3/lib/R/lib/libRblas.so </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=de_AT.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=de_AT.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=de_AT.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=de_AT.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Vienna</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices datasets  utils     methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] dplyr_1.1.4       here_1.0.1        SplineOmics_0.2.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] Rdpack_2.6.2             bitops_1.0-9             gridExtra_2.3           </span></span>
<span><span class="co">#&gt;   [4] rlang_1.1.5              magrittr_2.0.3           clue_0.3-66             </span></span>
<span><span class="co">#&gt;   [7] GetoptLong_1.0.5         matrixStats_1.5.0        compiler_4.3.3          </span></span>
<span><span class="co">#&gt;  [10] reshape2_1.4.4           png_0.1-8                systemfonts_1.2.1       </span></span>
<span><span class="co">#&gt;  [13] vctrs_0.6.5              stringr_1.5.1            pkgconfig_2.0.3         </span></span>
<span><span class="co">#&gt;  [16] shape_1.4.6.1            crayon_1.5.3             fastmap_1.2.0           </span></span>
<span><span class="co">#&gt;  [19] backports_1.5.0          utf8_1.2.4               caTools_1.18.3          </span></span>
<span><span class="co">#&gt;  [22] rmarkdown_2.29           nloptr_2.1.1             ragg_1.3.3              </span></span>
<span><span class="co">#&gt;  [25] purrr_1.0.4              xfun_0.50                cachem_1.1.0            </span></span>
<span><span class="co">#&gt;  [28] jsonlite_1.8.9           progress_1.2.3           EnvStats_3.0.0          </span></span>
<span><span class="co">#&gt;  [31] remaCor_0.0.18           BiocParallel_1.36.0      broom_1.0.7             </span></span>
<span><span class="co">#&gt;  [34] parallel_4.3.3           prettyunits_1.2.0        cluster_2.1.6           </span></span>
<span><span class="co">#&gt;  [37] R6_2.6.1                 bslib_0.9.0              stringi_1.8.4           </span></span>
<span><span class="co">#&gt;  [40] RColorBrewer_1.1-3       limma_3.58.1             boot_1.3-29             </span></span>
<span><span class="co">#&gt;  [43] numDeriv_2016.8-1.1      jquerylib_0.1.4          Rcpp_1.0.14             </span></span>
<span><span class="co">#&gt;  [46] iterators_1.0.14         knitr_1.49               base64enc_0.1-3         </span></span>
<span><span class="co">#&gt;  [49] IRanges_2.36.0           Matrix_1.6-5             splines_4.3.3           </span></span>
<span><span class="co">#&gt;  [52] tidyselect_1.2.1         rstudioapi_0.17.1        yaml_2.3.10             </span></span>
<span><span class="co">#&gt;  [55] viridis_0.6.5            doParallel_1.0.17        gplots_3.2.0            </span></span>
<span><span class="co">#&gt;  [58] codetools_0.2-19         plyr_1.8.9               lmerTest_3.1-3          </span></span>
<span><span class="co">#&gt;  [61] lattice_0.22-5           tibble_3.2.1             withr_3.0.2             </span></span>
<span><span class="co">#&gt;  [64] Biobase_2.62.0           evaluate_1.0.3           desc_1.4.3              </span></span>
<span><span class="co">#&gt;  [67] zip_2.3.2                circlize_0.4.16          pillar_1.10.1           </span></span>
<span><span class="co">#&gt;  [70] BiocManager_1.30.25      KernSmooth_2.23-22       renv_1.1.1              </span></span>
<span><span class="co">#&gt;  [73] foreach_1.5.2            stats4_4.3.3             reformulas_0.4.0        </span></span>
<span><span class="co">#&gt;  [76] generics_0.1.3           rprojroot_2.0.4          S4Vectors_0.40.2        </span></span>
<span><span class="co">#&gt;  [79] hms_1.1.3                ggplot2_3.5.1            munsell_0.5.1           </span></span>
<span><span class="co">#&gt;  [82] scales_1.3.0             aod_1.3.3                minqa_1.2.8             </span></span>
<span><span class="co">#&gt;  [85] gtools_3.9.5             RhpcBLASctl_0.23-42      glue_1.8.0              </span></span>
<span><span class="co">#&gt;  [88] pheatmap_1.0.12          tools_4.3.3              fANCOVA_0.6-1           </span></span>
<span><span class="co">#&gt;  [91] dendextend_1.19.0        variancePartition_1.32.5 lme4_1.1-36             </span></span>
<span><span class="co">#&gt;  [94] openxlsx_4.2.8           mvtnorm_1.3-3            fs_1.6.5                </span></span>
<span><span class="co">#&gt;  [97] grid_4.3.3               tidyr_1.3.1              rbibutils_2.3           </span></span>
<span><span class="co">#&gt; [100] colorspace_2.1-1         nlme_3.1-164             patchwork_1.3.0         </span></span>
<span><span class="co">#&gt; [103] cli_3.6.4                textshaping_1.0.0        viridisLite_0.4.2       </span></span>
<span><span class="co">#&gt; [106] svglite_2.1.3            ComplexHeatmap_2.18.0    corpcor_1.6.10          </span></span>
<span><span class="co">#&gt; [109] gtable_0.3.6             sass_0.4.9               digest_0.6.37           </span></span>
<span><span class="co">#&gt; [112] BiocGenerics_0.48.1      pbkrtest_0.5.3           ggrepel_0.9.6           </span></span>
<span><span class="co">#&gt; [115] rjson_0.2.23             htmlwidgets_1.6.4        farver_2.1.2            </span></span>
<span><span class="co">#&gt; [118] htmltools_0.5.8.1        pkgdown_2.1.1            lifecycle_1.0.4         </span></span>
<span><span class="co">#&gt; [121] GlobalOptions_0.1.2      statmod_1.5.0            MASS_7.3-60.0.1</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Rauter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
