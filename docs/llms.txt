# SplineOmics

[![License:
MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://csbg.github.io/SplineOmics/LICENSE)
![Maintained?
Yes](https://img.shields.io/badge/Maintained%3F-yes-brightgreen.svg)[![R-CMD-check](https://github.com/csbg/SplineOmics/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/csbg/SplineOmics/actions/workflows/R-CMD-check.yaml)
[![Docker](https://img.shields.io/badge/docker-pull-blue)](https://hub.docker.com/r/thomasrauter/splineomics)
![Platforms](https://img.shields.io/badge/platforms-all-brightgreen)

![](reference/figures/hex_logo.png)

The R package `SplineOmics` finds the significant features (hits) of
time-series -omics data by using splines and `limma` for hypothesis
testing. It then clusters the hits based on the spline shape while
showing all results in summary HTML reports.

The graphical abstract below shows the full workflow streamlined by
`SplineOmics`:

![Graphical Abstract of SplineOmics
Workflow](reference/figures/SplineOmics_graphical_abstract.png)

Graphical Abstract of SplineOmics Workflow

## Table of Contents

- [ðŸ“˜ Introduction](#id_-introduction)
- [ðŸ”§ Installation](#id_-installation)
  - [ðŸ³ Docker Container](#id_-docker-container)
- [â–¶ï¸ Usage](#id_-usage)
  - [ðŸŽ“ Tutorial](#id_-tutorial)
  - [ðŸ“‹ Details](#id_-details)
  - [ðŸ§¬ RNA-seq and Glycan Data](#id_-rna-seq-and-glycan-data)
- [ðŸ“¦ Dependencies](#id_-dependencies)
- [ðŸ“š Further Reading](#id_-further-reading)
- [â“ Getting Help](#id_-getting-help)
- [ðŸ’¬ Feedback](#id_-feedback)
- [ðŸ“œ License](#id_-license)
- [ðŸŽ“ Citation](#id_-citation)
- [ðŸŒŸ Contributors](#id_-contributors)
- [ðŸ™ Acknowledgements](#id_-acknowledgements)
- [â­ Liking this project](#liking-this-project)

## ðŸ“˜ Introduction

Welcome to `SplineOmics`, an R package designed to streamline the
analysis of -omics time-series data, followed by automated HTML report
generation.

### Is the SplineOmics package of use for me?

If you have -omics data over time, the package will help you to run
`limma` with splines, perform the clustering, run ORA and show result
plots in HTML reports. Any time-series data that is a valid input to the
`limma` package is also a valid input to the `SplineOmics` package (such
as transcriptomics, proteomics, phosphoproteomics, metabolomics, glycan
fractional abundances, etc.).

### What do I need precisely?

1.  **Data**: A data matrix where each row is a feature (e.g., protein,
    metabolite, etc.) and each column is a sample taken at a specific
    time. The data must have no NA values, should have normally
    distributed features and no dependence between the samples.

2.  **Meta**: A table with metadata on the columns/samples of the data
    matrix (e.g., batch, time point, etc.)

3.  **Annotation** (optional): A table with identifiers on the
    rows/features of the data matrix (e.g., gene and protein name).

### Capabilities

With `SplineOmics`, you can:

- **Automatically perform exploratory data analysis:**

  The
  [`explore_data()`](https://csbg.github.io/SplineOmics/reference/explore_data.md)
  function generates an HTML report, containing various plots, such as
  density, PCA, and correlation heatmap plots ([example
  report](https://csbg.github.io/SplineOmics_html_reports/explore_data_PTX.html)).

- **Perform limma spline analysis:**

  Use the
  [`run_limma_splines()`](https://csbg.github.io/SplineOmics/reference/run_limma_splines.md)
  function to perform the `limma` analysis with splines once the optimal
  hyperparameters are identified ([example
  report](https://csbg.github.io/SplineOmics_html_reports/create_limma_report_PTX.html)).

- **Find jumps and drops in the timecourse:**

  Use the
  [`find_pvc()`](https://csbg.github.io/SplineOmics/reference/find_pvc.md)
  function for that ([example
  report](https://csbg.github.io/SplineOmics_html_reports/pvc_report_PPTX.html)).

- **Cluster significant features:**

  Cluster the significant features (hits) identified in the spline
  analysis with the
  [`cluster_hits()`](https://csbg.github.io/SplineOmics/reference/cluster_hits.md)
  function ([example
  report](https://csbg.github.io/SplineOmics_html_reports/report_clustered_hits_PTX.html)).

- **Run ORA with clustered hits:**

  Perform over-representation analysis (ORA) using the clustered hits
  with the
  [`run_ora()`](https://csbg.github.io/SplineOmics/reference/run_ora.md)
  function ([example
  report](https://csbg.github.io/SplineOmics_html_reports/run_ora_report.html)).

## ðŸ”§ Installation

Follow the steps below to install the `SplineOmics` package from the
GitHub repository into your R environment.

> **Note** Carefully read the terminal messages of the installations. It
> can happen that installations fail due to missing dependencies, which
> you then must resolve using other commands not necessarily written
> down here.

#### Prerequisites

- Ensure **R** is installed on your system. If not, download and install
  it from [CRAN](https://cran.r-project.org/).
- **RStudio** is recommended for a more user-friendly experience with R.
  Download and install RStudio from
  [posit.co](https://posit.co/download/rstudio-desktop/).

#### Installation Steps

> **Note for Windows Users:**

During the installation on Windows, you might see a message indicating
that Rtools is not installed, which is typically required for compiling
R packages from source. However, for this installation, Rtools is not
necessary, and you can safely ignore this message.

1.  **Open RStudio** or your R console in a new or existing project
    folder.

2.  Create a **virtual environment** with `renv`

``` r
renv::init()
```

3.  **Install `BiocManager`** for Bioconductor dependencies (if not
    already installed)

``` r
install.packages("BiocManager")
```

4.  Install required Bioconductor packages

``` r
BiocManager::install(
  c("ComplexHeatmap", "limma", "variancePartition")
  # force = TRUE   # when encountering issues
)
```

5.  Install `remotes` for GitHub package installation

``` r
install.packages("remotes")
```

5.  **Install** the **`SplineOmics`** package from GitHub and all its
    non-Bioconductor dependencies, using `remotes`

``` r
remotes::install_github(
  "csbg/SplineOmics",   # GitHub repository
  ref = "<tag>",        # Version to install, e.g. v0.4.2 
  dependencies = TRUE,  # Install all dependencies
  upgrade = "always"    # Always upgrade dependencies
  # force = TRUE        # when encountering issues
)
```

6.  **Verify** the **installation** of the `SplineOmics` package:

``` r
pkg <- "SplineOmics"
ver <- "0.4.2"

status <- tryCatch({
  library(pkg, character.only = TRUE)
  packageVersion(pkg) == ver
}, error = function(e) FALSE)

if (status) {
  message(sprintf("%s version %s is installed correctly.", pkg, ver))
} else {
  message(sprintf("%s version %s is NOT installed correctly.", pkg, ver))
}
```

ðŸ“Œ **Note on documentation:**  
The website only contains the documentation for the most recent
`SplineOmics` version. To get the documentation of any currently
installed version, run:

``` r
help(package="SplineOmics")
```

#### Troubleshooting

If you encounter errors related to dependencies or package versions
during installation, try updating your R and RStudio to the latest
versions and repeat the installation steps.

For issues specifically related to the `SplineOmics` package, check the
[Issues section](https://github.com/csbg/SplineOmics/issues) of the
GitHub repository for similar problems or to post a new issue.

### ðŸ³ Docker Container

Alternatively, you can run your analysis in a `Docker` container. The
underlying `Docker` image encapsulates the `SplineOmics` package
together with the necessary environment and dependencies. This ensures
higher levels of reproducibility because the analysis is carried out in
a consistent environment, independent of the operating system and its
custom configurations.

Please note that you must have the `Docker Engine` installed on your
machine. For instructions on how to install it, consult the official
[Docker Engine installation
guide](https://docs.docker.com/engine/install/).

More information about `Docker` containers can be found on the [official
Docker page](https://www.docker.com/resources/what-container/).

For instructions on downloading the image of the `SplineOmics` package
and running the container, please refer to the [Docker
instructions](https://csbg.github.io/SplineOmics/articles/Docker-instructions.html).

#### Troubleshooting

If you face â€œpermission deniedâ€ issues on Linux distributions, check
this
[vignette](https://csbg.github.io/SplineOmics/articles/Docker_permission_denied.html).

## â–¶ï¸ Usage

### ðŸŽ“ Tutorial

[This
tutorial](https://csbg.github.io/SplineOmics/articles/get-started.html)
covers a real CHO cell time-series proteomics example from start to end.

### ðŸ“‹ Details

A detailed description of all arguments and outputs of all the functions
in the package (exported and internal functions) can be found
[here](https://csbg.github.io/SplineOmics/reference/).

#### Design `limma` design formula

A quick guide on how to design a `limma` design formula can be found
[here](https://csbg.github.io/SplineOmics/articles/design_limma_design_formula.html).

An explanation of the three different `limma` results is
[here](https://csbg.github.io/SplineOmics/articles/limma_result_categories.html).

### ðŸ§¬ RNA-seq and Glycan Data

#### RNA-seq data

Transcriptomics data must be preprocessed for `limma`. You need to
provide an appropriate object, such as a `voom` object, in the
`rna_seq_data` argument of the `SplineOmics` object (see
[documentation](https://csbg.github.io/SplineOmics/reference/create_splineomics.html)).
Along with this, the normalized matrix (e.g., the `$E` slot of the
`voom` object) must be passed to the `data` argument. This allows
flexibility in preprocessing; you can use any method you prefer as long
as the final object and matrix are compatible with limma. One way to
preprocess your RNA-seq data is by using the
[`preprocess_rna_seq_data()`](https://csbg.github.io/SplineOmics/reference/preprocess_rna_seq_data.md)
function included in the `SplineOmics` package (see
[documentation](https://csbg.github.io/SplineOmics/reference/preprocess_rna_seq_data.html)).

[Here](https://csbg.github.io/SplineOmics/articles/RNA-seq%20analysis.html)
you can find an example analysis of RNA-seq data with the SplineOmics
package.

#### Glycan fractional abundance data

The glycan fractional abundance data matrix, where each row represents a
type of glycan and the columns correspond to timepoints, must be
transformed before analysis. This preprocessing step is essential due to
the compositional nature of the data. In compositional data, an increase
in the abundance of one component (glycan) necessarily results in a
decrease in others, introducing a dependency among the variables that
can bias the analysis. One way to address this issue is by applying the
Centered Log Ratio (CLR) transformation to the data with the clr
function from the compositions package:

``` r
library(compositions)
clr_transformed_data <- clr(data_matrix)  # use as SplineOmics input
```

The results from clr transformed data can be harder to understand and
interpret however. If you prefer ease of interpretation and are fine
that the results contain some artifacts due to the compositional nature
of the data, log2 transform your data instead and use that as input for
the `SplineOmics` package.

``` r
log2_transformed_data <- log2(data_matrix)  # use as SplineOmics input
```

### R Version

Depending on the version of `SplineOmics`, for the most recent, 4.5.0 or
higher.

## â“ Getting Help

If you encounter a bug or have a suggestion for improving the
`SplineOmics` package, we encourage you to [open an
issue](https://github.com/csbg/SplineOmics/issues) on our GitHub
repository. Before opening a new issue, please check to see if your
question or bug has already been reported by another user. This helps
avoid duplicate reports and ensures that we can address problems
efficiently.

For more detailed questions, discussions, or contributions regarding the
packageâ€™s use and development, please refer to the [GitHub
Discussions](https://github.com/csbg/SplineOmics/discussions) page for
`SplineOmics`.

## ðŸ’¬ Feedback

We appreciate your feedback! Besides raising issues, you can provide
feedback in the following ways:

- **Direct Email**: Send your feedback directly to [Thomas
  Rauter](mailto:thomas.rauter@plus.ac.at).

- **Anonymous Feedback**: Use [this Google
  Form](https://forms.gle/jocMXSxLf3GrGBdT9) to provide anonymous
  feedback by answering questions.

Your feedback helps us improve the project and address any issues you
may encounter.

## ðŸ“œ License

This package is licensed under the MIT License:
[LICENSE](https://csbg.github.io/SplineOmics/LICENSE)

Â© 2024 Thomas Rauter. All rights reserved.

## ðŸŽ“ Citation

The `SplineOmics` package is currently not published in a peer-reviewed
scientific journal or similar outlet. However, if this package helped
you in your work, consider citing this GitHub repository.

To cite this package, you can use the citation information provided in
the [`CITATION.cff`](https://csbg.github.io/SplineOmics/CITATION.cff)
file.

You can also generate a citation in various formats using the
`CITATION.cff` file by visiting the top right of this repo and clicking
on the â€œCite this repositoryâ€ button.

Also, if you like the package, consider giving the GitHub repository a
star. Your support helps us in the continued development and improvement
of `SplineOmics`. Thank you for using our package!

## ðŸŒŸ Contributors

- [Thomas-Rauter](https://github.com/Thomas-Rauter) - ðŸš€ Wrote the
  package, developed the approach together with Veronika SchÃ¤pertÃ¶ns
  under guidance from Nikolaus Fortelny and Wolfgang Esser-Skala.
- [Nikolaus Fortelny](https://github.com/nfortelny) - ðŸ§  Principal
  Investigator, provided guidance and support for the overall approach.
- [Wolfgang Esser-Skala](https://github.com/skafdasschaf) - Helped
  reviewing code, delivered improvement suggestions and scientific
  guidance to develop the approach.
- [Veronika SchÃ¤pertÃ¶ns](https://github.com/VSchaepertoens) - Developed
  one internal plotting function, as well as some code for the
  exploratory data analysis plots, and the overall approach together
  with Thomas Rauter.
- [Dominik Hofreither](https://github.com/dh2305) - was (i) actively
  involved as a tester, (ii) provided datasets that helped define the
  problem addressed by the package, (iii) contributed numerous ideas
  that shaped its development, and (iv) as an end-user, provided
  feedback that improved its functionality.
- [Larissa Hofer](https://github.com/larissahofer) - contributed through
  feedback and beta-testing, and by providing the epigenetics and RNA
  datasets used as examples in the package documentation. These datasets
  were also used to define the problem addressed by the package.

## ðŸ™ Acknowledgements

This work was carried out in the context of the DigiTherapeutX project,
which was funded by the Austrian Science Fund (FWF). The research was
conducted under the supervision of Prof.Â Nikolaus Fortelny, who leads
the Computational Systems Biology working group at the Paris Lodron
University of Salzburg, Austria. You can find more information about
Prof.Â Fortelnyâ€™s research group
[here](https://www.plus.ac.at/biowissenschaften/der-fachbereich/arbeitsgruppen/fortelny/).

## â­ Liking this project

If you find this package useful for your research or analysis, please
consider giving the repository a **star** on GitHub. Starring helps
increase the visibility of the project and supports its continued
development.

To star the repository, you need to be logged in to your GitHub account
and click the **â€œStarâ€** button in the top-right corner of this page.

Thank you for your support!

# Package index

## User Available Functions

This section contains the documentation for all functions available to
the user in the SplineOmics package.

- [`compare_results()`](https://csbg.github.io/SplineOmics/reference/compare_results.md)
  : Compare hits between two SplineOmics results
- [`cluster_genes_multiomics()`](https://csbg.github.io/SplineOmics/reference/cluster_genes_multiomics.md)
  : Gene-centric multi-omics clustering across data modalities
- [`cluster_hits()`](https://csbg.github.io/SplineOmics/reference/cluster_hits.md)
  : Cluster the significant features based on spline similarity
- [`create_clustering_report()`](https://csbg.github.io/SplineOmics/reference/create_clustering_report.md)
  : Generate an HTML clustering report from precomputed results
- [`create_limma_report()`](https://csbg.github.io/SplineOmics/reference/create_limma_report.md)
  : Generate HTML report with p-value histograms of all the features
- [`create_ora_report()`](https://csbg.github.io/SplineOmics/reference/create_ora_report.md)
  : Generate an HTML report for over-representation analysis results
- [`create_pvc_report()`](https://csbg.github.io/SplineOmics/reference/create_pvc_report.md)
  : Create PVC HTML report from statistical PVC results
- [`create_splineomics()`](https://csbg.github.io/SplineOmics/reference/create_splineomics.md)
  : Create an object containing variables often used by SplineOmics
  functions
- [`extract_gene_sets()`](https://csbg.github.io/SplineOmics/reference/extract_gene_sets.md)
  : Extract gene set annotations from Bioconductor organism databases
- [`download_enrichr_databases()`](https://csbg.github.io/SplineOmics/reference/download_enrichr_databases.md)
  : Download Enrichr databases
- [`explore_data()`](https://csbg.github.io/SplineOmics/reference/explore_data.md)
  : Automatically perform exploratory data analysis (EDA)
- [`extract_data()`](https://csbg.github.io/SplineOmics/reference/extract_data.md)
  : Extract a rectangular block from a dataframe and make it to a matrix
- [`find_pvc()`](https://csbg.github.io/SplineOmics/reference/find_pvc.md)
  : Find peaks and valleys in time-series omics data
- [`plot_umap_clusters()`](https://csbg.github.io/SplineOmics/reference/plot_umap_clusters.md)
  : Plot a UMAP embedding colored by gene cluster assignment
- [`preprocess_rna_seq_data()`](https://csbg.github.io/SplineOmics/reference/preprocess_rna_seq_data.md)
  : Perform essential preprocessing steps for raw RNA-seq counts
- [`print(`*`<SplineOmics>`*`)`](https://csbg.github.io/SplineOmics/reference/print.SplineOmics.md)
  : Print function for SplineOmics objects
- [`run_ora()`](https://csbg.github.io/SplineOmics/reference/run_ora.md)
  : Perform over-representation analysis with the results from
  cluster_hits()
- [`run_limma_splines()`](https://csbg.github.io/SplineOmics/reference/run_limma_splines.md)
  : Perform a limma spline analysis to identify significant features
- [`update_splineomics()`](https://csbg.github.io/SplineOmics/reference/update_splineomics.md)
  : Update the variables in a SplineOmics object

# Articles

### Further use cases

- [Get
  started](https://csbg.github.io/SplineOmics/articles/get_started.md):
- [RNA-seq-analysis](https://csbg.github.io/SplineOmics/articles/RNA-seq-analysis.md):
- [Glycan-analysis](https://csbg.github.io/SplineOmics/articles/glycan-analysis.md):
- [PVC_analysis](https://csbg.github.io/SplineOmics/articles/PVC_analysis.md):
- [Gene-centric multiomics
  clustering](https://csbg.github.io/SplineOmics/articles/Gene_centric_multiomics_clustering.md):

### Guides

- [Designing a Limma Design
  Formula](https://csbg.github.io/SplineOmics/articles/design_limma_design_formula.md):
- [limma_result_categories](https://csbg.github.io/SplineOmics/articles/limma_result_categories.md):
- [Docker-instructions](https://csbg.github.io/SplineOmics/articles/Docker-instructions.md):
- [Docker_permission_denied](https://csbg.github.io/SplineOmics/articles/Docker_permission_denied.md):

### Special pages

- [FAQ](https://csbg.github.io/SplineOmics/articles/faq.md):
- [Changelog](https://csbg.github.io/SplineOmics/articles/CHANGELOG.md):
