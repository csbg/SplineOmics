<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Gene-centric multi-omics clustering across data modalities — cluster_genes_multiomics • SplineOmics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Gene-centric multi-omics clustering across data modalities — cluster_genes_multiomics"><meta name="description" content="Performs gene-centric clustering of multi-omics feature representations that
are supplied as modality-specific matrices. The function harmonizes genes
across modalities, constructs a gene-centric joint feature matrix, computes a
UMAP neighborhood graph using uwot, and performs spectral clustering on
the resulting UMAP fuzzy graph (fgraph).
The input matrices are assumed to be precomputed gene-level trajectories
(e.g., spline values or coefficients) or many-to-one feature-level matrices
(e.g., phospho sites) that are summarized into gene-level pattern signature
vectors inside this function.
This function performs statistical computation and returns the UMAP fit for
downstream visualization. Clustering is performed on the UMAP graph rather
than on the two-dimensional embedding coordinates."><meta property="og:description" content="Performs gene-centric clustering of multi-omics feature representations that
are supplied as modality-specific matrices. The function harmonizes genes
across modalities, constructs a gene-centric joint feature matrix, computes a
UMAP neighborhood graph using uwot, and performs spectral clustering on
the resulting UMAP fuzzy graph (fgraph).
The input matrices are assumed to be precomputed gene-level trajectories
(e.g., spline values or coefficients) or many-to-one feature-level matrices
(e.g., phospho sites) that are summarized into gene-level pattern signature
vectors inside this function.
This function performs statistical computation and returns the UMAP fit for
downstream visualization. Clustering is performed on the UMAP graph rather
than on the two-dimensional embedding coordinates."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SplineOmics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/get_started.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Further use cases</h6></li>
    <li><a class="dropdown-item" href="../articles/RNA-seq-analysis.html">RNA-seq analysis</a></li>
    <li><a class="dropdown-item" href="../articles/glycan-analysis.html">Glycan analysis</a></li>
    <li><a class="dropdown-item" href="../articles/PVC_analysis.html">Peak-Valley-Cliff (PVC) analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Gene_centric_multiomics_clustering.html">Gene-centric multiomics clustering</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/limma_result_categories.html">limma result categories</a></li>
    <li><a class="dropdown-item" href="../articles/design_limma_design_formula.html">Designing a limma design formula</a></li>
    <li><a class="dropdown-item" href="../articles/Docker-instructions.html">Docker container instructions</a></li>
    <li><a class="dropdown-item" href="../articles/Docker_permission_denied.html">Docker permission denied</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/faq.html">FAQ</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/CHANGELOG.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/csbg/SplineOmics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Gene-centric multi-omics clustering across data modalities</h1>
      <small class="dont-index">Source: <a href="https://github.com/csbg/SplineOmics/blob/HEAD/R/cluster_genes_multiomics.R" class="external-link"><code>R/cluster_genes_multiomics.R</code></a></small>
      <div class="d-none name"><code>cluster_genes_multiomics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs gene-centric clustering of multi-omics feature representations that
are supplied as modality-specific matrices. The function harmonizes genes
across modalities, constructs a gene-centric joint feature matrix, computes a
UMAP neighborhood graph using <span class="pkg">uwot</span>, and performs spectral clustering on
the resulting UMAP fuzzy graph (<code>fgraph</code>).</p>
<p>The input matrices are assumed to be precomputed gene-level trajectories
(e.g., spline values or coefficients) or many-to-one feature-level matrices
(e.g., phospho sites) that are summarized into gene-level pattern signature
vectors inside this function.</p>
<p>This function performs statistical computation and returns the UMAP fit for
downstream visualization. Clustering is performed on the UMAP graph rather
than on the two-dimensional embedding coordinates.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cluster_genes_multiomics</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">meta</span>,</span>
<span>  <span class="va">k</span>,</span>
<span>  gene_mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"intersection"</span>, <span class="st">"union"</span><span class="op">)</span>,</span>
<span>  n_neighbors <span class="op">=</span> <span class="fl">15L</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Named list defining the multi-condition, multi-modality input data.
The outer list corresponds to experimental conditions (e.g. control,
treatment, time points). Each element of the outer list must itself be a
named list of numeric matrices, one per data modality.</p>
<p>For each condition, the inner list entries represent modalities and must
share the same modality names across conditions. Each modality matrix must
have row names and can be of two types:</p>
<dl><dt>One-to-one (gene-level) modality</dt>
<dd><p>Rows represent genes directly.
Row names must be gene identifiers. Columns represent the
modality-specific representation used for clustering, such as spline
values at fixed time points, spline coefficients, or other numeric
features.</p></dd>


<dt>Many-to-one (feature-level) modality</dt>
<dd><p>Rows represent features that
map to genes (e.g., phospho sites, probes). Row names must follow the
pattern <code>&lt;gene_id&gt;_&lt;feature_id&gt;</code> where the gene identifier precedes
the first underscore. Such modalities are aggregated into gene-level
pattern signature vectors using an internal feature clustering step prior
to integration.</p></dd>


</dl><p>Modality matrices may differ in their number of columns both within and
across conditions. After aggregation (if applicable) and normalization,
all condition- and modality-specific gene-level matrices are aligned
according to <code>gene_mode</code> and concatenated to form the gene-centric
feature matrix used to construct the UMAP graph and clustering.</p></dd>


<dt id="arg-meta">meta<a class="anchor" aria-label="anchor" href="#arg-meta"></a></dt>
<dd><p>Data frame describing modalities and required parameters for aggregation and
weighting. Must be compatible with internal representation building helpers.
At minimum, it must identify modalities and indicate whether a modality is
one-to-one (gene-level) or many-to-one (feature-level) and provide the
parameters required for many-to-one aggregation.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Integer. Number of gene clusters for spectral clustering.</p></dd>


<dt id="arg-gene-mode">gene_mode<a class="anchor" aria-label="anchor" href="#arg-gene-mode"></a></dt>
<dd><p>Character string specifying how to harmonize genes across modalities prior
to constructing the joint feature matrix:</p><dl><dt><code>"intersection"</code></dt>
<dd><p>Retain only genes present in all modalities.</p></dd>

<dt><code>"union"</code></dt>
<dd><p>Retain genes present in any modality. Gene vectors
are constructed using available modalities; missing modality blocks are
handled internally.</p></dd>


</dl></dd>


<dt id="arg-n-neighbors">n_neighbors<a class="anchor" aria-label="anchor" href="#arg-n-neighbors"></a></dt>
<dd><p>Integer. Size of the local neighborhood used by UMAP to construct the
k-nearest-neighbor graph. Larger values emphasize broader structure, smaller
values emphasize local structure.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical scalar indicating whether progress messages should be emitted via
<code><a href="https://rlang.r-lib.org/reference/abort.html" class="external-link">rlang::inform()</a></code> by internal helpers.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A named list with the following elements:</p><dl><dt><code>cluster_table</code></dt>
<dd><p>A tibble with one row per gene and columns
<code>gene</code> and <code>cluster</code>.</p></dd>


<dt><code>centroid_info</code></dt>
<dd><p>A tibble summarizing modality-specific cluster
centroids and within-cluster QC. The centroid representation is stored as a
list-column.</p></dd>


<dt><code>many_to_one_clustering_qc</code></dt>
<dd><p>A tibble (or <code>NULL</code>) with QC
diagnostics for many-to-one feature clustering steps, if any are present.</p></dd>


<dt><code>umap_fit</code></dt>
<dd><p>The object returned by <code><a href="https://jlmelville.github.io/uwot/reference/umap.html" class="external-link">uwot::umap()</a></code>,
including <code>$embedding</code> (genes \(\times\) <code>n_components</code>) and,
if requested via <code>ret_extra</code>, <code>$fgraph</code> (the UMAP fuzzy graph
used for spectral clustering).</p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gene"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rna</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">genes</span><span class="op">)</span> <span class="op">*</span> <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">genes</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">genes</span>, <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">prot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">genes</span><span class="op">)</span> <span class="op">*</span> <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">genes</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">genes</span>, <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  condition1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rna <span class="op">=</span> <span class="va">rna</span>, protein <span class="op">=</span> <span class="va">prot</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  modality <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rna"</span>, <span class="st">"protein"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  many_to_one_k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA_real_</span>, <span class="cn">NA_real_</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  modality_w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">cluster_genes_multiomics</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>  meta <span class="op">=</span> <span class="va">meta</span>,</span></span>
<span class="r-in"><span>  k <span class="op">=</span> <span class="fl">3L</span>,</span></span>
<span class="r-in"><span>  gene_mode <span class="op">=</span> <span class="st">"intersection"</span>,</span></span>
<span class="r-in"><span>  n_neighbors <span class="op">=</span> <span class="fl">5L</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">cluster_table</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 8 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   gene  cluster</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> gene1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> gene2       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> gene3       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> gene4       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> gene5       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> gene6       3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> gene7       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">8</span> gene8       1</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Rauter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

