<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>run_ora() — run_ora • SplineOmics</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="run_ora() — run_ora"><meta name="description" content="This function generates a overrepresentation analysis report based
on clustered hit levels, gene data, and specified databases. It accomplishes
this by using the R package clusterProfiler. As output, you will receive a
list of the plot objects it generated, and an HTML report with embedded files
containing the enrichment results, and dotplots visualizing the enrichment."><meta property="og:description" content="This function generates a overrepresentation analysis report based
on clustered hit levels, gene data, and specified databases. It accomplishes
this by using the R package clusterProfiler. As output, you will receive a
list of the plot objects it generated, and an HTML report with embedded files
containing the enrichment results, and dotplots visualizing the enrichment."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SplineOmics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/CHANGELOG.html">Changelog</a></li>
    <li><a class="dropdown-item" href="../articles/design_limma_design_formula.html">Designing a Limma Design Formula</a></li>
    <li><a class="dropdown-item" href="../articles/Docker_permission_denied.html">Docker_permission_denied</a></li>
    <li><a class="dropdown-item" href="../articles/Docker-instructions.html">Docker-instructions</a></li>
    <li><a class="dropdown-item" href="../articles/get-started.html">get-started</a></li>
    <li><a class="dropdown-item" href="../articles/glycan-analysis.html">Glycan-analysis</a></li>
    <li><a class="dropdown-item" href="../articles/limma_result_categories.html">limma_result_categories</a></li>
    <li><a class="dropdown-item" href="../articles/methylation_data_analysis.html">methylation-data-analysis</a></li>
    <li><a class="dropdown-item" href="../articles/PVC_analysis.html">PVC_analysis</a></li>
    <li><a class="dropdown-item" href="../articles/RNA-seq-analysis.html">RNA-seq-analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/CHANGELOG.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/csbg/SplineOmics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>run_ora()</h1>
      <small class="dont-index">Source: <a href="https://github.com/csbg/SplineOmics/blob/HEAD/R/run_ora.R" class="external-link"><code>R/run_ora.R</code></a></small>
      <div class="d-none name"><code>run_ora.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates a overrepresentation analysis report based
on clustered hit levels, gene data, and specified databases. It accomplishes
this by using the R package clusterProfiler. As output, you will receive a
list of the plot objects it generated, and an HTML report with embedded files
containing the enrichment results, and dotplots visualizing the enrichment.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_ora</span><span class="op">(</span></span>
<span>  <span class="va">cluster_table</span>,</span>
<span>  <span class="va">databases</span>,</span>
<span>  <span class="va">report_info</span>,</span>
<span>  <span class="va">cluster_hits_report_name</span>,</span>
<span>  clusterProfiler_params <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  mapping_cfg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"none"</span>, from_species <span class="op">=</span> <span class="cn">NULL</span>, to_species <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  enrichGO_cfg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  universe <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  report_dir <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-cluster-table">cluster_table<a class="anchor" aria-label="anchor" href="#arg-cluster-table"></a></dt>
<dd><p>A tibble containing one row per
<code>feature_nr</code> with metadata and cluster assignments across the
analysis categories. It includes:</p><ul><li><p><code>feature_nr</code> – Numeric feature identifier.</p></li>
<li><p><code>feature_name</code> – Preferred feature name from the source
    data, falling back to the numeric ID if none is available.</p></li>
<li><p><code>gene</code> – Preferred gene symbol from the annotation or
    cluster data.</p></li>
<li><p><code>cluster_&lt;cond1&gt;</code> / <code>cluster_&lt;cond2&gt;</code> – Cluster
    assignments for each time-effect condition.</p></li>
<li><p><code>cluster_cat2</code> – (Optional) Combined cluster label for
    category 2 hits in the form
    <code>"&lt;cluster_&lt;cond1&gt;&gt;_&lt;cluster_&lt;cond2&gt;&gt;"</code>; <code>NA</code> if the
    feature was not a category 2 hit.</p></li>
<li><p><code>cluster_cat3</code> – (Optional) Combined cluster label for
    category 3 hits in the form
    <code>"&lt;cluster_&lt;cond1&gt;&gt;_&lt;cluster_&lt;cond2&gt;&gt;"</code>; <code>NA</code> if the
    feature was not a category 3 hit.</p></li>
</ul><p>For any category-specific cluster column, a value of <code>NA</code>
indicates that the feature was not significant (not a hit) in that
category.</p></dd>


<dt id="arg-databases">databases<a class="anchor" aria-label="anchor" href="#arg-databases"></a></dt>
<dd><p>A `data.frame` that defines the gene set collections to be
  tested in the overrepresentation analysis. Must contain exactly three
  columns:</p><dl><dt>DB</dt>
<dd><p>Character. The database identifier (e.g., `"KEGG"`, `"GO_BP"`,
      `"Reactome"`).</p></dd>

    <dt>Geneset</dt>
<dd><p>Character. The name of the gene set or pathway within the
      database.</p></dd>

    <dt>Gene</dt>
<dd><p>Character. A gene identifier belonging to the gene set
      (e.g., gene symbol, Ensembl ID).</p></dd>


</dl><p>Each row corresponds to one `(database, geneset, gene)` association. The
  same gene may appear in multiple gene sets.</p></dd>


<dt id="arg-report-info">report_info<a class="anchor" aria-label="anchor" href="#arg-report-info"></a></dt>
<dd><p>A list containing information for the report generation,
such as omics_data_type and data_description (this is the list used for all
report generating functions of this package).</p></dd>


<dt id="arg-cluster-hits-report-name">cluster_hits_report_name<a class="anchor" aria-label="anchor" href="#arg-cluster-hits-report-name"></a></dt>
<dd><p>Single character string specifying the name
of the cluster_hits() function report, that contains the results that were
used for the overprepresentation analysis here. Must be specified, because
otherwise, the connection is not documented.</p></dd>


<dt id="arg-clusterprofiler-params">clusterProfiler_params<a class="anchor" aria-label="anchor" href="#arg-clusterprofiler-params"></a></dt>
<dd><p>A named list of arguments passed directly to
the corresponding functions in the <strong>clusterProfiler</strong> package.
Typical entries include <code>pvalueCutoff</code>, <code>pAdjustMethod</code>,
<code>minGSSize</code>, <code>maxGSSize</code>, and <code>qvalueCutoff</code>. The names
must match the argument names in clusterProfiler; see the clusterProfiler
documentation for details. If <code>NULL</code> (default), the standard
clusterProfiler defaults are used.</p></dd>


<dt id="arg-mapping-cfg">mapping_cfg<a class="anchor" aria-label="anchor" href="#arg-mapping-cfg"></a></dt>
<dd><p>A named list that controls the optional behavior of
automatically mapping gene symbols across species. This is useful
when your input gene symbols (e.g., from CHO cells) do not match
the species used by the enrichment databases (e.g., human or mouse).
By default, no mapping is performed and gene symbols are used as-is.
If mapping is desired, this list must contain the following three
elements:</p><dl><dt>method</dt>
<dd><p>Mapping method to use. One of <code>none</code> (default;
  no mapping), <code>gprofiler</code> (online, via the g:Profiler API), or
  <code>orthogene</code> (offline, if installed).</p></dd>

  <dt>from_species</dt>
<dd><p>Source species code,
  e.g. <code>cgriseus</code> for CHO. Must match the expected format for
  the selected tool.</p></dd>

  <dt>to_species</dt>
<dd><p>Target species code,
  e.g. <code>hsapiens</code> for human. This must be the species used in
  your ORA database and must also match the expected format for the
  selected tool.</p></dd>


</dl></dd>


<dt id="arg-enrichgo-cfg">enrichGO_cfg<a class="anchor" aria-label="anchor" href="#arg-enrichgo-cfg"></a></dt>
<dd><p>A named list specifying the configuration for
running GO enrichment with Bioconductor's
<code><a href="https://rdrr.io/pkg/clusterProfiler/man/enrichGO.html" class="external-link">enrichGO</a></code>.
This is only needed when you want to perform GO Biological Process (BP),
Molecular Function (MF), or Cellular Component (CC) enrichment using
Bioconductor's organism databases (e.g., <code>org.Mm.eg.db</code> for mouse).</p>
<p>The list must be named according to the GO ontology, e.g., <code>"GO_BP"</code>,
<code>"GO_MF"</code>, <code>"GO_CC"</code>. Each entry must provide:</p><ul><li><p><code>OrgDb</code>: The organism database, e.g., <code>org.Mm.eg.db</code>.</p></li>
<li><p><code>keyType</code>: The gene identifier type, e.g., <code>"SYMBOL"</code>.</p></li>
<li><p><code>ontology</code>: One of <code>"BP"</code>, <code>"MF"</code>, or <code>"CC"</code>.</p></li>
</ul><p>If <code>enrichGO_cfg</code> is <code>NULL</code> (default), no Bioconductor-based GO
enrichment is performed. All enrichment runs through
<code><a href="https://rdrr.io/pkg/clusterProfiler/man/enricher.html" class="external-link">enricher</a></code> with the provided TERM2GENE mappings.</p></dd>


<dt id="arg-universe">universe<a class="anchor" aria-label="anchor" href="#arg-universe"></a></dt>
<dd><p>Enrichment background data. This is a
parameter of clusterProfiler, for the documentation, please check the
documentation of the clusterProfiler R package.</p></dd>


<dt id="arg-report-dir">report_dir<a class="anchor" aria-label="anchor" href="#arg-report-dir"></a></dt>
<dd><p>Directory where the report will be saved.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A nested, named list whose top-level elements correspond to the
limma result categories. The exact set of elements depends on <code>mode</code>:</p>
<dl><dt><code>mode == "isolated"</code></dt>
<dd><p>Two elements are returned, one per condition level:
    <code>time_effect_condition_&lt;level1&gt;</code> and
    <code>time_effect_condition_&lt;level2&gt;</code>.</p></dd>

  <dt><code>mode == "integrated"</code></dt>
<dd><p>The two time–effect elements above, plus (only if there are significant
    hits at the chosen thresholds) up to two additional elements:
    <code>avrg_diff_conditions</code> and <code>interaction_condition_time</code>.</p></dd>


</dl><p>Each top‑level result category element is a list with the fields:</p><dl><dt><code>dotplot</code></dt>
<dd><p>A <code>ggplot</code> object: the dot plot of
    over-representation results (clusterProfiler) for that category.</p></dd>

  <dt><code>dotplot_nrows</code></dt>
<dd><p>Numeric scalar giving a suggested plot height
    (in rows / relative units) that prints nicely for the number of
    enriched terms shown.</p></dd>

  <dt><code>ora_results</code></dt>
<dd><p>A nested list of the raw enrichment results,
    structured as:</p><dl><dt><em>cluster</em> \(\rightarrow\) <em>database</em></dt>
<dd><p>For each cluster in the category, there is a sublist with one entry
        per database used in the enrichment. The value of each entry is
        either
        <code>NA</code> (no terms enriched for that cluster–database) or a
        <code>data.frame</code> as returned by
        <code><a href="https://rdrr.io/pkg/clusterProfiler/man/enricher.html" class="external-link">clusterProfiler::enricher()</a></code> for the enriched terms.</p></dd>


</dl></dd>


</dl><p>In summary, the full shape is:</p><div class="sourceCode"><pre><code>
list(
  time_effect_condition_&lt;level1&gt; = list(
    dotplot        = ggplot,
    dotplot_nrows  = numeric(1),
    ora_results    = list(
      &lt;cluster_1&gt; = list(&lt;database_1&gt; = NA|data.frame, ...),
      &lt;cluster_2&gt; = list(&lt;database_1&gt; = NA|data.frame, ...),
      ...
    )
  ),
  time_effect_condition_&lt;level2&gt; = list(...),
  avrg_diff_conditions          = list(...), # only if hits (integrated mode)
  interaction_condition_time    = list(...)  # only if hits (integrated mode)
)
</code></pre></div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/clusterProfiler/man/enricher.html" class="external-link">clusterProfiler::enricher()</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Rauter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

