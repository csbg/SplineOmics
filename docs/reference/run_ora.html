<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Perform over-representation analysis with the results from cluster_hits() — run_ora • SplineOmics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform over-representation analysis with the results from cluster_hits() — run_ora"><meta name="description" content="This function generates a overrepresentation analysis report based
on clustered hit levels, gene data, and specified databases. It accomplishes
this by using the R package clusterProfiler. As output, you will receive a
list of the plot objects it generated, and an HTML report with embedded
files containing the enrichment results, and dotplots visualizing the
enrichment."><meta property="og:description" content="This function generates a overrepresentation analysis report based
on clustered hit levels, gene data, and specified databases. It accomplishes
this by using the R package clusterProfiler. As output, you will receive a
list of the plot objects it generated, and an HTML report with embedded
files containing the enrichment results, and dotplots visualizing the
enrichment."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SplineOmics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/get_started.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Further use cases</h6></li>
    <li><a class="dropdown-item" href="../articles/RNA-seq-analysis.html">RNA-seq analysis</a></li>
    <li><a class="dropdown-item" href="../articles/glycan-analysis.html">Glycan analysis</a></li>
    <li><a class="dropdown-item" href="../articles/methylation_data_analysis.html">Epigenetics analysis</a></li>
    <li><a class="dropdown-item" href="../articles/PVC_analysis.html">Peak-Valley-Cliff (PVC) analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/limma_result_categories.html">limma result categories</a></li>
    <li><a class="dropdown-item" href="../articles/design_limma_design_formula.html">Designing a limma design formula</a></li>
    <li><a class="dropdown-item" href="../articles/Docker-instructions.html">Docker container instructions</a></li>
    <li><a class="dropdown-item" href="../articles/Docker_permission_denied.html">Docker permission denied</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/faq.html">FAQ</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/CHANGELOG.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/csbg/SplineOmics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Perform over-representation analysis with the results from cluster_hits()</h1>
      <small class="dont-index">Source: <a href="https://github.com/csbg/SplineOmics/blob/HEAD/R/run_ora.R" class="external-link"><code>R/run_ora.R</code></a></small>
      <div class="d-none name"><code>run_ora.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates a overrepresentation analysis report based
on clustered hit levels, gene data, and specified databases. It accomplishes
this by using the R package clusterProfiler. As output, you will receive a
list of the plot objects it generated, and an HTML report with embedded
files containing the enrichment results, and dotplots visualizing the
enrichment.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_ora</span><span class="op">(</span></span>
<span>  <span class="va">cluster_table</span>,</span>
<span>  <span class="va">databases</span>,</span>
<span>  <span class="va">report_info</span>,</span>
<span>  <span class="va">cluster_hits_report_name</span>,</span>
<span>  clusterProfiler_params <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  mapping_cfg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"none"</span>, from_species <span class="op">=</span> <span class="cn">NULL</span>, to_species <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  enrichGO_cfg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  universe <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  report_dir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-cluster-table">cluster_table<a class="anchor" aria-label="anchor" href="#arg-cluster-table"></a></dt>
<dd><p><code>tibble</code>: A tibble containing one row per
<code>feature_nr</code> with metadata and cluster assignments across analysis
categories. It includes:</p>
<ul><li><p><code>feature_nr</code>: <code>numeric(1)</code> Numeric feature identifier.</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>\item \code{feature_name}<span class="sc">:</span> <span class="st">`</span><span class="at">character(1)</span><span class="st">`</span> Preferred feature name</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  derived from limma tables or falling back to the numeric ID.</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>\item \code{gene}<span class="sc">:</span> <span class="st">`</span><span class="at">character(1)</span><span class="st">`</span> Preferred gene symbol obtained</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  from the annotation or from cluster<span class="sc">-</span>level metadata.</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>\item \code{cluster_<span class="sc">&lt;</span>condition<span class="sc">&gt;</span>}<span class="sc">:</span> <span class="st">`</span><span class="at">integer(1)</span><span class="st">`</span> Cluster assignment</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  <span class="cf">for</span> each time<span class="sc">-</span>effect <span class="fu">condition</span> (Category <span class="dv">1</span>). One column per</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  condition.</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>\item \code{cluster_cat2_<span class="sc">&lt;</span>cond1<span class="sc">&gt;</span>_vs_<span class="sc">&lt;</span>cond2<span class="sc">&gt;</span>}<span class="sc">:</span> <span class="st">`</span><span class="at">character(1)</span><span class="st">`</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  Category <span class="dv">2</span> label <span class="cf">for</span> each contrast. Indicates which condition</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>  shows higher <span class="fu">expression</span> (e.g. <span class="st">`</span><span class="at">"Ctrl_higher"</span><span class="st">`</span>), or \code{<span class="cn">NA</span>} <span class="cf">if</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>  the feature is not a category <span class="dv">2</span> hit.</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>\item \code{cluster_cat3_<span class="sc">&lt;</span>cond1<span class="sc">&gt;</span>_vs_<span class="sc">&lt;</span>cond2<span class="sc">&gt;</span>}<span class="sc">:</span> <span class="st">`</span><span class="at">character(1)</span><span class="st">`</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>  Category <span class="dv">3</span> label <span class="cf">for</span> each contrast. Encodes the pair of</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>  time<span class="sc">-</span>effect clusters <span class="cf">in</span> the form \code{<span class="st">"&lt;c1&gt;_&lt;c2&gt;"</span>} (e.g.</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>  <span class="st">`</span><span class="at">"2_4"</span><span class="st">`</span>). \code{<span class="cn">NA</span>} indicates the feature is not a category <span class="dv">3</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>  hit.</span></code></pre><p></p></div></li>
</ul><p>For any category-specific column, a value of <code>NA</code> indicates that
the feature was not significant (i.e., not a hit) in that category.</p></dd>


<dt id="arg-databases">databases<a class="anchor" aria-label="anchor" href="#arg-databases"></a></dt>
<dd><p><code>data.frame</code>: A <code>data.frame</code> that defines the gene set
collections to be tested in the overrepresentation analysis. Must contain
exactly three columns:</p><dl><dt>DB <code>character(1)</code></dt>
<dd><p>The database identifier (e.g., KEGG, GO_BP,
Reactome).</p></dd>

<dt>Geneset <code>character(1)</code></dt>
<dd><p>The name of the gene set or pathway
within the database.</p></dd>

<dt>Gene <code>character(1)</code></dt>
<dd><p>A gene identifier belonging to the gene set
(e.g., gene symbol, Ensembl ID).</p></dd>


</dl><p>Each row corresponds to one <code>(database, geneset, gene)</code> association. The
same gene may appear in multiple gene sets.</p></dd>


<dt id="arg-report-info">report_info<a class="anchor" aria-label="anchor" href="#arg-report-info"></a></dt>
<dd><p><code>list</code>: A list containing information for the report
generation, such as omics_data_type and data_description (this is the list
used for all report generating functions of this package).</p></dd>


<dt id="arg-cluster-hits-report-name">cluster_hits_report_name<a class="anchor" aria-label="anchor" href="#arg-cluster-hits-report-name"></a></dt>
<dd><p><code>character(1)</code>: Single character string
specifying the name of the cluster_hits() function report, that contains
the results that were used for the overprepresentation analysis here. Must
be specified, because otherwise, the connection is not documented.</p></dd>


<dt id="arg-clusterprofiler-params">clusterProfiler_params<a class="anchor" aria-label="anchor" href="#arg-clusterprofiler-params"></a></dt>
<dd><p><code>list</code> | <code>NULL</code>: A named list of arguments
passed directly to the corresponding functions in the
<strong>clusterProfiler</strong> package. Typical entries include
<code>pvalueCutoff</code>, <code>pAdjustMethod</code>, <code>minGSSize</code>,
<code>maxGSSize</code>, and <code>qvalueCutoff</code>. The names must match the
argument names in clusterProfiler; see the clusterProfiler documentation
for details. If <code>NULL</code> (default), the standard clusterProfiler defaults
are used.</p></dd>


<dt id="arg-mapping-cfg">mapping_cfg<a class="anchor" aria-label="anchor" href="#arg-mapping-cfg"></a></dt>
<dd><p><code>list</code> | <code>NULL</code>: A named list that controls the optional
behavior of automatically mapping gene symbols across species. This is
useful when your input gene symbols (e.g., from CHO cells) do not match the
species used by the enrichment databases (e.g., human or mouse). By
default, no mapping is performed and gene symbols are used as-is. If
mapping is desired, this list must contain the following three elements:</p><dl><dt>method</dt>
<dd><p><code>character(1)</code>: Mapping method to use. One of <code>none</code>
(default; no mapping), <code>gprofiler</code> (online, via the g:Profiler API),
or <code>orthogene</code> (offline, if installed).</p></dd>

<dt>from_species</dt>
<dd><p><code>character(1)</code>: Source species code,
e.g. <code>cgriseus</code> for CHO. Must match the expected format for the
selected tool.</p></dd>

<dt>to_species</dt>
<dd><p><code>character(1)</code>: Target species code, e.g.
<code>hsapiens</code>
for human. This must be the species used in your ORA database and must
also match the expected format for the selected tool.</p></dd>


</dl></dd>


<dt id="arg-enrichgo-cfg">enrichGO_cfg<a class="anchor" aria-label="anchor" href="#arg-enrichgo-cfg"></a></dt>
<dd><p><code>list</code> | <code>NULL</code>: A named list specifying the
configuration for running GO enrichment with Bioconductor's
<code><a href="https://rdrr.io/pkg/clusterProfiler/man/enrichGO.html" class="external-link">enrichGO</a></code>. This is only needed when you want
to perform GO Biological Process (BP), Molecular Function (MF), or Cellular
Component (CC) enrichment using Bioconductor's organism databases (e.g.,
<code>org.Mm.eg.db</code> for mouse).</p>
<p>The list must be named according to the GO ontology, e.g., <code>"GO_BP"</code>,
<code>"GO_MF"</code>, <code>"GO_CC"</code>. Each entry must provide:</p><ul><li><p><code>OrgDb</code>: <code>character(1)</code> The organism database, e.g.,
<code>org.Mm.eg.db</code>.</p></li>
<li><p><code>keyType</code>: <code>character(1)</code> The gene identifier type, e.g.,
<code>"SYMBOL"</code>.</p></li>
<li><p><code>ontology</code>: <code>character(1)</code> One of <code>"BP"</code>, <code>"MF"</code>, or
<code>"CC"</code>.</p></li>
</ul><p>If <code>enrichGO_cfg</code> is <code>NULL</code> (default), no Bioconductor-based GO
enrichment is performed. All enrichment runs through
<code><a href="https://rdrr.io/pkg/clusterProfiler/man/enricher.html" class="external-link">enricher</a></code> with the provided TERM2GENE
mappings.</p></dd>


<dt id="arg-universe">universe<a class="anchor" aria-label="anchor" href="#arg-universe"></a></dt>
<dd><p><code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> | <code>NULL</code>: Enrichment background data. This is
a parameter of clusterProfiler; for details, please check the documentation
of the clusterProfiler R package.</p></dd>


<dt id="arg-report-dir">report_dir<a class="anchor" aria-label="anchor" href="#arg-report-dir"></a></dt>
<dd><p><code>character(1)</code>: Character string specifying the directory
path where the HTML report and any other output files should be saved. When
no path is specified, then the function runs but no HTML report is
generated.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><code>logical(1)</code>: Boolean flag controlling the display of
messages.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A nested, named list whose top-level elements correspond to the
limma result categories. The exact set of elements depends on <code>mode</code>:</p>
<dl><dt><code>mode == "isolated"</code></dt>
<dd><p>Two elements are returned, one per condition level:
<code>time_effect_condition_&lt;level1&gt;</code> and
<code>time_effect_condition_&lt;level2&gt;</code>.</p></dd>

<dt><code>mode == "integrated"</code></dt>
<dd><p>The two time-effect elements above, plus (only if there are significant
hits at the chosen thresholds) up to two additional elements:
<code>avrg_diff_conditions</code> and <code>interaction_condition_time</code>.
Note that the clusters of <code>interaction_condition_time</code> are
"combo-clusters" made of the cluster membership of the feature in
condition 1 and the membership of the same feature in condition 2 (see
also the respective documentation for the function cluster_hits() about
the cluster_table). For example, if the report generated by this function
has the entries 'time_effect_condition_control' and
'time_effect_condition_treatment', and the section
'interaction_condition_time' contains entries such as 'cluster_4_2', then
the first number (4) is the cluster of condition control, and the second
number (2) is the cluster of condition treatment.</p></dd>


</dl><p>Each top-level result category element is a list with the fields:</p><dl><dt><code>dotplot</code></dt>
<dd><p>A <code>ggplot</code> object: the dot plot of
over-representation results (clusterProfiler) for that category.</p></dd>

<dt><code>dotplot_nrows</code></dt>
<dd><p>Numeric scalar giving a suggested plot height
(in rows / relative units) that prints nicely for the number of
enriched terms shown.</p></dd>

<dt><code>ora_results</code></dt>
<dd><p>A nested list of the raw enrichment results,
structured as:</p><dl><dt><em>cluster</em> \(\rightarrow\) <em>database</em></dt>
<dd><p>For each cluster in the category, there is a sublist with one entry
per database used in the enrichment. The value of each entry is
either
<code>NA</code> (no terms enriched for that cluster-database) or a
<code>data.frame</code> as returned by
<code><a href="https://rdrr.io/pkg/clusterProfiler/man/enricher.html" class="external-link">clusterProfiler::enricher()</a></code> for the enriched terms.</p></dd>


</dl></dd>


</dl><p>In summary, the full shape is:</p><div class="sourceCode"><pre><code>
list(
  time_effect_condition_&lt;level1&gt; = list(
    dotplot        = ggplot,
    dotplot_nrows  = numeric(1),
    ora_results    = list(
      &lt;cluster_1&gt; = list(&lt;database_1&gt; = NA|data.frame, ...),
      &lt;cluster_2&gt; = list(&lt;database_1&gt; = NA|data.frame, ...),
      ...
    )
  ),
  time_effect_condition_&lt;level2&gt; = list(...),
  avrg_diff_conditions          = list(...),
  interaction_condition_time    = list(...)
)
</code></pre></div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/clusterProfiler/man/enricher.html" class="external-link">clusterProfiler::enricher()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># --- toy cluster table (two "conditions") ------------------------------</span></span></span>
<span class="r-in"><span>    <span class="va">toy_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"G"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">cluster_table</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        feature_nr    <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>,</span></span>
<span class="r-in"><span>        feature_name  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"feat_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        gene          <span class="op">=</span> <span class="va">toy_genes</span>,</span></span>
<span class="r-in"><span>        cluster_condA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        cluster_condB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># --- toy TERM2GENE database -------------------------------------------</span></span></span>
<span class="r-in"><span>    <span class="va">databases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        DB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"ToyDB"</span>, <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        Geneset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"SetA"</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"SetB"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        Gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G1"</span>, <span class="st">"G2"</span>, <span class="st">"G7"</span>, <span class="st">"G3"</span>, <span class="st">"G4"</span>, <span class="st">"G6"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># --- minimal report info ----------------------------------------------</span></span></span>
<span class="r-in"><span>    <span class="va">report_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        omics_data_type <span class="op">=</span> <span class="st">"TOY"</span>,</span></span>
<span class="r-in"><span>        data_description <span class="op">=</span> <span class="st">"Toy dataset for run_ora() example"</span>,</span></span>
<span class="r-in"><span>        data_collection_date <span class="op">=</span> <span class="st">"2025"</span>,</span></span>
<span class="r-in"><span>        analyst_name <span class="op">=</span> <span class="st">"Example Analyst"</span>,</span></span>
<span class="r-in"><span>        contact_info <span class="op">=</span> <span class="st">"analyst@example.org"</span>,</span></span>
<span class="r-in"><span>        project_name <span class="op">=</span> <span class="st">"ToyProject"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># --- output directory (temp) -------------------------------------------</span></span></span>
<span class="r-in"><span>    <span class="va">report_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"run_ora_demo"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">report_dir</span>, showWarnings <span class="op">=</span> <span class="cn">FALSE</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># --- permissive params for tiny example --------------------------------</span></span></span>
<span class="r-in"><span>    <span class="va">clusterProfiler_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        pvalueCutoff <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>        minGSSize    <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>        maxGSSize    <span class="op">=</span> <span class="fl">500</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># --- run ORA -----------------------------------------------------------</span></span></span>
<span class="r-in"><span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">run_ora</span><span class="op">(</span></span></span>
<span class="r-in"><span>        cluster_table            <span class="op">=</span> <span class="va">cluster_table</span>,</span></span>
<span class="r-in"><span>        databases                <span class="op">=</span> <span class="va">databases</span>,</span></span>
<span class="r-in"><span>        report_info              <span class="op">=</span> <span class="va">report_info</span>,</span></span>
<span class="r-in"><span>        cluster_hits_report_name <span class="op">=</span> <span class="st">"cluster_hits_demo"</span>,</span></span>
<span class="r-in"><span>        clusterProfiler_params   <span class="op">=</span> <span class="va">clusterProfiler_params</span>,</span></span>
<span class="r-in"><span>        report_dir               <span class="op">=</span> <span class="va">report_dir</span>,</span></span>
<span class="r-in"><span>        verbose                  <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># see sections and files written</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">report_dir</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Running clusterProfiler for: cluster_condA</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Cluster: cluster_1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Database: ToyDB</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Foreground genes:3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Foreground genes overlapping with database: 3 (100%)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Cluster: cluster_2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Database: ToyDB</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Foreground genes:3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Foreground genes overlapping with database: 2 (66.7%)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Running clusterProfiler for: cluster_condB</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Cluster: cluster_1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Database: ToyDB</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Foreground genes:3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Foreground genes overlapping with database: 2 (66.7%)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Cluster: cluster_2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Database: ToyDB</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Foreground genes:2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Foreground genes overlapping with database: 2 (100%)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  <span style="color: #00BB00;">Info</span> ORA analysis completed successfully.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Your HTML reports are located in the directory:  /tmp/RtmpD8INMF/run_ora_demo .</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Please note that due to embedded files, the reports might be flagged as</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  harmful by other software. Rest assured that they provide no harm.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "run_ora_report_TOY_18_11_2025-16_06_22.html"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Rauter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

