<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Perform over-representation analysis with the results from cluster_hits() — run_ora • SplineOmics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform over-representation analysis with the results from cluster_hits() — run_ora"><meta name="description" content="This function performs over-representation analysis (ORA) on clustered
feature sets using the R package clusterProfiler. For each grouping
column in the provided cluster table, enrichment is evaluated separately
for all clusters and specified databases.
The function computes and returns the raw enrichment results only. No plots
are generated and no files are written. Visualization and HTML report
generation are intentionally handled by a separate reporting function
(e.g., create_ora_report()), enabling a strict separation between
statistical analysis and reporting."><meta property="og:description" content="This function performs over-representation analysis (ORA) on clustered
feature sets using the R package clusterProfiler. For each grouping
column in the provided cluster table, enrichment is evaluated separately
for all clusters and specified databases.
The function computes and returns the raw enrichment results only. No plots
are generated and no files are written. Visualization and HTML report
generation are intentionally handled by a separate reporting function
(e.g., create_ora_report()), enabling a strict separation between
statistical analysis and reporting."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SplineOmics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/get_started.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Further use cases</h6></li>
    <li><a class="dropdown-item" href="../articles/RNA-seq-analysis.html">RNA-seq analysis</a></li>
    <li><a class="dropdown-item" href="../articles/glycan-analysis.html">Glycan analysis</a></li>
    <li><a class="dropdown-item" href="../articles/PVC_analysis.html">Peak-Valley-Cliff (PVC) analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Gene_centric_multiomics_clustering.html">Gene-centric multiomics clustering</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/limma_result_categories.html">limma result categories</a></li>
    <li><a class="dropdown-item" href="../articles/design_limma_design_formula.html">Designing a limma design formula</a></li>
    <li><a class="dropdown-item" href="../articles/Docker-instructions.html">Docker container instructions</a></li>
    <li><a class="dropdown-item" href="../articles/Docker_permission_denied.html">Docker permission denied</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/faq.html">FAQ</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/CHANGELOG.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/csbg/SplineOmics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Perform over-representation analysis with the results from cluster_hits()</h1>
      <small class="dont-index">Source: <a href="https://github.com/csbg/SplineOmics/blob/HEAD/R/run_ora.R" class="external-link"><code>R/run_ora.R</code></a></small>
      <div class="d-none name"><code>run_ora.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function performs over-representation analysis (ORA) on clustered
feature sets using the R package <strong>clusterProfiler</strong>. For each grouping
column in the provided cluster table, enrichment is evaluated separately
for all clusters and specified databases.</p>
<p>The function computes and returns the raw enrichment results only. No plots
are generated and no files are written. Visualization and HTML report
generation are intentionally handled by a separate reporting function
(e.g., <code><a href="create_ora_report.html">create_ora_report()</a></code>), enabling a strict separation between
statistical analysis and reporting.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_ora</span><span class="op">(</span></span>
<span>  <span class="va">cluster_table</span>,</span>
<span>  <span class="va">databases</span>,</span>
<span>  clusterProfiler_params <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  mapping_cfg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"none"</span>, from_species <span class="op">=</span> <span class="cn">NULL</span>, to_species <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  enrichGO_cfg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  universe <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-cluster-table">cluster_table<a class="anchor" aria-label="anchor" href="#arg-cluster-table"></a></dt>
<dd><p><code>tibble</code> A tibble with one row per feature and at
least one column named <code>gene</code>. The <code>gene</code> column must contain
gene identifiers as <code>character(1)</code> (empty strings and <code>NA</code> are
ignored).</p>
<p>All remaining columns (except <code>feature_nr</code> and <code>feature_name</code>)
are treated as <em>grouping columns</em>. Each grouping column defines a
set of categories (clusters) via its distinct non-<code>NA</code> values. For
a given grouping column, all rows that share the same value form one
cluster, and overrepresentation analysis is performed separately for each
cluster. The data type of grouping columns is not restricted (e.g.,
integer, character, factor); values are compared by equality after being
coerced to character.</p>
<p>A value of <code>NA</code> in a grouping column indicates that the feature does
not belong to any cluster for that grouping column and is excluded from
the corresponding analysis.</p>
<p>The columns <code>feature_nr</code> and <code>feature_name</code>, if present, are
ignored. These columns are typically added by upstream functions in the
SplineOmics pipeline.</p></dd>


<dt id="arg-databases">databases<a class="anchor" aria-label="anchor" href="#arg-databases"></a></dt>
<dd><p><code>data.frame</code>: A <code>data.frame</code> that defines the gene set
collections to be tested in the overrepresentation analysis. Must contain
exactly three columns:</p><ul><li><p><code>DB</code>: <code>character(1)</code> The database identifier
(e.g., KEGG, GO_BP, Reactome).</p></li>
<li><p><code>Geneset</code>: <code>character(1)</code> The name of the gene set or
pathway within the database.</p></li>
<li><p><code>Gene</code>: <code>character(1)</code> A gene identifier belonging to
the gene set (e.g., gene symbol, Ensembl ID).</p></li>
</ul><p>Each row corresponds to one <code>(database, geneset, gene)</code> association. The
same gene may appear in multiple gene sets.</p></dd>


<dt id="arg-clusterprofiler-params">clusterProfiler_params<a class="anchor" aria-label="anchor" href="#arg-clusterprofiler-params"></a></dt>
<dd><p><code>list</code> | <code>NULL</code>: A named list of arguments
passed directly to the corresponding functions in the
<strong>clusterProfiler</strong> package. Typical entries include
<code>pvalueCutoff</code>, <code>pAdjustMethod</code>, <code>minGSSize</code>,
<code>maxGSSize</code>, and <code>qvalueCutoff</code>. The names must match the
argument names in clusterProfiler; see the clusterProfiler documentation
for details. If <code>NULL</code> (default), the standard clusterProfiler defaults
are used.</p></dd>


<dt id="arg-mapping-cfg">mapping_cfg<a class="anchor" aria-label="anchor" href="#arg-mapping-cfg"></a></dt>
<dd><p><code>list</code> | <code>NULL</code>: A named list that controls the optional
behavior of automatically mapping gene symbols across species. This is
useful when your input gene symbols (e.g., from CHO cells) do not match the
species used by the enrichment databases (e.g., human or mouse). By
default, no mapping is performed and gene symbols are used as-is. If
mapping is desired, this list must contain the following three elements:</p><dl><dt>method</dt>
<dd><p><code>character(1)</code>: Mapping method to use. One of <code>none</code>
(default; no mapping), <code>gprofiler</code> (online, via the g:Profiler API),
or <code>orthogene</code> (offline, if installed).</p></dd>

<dt>from_species</dt>
<dd><p><code>character(1)</code>: Source species code,
e.g. <code>cgriseus</code> for CHO. Must match the expected format for the
selected tool.</p></dd>

<dt>to_species</dt>
<dd><p><code>character(1)</code>: Target species code, e.g.
<code>hsapiens</code>
for human. This must be the species used in your ORA database and must
also match the expected format for the selected tool.</p></dd>


</dl></dd>


<dt id="arg-enrichgo-cfg">enrichGO_cfg<a class="anchor" aria-label="anchor" href="#arg-enrichgo-cfg"></a></dt>
<dd><p><code>list</code> | <code>NULL</code>: A named list specifying the
configuration for running GO enrichment with Bioconductor's
<code><a href="https://rdrr.io/pkg/clusterProfiler/man/enrichGO.html" class="external-link">enrichGO</a></code>. This is only needed when you want
to perform GO Biological Process (BP), Molecular Function (MF), or Cellular
Component (CC) enrichment using Bioconductor's organism databases (e.g.,
<code>org.Mm.eg.db</code> for mouse).</p>
<p>The list must be named according to the GO ontology, e.g., <code>"GO_BP"</code>,
<code>"GO_MF"</code>, <code>"GO_CC"</code>. Each entry must provide:</p><ul><li><p><code>OrgDb</code>: <code>character(1)</code> The organism database, e.g.,
<code>org.Mm.eg.db</code>.</p></li>
<li><p><code>keyType</code>: <code>character(1)</code> The gene identifier type, e.g.,
<code>"SYMBOL"</code>.</p></li>
<li><p><code>ontology</code>: <code>character(1)</code> One of <code>"BP"</code>, <code>"MF"</code>, or
<code>"CC"</code>.</p></li>
</ul><p>If <code>enrichGO_cfg</code> is <code>NULL</code> (default), no Bioconductor-based GO
enrichment is performed. All enrichment runs through
<code><a href="https://rdrr.io/pkg/clusterProfiler/man/enricher.html" class="external-link">enricher</a></code> with the provided TERM2GENE
mappings.</p></dd>


<dt id="arg-universe">universe<a class="anchor" aria-label="anchor" href="#arg-universe"></a></dt>
<dd><p><code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> | <code>NULL</code>: Enrichment background data. This is
a parameter of clusterProfiler; for details, please check the documentation
of the clusterProfiler R package.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><code>logical(1)</code>: Boolean flag controlling the display of
messages.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A named list with two elements:</p><dl><dt><code>all_results</code></dt>
<dd><p>A nested, named list containing the raw over-representation analysis
results for each grouping column in <code>cluster_table</code>. Each top-level
element corresponds to one grouping column and contains the field
<code>ora_results</code>, a nested list of enrichment results organized by
cluster and database.</p></dd>

<dt><code>report_payload</code></dt>
<dd><p>A structured list containing all information required to generate an
HTML ORA report without recomputing any enrichment results. This payload
is intended to be passed to <code><a href="create_ora_report.html">create_ora_report()</a></code>.</p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># toy cluster table (two "conditions")</span></span></span>
<span class="r-in"><span>    <span class="va">toy_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"G"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">cluster_table</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        gene          <span class="op">=</span> <span class="va">toy_genes</span>,</span></span>
<span class="r-in"><span>        cluster_condA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        cluster_condB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># toy TERM2GENE database</span></span></span>
<span class="r-in"><span>    <span class="va">databases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        DB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"ToyDB"</span>, <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        Geneset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"SetA"</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"SetB"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        Gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G1"</span>, <span class="st">"G2"</span>, <span class="st">"G7"</span>, <span class="st">"G3"</span>, <span class="st">"G4"</span>, <span class="st">"G6"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># permissive params for tiny example </span></span></span>
<span class="r-in"><span>    <span class="va">clusterProfiler_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        pvalueCutoff <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>        minGSSize    <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>        maxGSSize    <span class="op">=</span> <span class="fl">500</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># run ORA</span></span></span>
<span class="r-in"><span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">run_ora</span><span class="op">(</span></span></span>
<span class="r-in"><span>        cluster_table            <span class="op">=</span> <span class="va">cluster_table</span>,</span></span>
<span class="r-in"><span>        databases                <span class="op">=</span> <span class="va">databases</span>,</span></span>
<span class="r-in"><span>        clusterProfiler_params   <span class="op">=</span> <span class="va">clusterProfiler_params</span>,</span></span>
<span class="r-in"><span>        verbose                  <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co"># see sections and files written</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Running clusterProfiler for column: cluster_condA</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Cluster: cluster_1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Database: ToyDB</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Foreground genes:3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Foreground genes overlapping with database: 3 (100%)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Cluster: cluster_2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Database: ToyDB</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Foreground genes:3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Foreground genes overlapping with database: 2 (66.7%)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  Running clusterProfiler for column: cluster_condB</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Cluster: cluster_1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Database: ToyDB</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Foreground genes:3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Foreground genes overlapping with database: 2 (66.7%)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Cluster: cluster_2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Database: ToyDB</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Foreground genes:2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Foreground genes overlapping with database: 2 (100%)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "all_results"    "report_payload"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Rauter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

