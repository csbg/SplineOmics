<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>run_limma_splines() — run_limma_splines • SplineOmics</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="run_limma_splines() — run_limma_splines"><meta name="description" content="This is the core function, which performs a limma spline analysis to identify
 significant time-dependent changes in features (e.g., proteins) within an
omics time-series dataset. It evaluates features within each condition level
and between levels by comparing average differences and interactions
between time and condition."><meta property="og:description" content="This is the core function, which performs a limma spline analysis to identify
 significant time-dependent changes in features (e.g., proteins) within an
omics time-series dataset. It evaluates features within each condition level
and between levels by comparing average differences and interactions
between time and condition."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SplineOmics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/CHANGELOG.html">Changelog</a></li>
    <li><a class="dropdown-item" href="../articles/design_limma_design_formula.html">Designing a Limma Design Formula</a></li>
    <li><a class="dropdown-item" href="../articles/Docker_permission_denied.html">Docker_permission_denied</a></li>
    <li><a class="dropdown-item" href="../articles/Docker-instructions.html">Docker-instructions</a></li>
    <li><a class="dropdown-item" href="../articles/get-started.html">get-started</a></li>
    <li><a class="dropdown-item" href="../articles/glycan-analysis.html">Glycan-analysis</a></li>
    <li><a class="dropdown-item" href="../articles/limma_result_categories.html">limma_result_categories</a></li>
    <li><a class="dropdown-item" href="../articles/methylation_data_analysis.html">methylation-data-analysis</a></li>
    <li><a class="dropdown-item" href="../articles/PVC_analysis.html">PVC_analysis</a></li>
    <li><a class="dropdown-item" href="../articles/RNA-seq-analysis.html">RNA-seq-analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/CHANGELOG.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/csbg/SplineOmics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>run_limma_splines()</h1>
      <small class="dont-index">Source: <a href="https://github.com/csbg/SplineOmics/blob/HEAD/R/run_limma_splines.R" class="external-link"><code>R/run_limma_splines.R</code></a></small>
      <div class="d-none name"><code>run_limma_splines.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is the core function, which performs a limma spline analysis to identify
 significant time-dependent changes in features (e.g., proteins) within an
omics time-series dataset. It evaluates features within each condition level
and between levels by comparing average differences and interactions
between time and condition.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_limma_splines</span><span class="op">(</span><span class="va">splineomics</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-splineomics">splineomics<a class="anchor" aria-label="anchor" href="#arg-splineomics"></a></dt>
<dd><p>An S3 object of class `SplineOmics` that contains the
following elements:</p><ul><li><p><code>data</code>: The matrix of the omics dataset, with the feature
  names optionally as row headers.</p></li>
<li><p><code>rna_seq_data</code>: An optional object containing the preprocessed
  RNA-seq data, such as the output from `limma::voom` or a similar
   preprocessing pipeline. This must only be provided when the input is
   RNA-seq data.</p></li>
<li><p><code>meta</code>: A dataframe containing metadata corresponding to the
  <code>data</code>, must include a 'Time' column and the column specified by
  <code>condition</code>. The columns of meta describe the meta info, such as
  the time and condition, and each row corresponds to a column in data, and
  therefore, contains the meta info for that data column. It is important
  that meta and data are matched in this way.</p></li>
<li><p><code>padjust_method</code>: Statistical method that is used for multiple
  hypothesis correction. Supported methods include all that are included in
  the p.adjust() function in R: "holm", "hochberg", "hommel", "bonferroni",
  "BH" or "fdr", "BY", or "none" for no correction. Default of this package
  is "BH".</p></li>
<li><p><code>design</code>: A character string representing the limma design
  formula, such as "~ 1 + Phase*Time + Reactor" for an integrated design, or
  "~ 1 + Time + Reactor" for an isolated design.</p></li>
<li><p><code>dream_params</code>: A named list or NULL. When not NULL, it can
                               contain the following named
     elements:
     - `dof`: An integer greater than 1, specifying the degrees of freedom
     for  the dream topTable. If set to 0, then the best dof is automatically
     found with the help of leave-one-out-crossvalidation (loocv). The dof
     with the lowest error on the loocv is chosen.
     - `KenwardRoger`: A boolean indicating whether to use the Kenward-Roger
     approximation for mixed models.
     Note that random effects are now directly specified in the design
     formula and not in `dream_params`.</p></li>
<li><p><code>mode</code>: Specifies how the design formula is constructed:
  either `"isolated"` or `"integrated"`.</p>
<p>- `"isolated"`: Each level is analyzed independently, using only the
    subset of data corresponding to that level. The design formula does
    not include the condition variable, since only one condition is
    present in each subset.</p>
<p>- `"integrated"`: All levels are analyzed together in a single model,
    using the full dataset. The design formula includes the condition
    variable (and optionally interaction terms with it) so that results
    are estimated jointly across all levels.</p></li>
<li><p><code>condition</code>: A character string specifying the column name
  in <code>meta</code> used to define groups for analysis. The condition column
  contains the levels of the experiment (such as control and treatment).</p></li>
<li><p><code>spline_params</code>: A list of spline parameters used in the
  analysis, including:</p><ul><li><p><code>spline_type</code>: The type of spline (e.g., "n" for natural
      splines or "b" for B-splines).</p></li>
<li><p><code>dof</code>: Degrees of freedom for the spline.</p></li>
<li><p><code>knots</code>: Positions of the internal knots (for B-splines).</p></li>
<li><p><code>bknots</code>: Boundary knots (for B-splines).</p></li>
<li><p><code>degree</code>: Degree of the spline (for B-splines only).</p></li>
</ul></li>
<li><p><code>use_array_weights</code>: Boolean flag indicating if the robust fit
   strategy to deal with heteroscedasticity should be used or not. If set to
   NULL, then this is handeled implicitly based on the result of the Levene
   test. If this test is significant for at least 10<!-- % of the features, -->
   then the robust strategy is used. The robust strategy uses the function
   voomWithQualityWeights for RNA-seq data instead of the normal voom
   function. For other, non-count-based data, the function
   limma::arrayWeights is used instead, combined with setting the robust
   argument to TRUE for the limma::eBayes function. In summary, the strategy
   employed by those functions is to downweights samples with higher
   variance. This can be neccessary, because linear models have the
   assumption of homoscedasticity, which means that the variance is
   (approx.) the same across all datapoints where the linear model is fitted.
    If this is violated, then the resulting p-values cannot be trusted
   (common statistical wisdom).</p></li>
<li><p><code>bp_cfg</code>: A named numeric vector specifying the parallelization
  configuration, with expected names `"n_cores"` and `"blas_threads"`.</p>
<p>This controls how many **R worker processes** (`n_cores`) and how many
  **BLAS/OpenBLAS threads per process** (`blas_threads`) should be used
  during parallel computation.</p>
<p>If `bp_cfg` is `NULL`, missing, or any of its required fields is
  `NA`, both `n_cores` and `blas_threads` default to `1`. This effectively
  disables parallelization and avoids oversubscription of CPU threads.</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The SplineOmics object, updated with a list with three elements:
        - `time_effect`: A list of top tables for each level with the time
                         effect.
        - `avrg_diff_conditions`: A list of top tables for each comparison
                                 between the levels. The comparison is the
                                 average difference of the values.
        - `interaction_condition_time`: A list of top tables for each
                                        comparison between levels. The
                                        comparison is the interaction between
                                        the condition and the time.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Rauter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

