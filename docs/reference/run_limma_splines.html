<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Perform a limma spline analysis to identify significant features — run_limma_splines • SplineOmics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform a limma spline analysis to identify significant features — run_limma_splines"><meta name="description" content="This is the core function, which performs a limma spline analysis to identify
significant time-dependent changes in features (e.g., proteins) within an
omics time-series dataset. It evaluates features within each condition level
and between levels by comparing average differences and interactions
between time and condition."><meta property="og:description" content="This is the core function, which performs a limma spline analysis to identify
significant time-dependent changes in features (e.g., proteins) within an
omics time-series dataset. It evaluates features within each condition level
and between levels by comparing average differences and interactions
between time and condition."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SplineOmics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/get_started.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Further use cases</h6></li>
    <li><a class="dropdown-item" href="../articles/RNA-seq-analysis.html">RNA-seq analysis</a></li>
    <li><a class="dropdown-item" href="../articles/glycan-analysis.html">Glycan analysis</a></li>
    <li><a class="dropdown-item" href="../articles/methylation_data_analysis.html">Epigenetics analysis</a></li>
    <li><a class="dropdown-item" href="../articles/PVC_analysis.html">Peak-Valley-Cliff (PVC) analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/limma_result_categories.html">limma result categories</a></li>
    <li><a class="dropdown-item" href="../articles/design_limma_design_formula.html">Designing a limma design formula</a></li>
    <li><a class="dropdown-item" href="../articles/Docker-instructions.html">Docker container instructions</a></li>
    <li><a class="dropdown-item" href="../articles/Docker_permission_denied.html">Docker permission denied</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/faq.html">FAQ</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/CHANGELOG.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/csbg/SplineOmics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Perform a limma spline analysis to identify significant features</h1>
      <small class="dont-index">Source: <a href="https://github.com/csbg/SplineOmics/blob/HEAD/R/run_limma_splines.R" class="external-link"><code>R/run_limma_splines.R</code></a></small>
      <div class="d-none name"><code>run_limma_splines.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is the core function, which performs a limma spline analysis to identify
significant time-dependent changes in features (e.g., proteins) within an
omics time-series dataset. It evaluates features within each condition level
and between levels by comparing average differences and interactions
between time and condition.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_limma_splines</span><span class="op">(</span><span class="va">splineomics</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-splineomics">splineomics<a class="anchor" aria-label="anchor" href="#arg-splineomics"></a></dt>
<dd><p><code>SplineOmics</code>: An S3 object of class <code>SplineOmics</code> that
contains the following elements:</p><ul><li><p><code>data</code>: <code>matrix</code> The matrix of the omics dataset, with the
feature
names optionally as row headers.</p></li>
<li><p><code>rna_seq_data</code>: <code>list</code> An optional object containing the
preprocessed
RNA-seq data, such as the output from <code><a href="https://rdrr.io/pkg/limma/man/voom.html" class="external-link">limma::voom</a></code> or a similar
preprocessing pipeline. This must only be provided when the input is
RNA-seq data.</p></li>
<li><p><code>meta</code>: <code>data.frame</code> A dataframe containing metadata
corresponding to the
<code>data</code>, must include a 'Time' column and the column specified by
<code>condition</code>. The columns of meta describe the meta info, such as
the time and condition, and each row corresponds to a column in data, and
therefore, contains the meta info for that data column. It is important
that meta and data are matched in this way.</p></li>
<li><p><code>padjust_method</code>: <code>character(1)</code> Statistical method that is
used for multiple
hypothesis correction. Supported methods include all that are included in
the p.adjust() function in R: "holm", "hochberg", "hommel", "bonferroni",
"BH" or "fdr", "BY", or "none" for no correction. Default of this package
is "BH".</p></li>
<li><p><code>design</code>: <code>character(1)</code> A character string representing the
limma design
formula, such as "~ 1 + Phase*Time + Reactor" for an integrated design, or
"~ 1 + Time + Reactor" for an isolated design.</p></li>
<li><p><code>dream_params</code>: <code>list | NULL</code> A named list or NULL. When not
NULL, it can contain the following named
elements:
- <code>dof</code>: <code>integer(1)</code> An integer greater than 1, specifying the
degrees of freedom
for  the dream topTable. If set to 0, then the best dof is automatically
found with the help of leave-one-out-crossvalidation (loocv). The dof
with the lowest error on the loocv is chosen.
- <code>KenwardRoger</code>: <code>logical(1)</code> A boolean indicating whether to use the
Kenward-Roger
approximation for mixed models.
Note that random effects are now directly specified in the design
formula and not in <code>dream_params</code>.</p></li>
<li><p><code>mode</code>: <code>character(1)</code> Specifies how the design formula is
constructed: either <code>"isolated"</code> or <code>"integrated"</code>.</p><ul><li><p><code>"isolated"</code>: Each level is analyzed independently, using only the
subset of data corresponding to that level. The design formula does
not include the condition variable, since only one condition is
present in each subset.</p></li>
<li><p><code>"integrated"</code>: All levels are analyzed together in a single model,
using the full dataset. The design formula includes the condition
variable (and optionally interaction terms with it) so that results
are estimated jointly across all levels.</p></li>
<li><p><code>condition</code>: <code>character(1)</code> A character string specifying the
column name
in <code>meta</code> used to define groups for analysis. The condition column
contains the levels of the experiment (such as control and treatment).</p></li>
<li><p><code>spline_params</code>: <code>list</code> A list of spline parameters used in the
analysis, including:</p><ul><li><p><code>spline_type</code>: <code>character(1)</code>The type of spline (e.g., <code>"n"</code>
for natural
splines or <code>"b"</code> for B-splines).</p></li>
<li><p><code>dof</code>: <code>integer(1)</code> Degrees of freedom for the spline. If
set to <code>0</code>,
<code>SplineOmics</code> automatically determines the optimal number of degrees
of freedom using leave-one-out cross-validation and selects the value
that yields the best predictive performance.</p></li>
<li><p><code>degree</code>: <code>integer(1)</code> Polynomial degree of the spline basis
(for B-splines only).</p></li>
</ul></li>
<li><p><code>use_array_weights</code>: <code>logical(1)</code> Boolean flag indicating if
the robust fit
strategy to deal with heteroscedasticity should be used or not. If set to
NULL, then this is handeled implicitly based on the result of the Levene
test. If this test is significant for at least 10% of the features,
then the robust strategy is used. The robust strategy uses the function
voomWithQualityWeights for RNA-seq data instead of the normal voom
function. For other, non-count-based data, the function
limma::arrayWeights is used instead, combined with setting the robust
argument to TRUE for the limma::eBayes function. In summary, the strategy
employed by those functions is to downweights samples with higher
variance. This can be neccessary, because linear models have the
assumption of homoscedasticity, which means that the variance is
(approx.) the same across all datapoints where the linear model is fitted.
If this is violated, then the resulting p-values cannot be trusted
(common statistical wisdom).</p></li>
<li><p><code>bp_cfg</code>: <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric()</a></code> A named numeric vector specifying the
parallelization
configuration, with expected names <code>"n_cores"</code>: <code>integer(1)</code> and
<code>"blas_threads"</code>: <code>integer(1)</code>.</p></li>
</ul><p>This controls how many R worker processes (<code>n_cores</code>) and how many
BLAS/OpenBLAS threads per process (<code>blas_threads</code>) should be used
during parallel computation.</p>
<p>If <code>bp_cfg</code> is <code>NULL</code>, missing, or any of its required fields is
<code>NA</code>, both <code>n_cores</code> and <code>blas_threads</code> default to <code>1</code>. This effectively
disables parallelization and avoids oversubscription of CPU threads.</p></li>
</ul></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><code>logical(1)</code>: Boolean flag controlling the display of
messages.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The SplineOmics object, updated with a list with three elements:
- <code>time_effect</code>: <code>list</code> A list of top tables for each level with the
time effect.
- <code>avrg_diff_conditions</code>: <code>list</code> A list of top tables for each
comparison between the levels. The comparison is the average
difference of the values.
- <code>interaction_condition_time</code>: <code>list</code> A list of top tables for each
comparison between levels. The
comparison is the interaction between
the condition and the time.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Toy data: 4 features x 6 samples (two conditions, three time points)</span></span></span>
<span class="r-in"><span><span class="va">toy_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">12</span>, <span class="fl">17</span>, <span class="fl">23</span>, <span class="co"># f1</span></span></span>
<span class="r-in"><span>        <span class="fl">23</span>, <span class="fl">17</span>, <span class="fl">13</span>, <span class="fl">9</span>, <span class="fl">6</span>, <span class="fl">4</span>, <span class="co"># f2</span></span></span>
<span class="r-in"><span>        <span class="fl">5</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="co"># f3</span></span></span>
<span class="r-in"><span>        <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="co"># f4</span></span></span>
<span class="r-in"><span>        <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="co"># f5</span></span></span>
<span class="r-in"><span>        <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">9</span>, <span class="fl">12</span>, <span class="fl">15</span>, <span class="co"># f6</span></span></span>
<span class="r-in"><span>        <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">10</span>, <span class="fl">14</span>, <span class="fl">19</span>, <span class="co"># f7</span></span></span>
<span class="r-in"><span>        <span class="fl">12</span>, <span class="fl">11</span>, <span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">12</span> <span class="co"># f8</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    nrow <span class="op">=</span> <span class="fl">8</span>, ncol <span class="op">=</span> <span class="fl">6</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"f"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"s"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">toy_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>, <span class="st">"KO"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    Replicate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R1"</span>, <span class="st">"R2"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">toy_data</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">toy_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    feature_nr <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span>,</span></span>
<span class="r-in"><span>    gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G1"</span>, <span class="st">"G2"</span>, <span class="st">"G3"</span>, <span class="st">"G4"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stub limma "top tables" with minimal required fields</span></span></span>
<span class="r-in"><span><span class="co"># (feature_nr + adj.P.Val)</span></span></span>
<span class="r-in"><span><span class="va">tt_wt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>feature_nr <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, adj.P.Val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.20</span>, <span class="fl">0.04</span>, <span class="fl">0.60</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tt_ko</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>feature_nr <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, adj.P.Val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.50</span>, <span class="fl">0.03</span>, <span class="fl">0.70</span>, <span class="fl">0.02</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tt_c2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>feature_nr <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, adj.P.Val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.04</span>, <span class="fl">0.70</span>, <span class="fl">0.80</span>, <span class="fl">0.90</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tt_c3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>feature_nr <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, adj.P.Val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.20</span>, <span class="fl">0.90</span>, <span class="fl">0.03</span>, <span class="fl">0.80</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">design_str</span> <span class="op">&lt;-</span> <span class="st">"~ 1 + Time*condition"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Minimal spline parameters required by spline machinery</span></span></span>
<span class="r-in"><span><span class="va">spline_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    spline_type <span class="op">=</span> <span class="st">"n"</span>, <span class="co"># natural cubic splines</span></span></span>
<span class="r-in"><span>    dof <span class="op">=</span> <span class="fl">1L</span> <span class="co"># degrees of freedom for the spline basis</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">toy_splineomics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">toy_data</span>,</span></span>
<span class="r-in"><span>    meta <span class="op">=</span> <span class="va">toy_meta</span>,</span></span>
<span class="r-in"><span>    annotation <span class="op">=</span> <span class="va">toy_annot</span>,</span></span>
<span class="r-in"><span>    report_info <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        omics_data_type <span class="op">=</span> <span class="st">"RNA-seq"</span>,</span></span>
<span class="r-in"><span>        data_description <span class="op">=</span> <span class="st">"toy example"</span>,</span></span>
<span class="r-in"><span>        data_collection_date <span class="op">=</span> <span class="st">"2025-01-01"</span>,</span></span>
<span class="r-in"><span>        analyst_name <span class="op">=</span> <span class="st">"Example"</span>,</span></span>
<span class="r-in"><span>        contact_info <span class="op">=</span> <span class="st">"example@example.org"</span>,</span></span>
<span class="r-in"><span>        project_name <span class="op">=</span> <span class="st">"ToyProject"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    design <span class="op">=</span> <span class="va">design_str</span>,</span></span>
<span class="r-in"><span>    mode <span class="op">=</span> <span class="st">"integrated"</span>,</span></span>
<span class="r-in"><span>    condition <span class="op">=</span> <span class="st">"condition"</span>,</span></span>
<span class="r-in"><span>    spline_params <span class="op">=</span> <span class="va">spline_params</span>,</span></span>
<span class="r-in"><span>    meta_batch_column <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>    meta_batch2_column <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>    limma_splines_result <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        time_effect                  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>WT <span class="op">=</span> <span class="va">tt_wt</span>, KO <span class="op">=</span> <span class="va">tt_ko</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        avrg_diff_conditions         <span class="op">=</span> <span class="va">tt_c2</span>,</span></span>
<span class="r-in"><span>        interaction_condition_time   <span class="op">=</span> <span class="va">tt_c3</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    feature_name_columns <span class="op">=</span> <span class="st">"gene"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">toy_splineomics</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"SplineOmics"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">toy_splineomics</span> <span class="op">&lt;-</span> <span class="fu">run_limma_splines</span><span class="op">(</span><span class="va">toy_splineomics</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Ensure the design has no Condition*Time interaction for mode == 'isolated', and includes it for mode == 'integrated'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running Levene's test both feature wise and sample wise to implicitly decide whether to use the limma array weights or not.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No random effects: fitting model with lmFit()...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running feature wise Levene's test...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fraction of features violating homoscedasticity</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     (p &lt; 0.050): 0.00% (0/8 features)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No violating features found.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running Levene's test across samples to detect inter-sample variance differences...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Levene's test p-value (sample-level): 0.1425</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ✅ No strong evidence of inter-sample variance differences.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ✅ No strong evidence for heteroscedasticity.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Proceeding WITHOUT using robust strategy.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fitting global model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">Info</span> Finished limma spline analysis in 0.0 min</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Rauter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

