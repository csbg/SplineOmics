<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compare hits between two SplineOmics results — compare_results • SplineOmics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compare hits between two SplineOmics results — compare_results"><meta name="description" content="Compares adjusted p-values from two SplineOmics result objects across
standard categories. Calculates Spearman correlation globally and for
significant hits only, generates diagnostic plots, and summarizes
overlap statistics including Jaccard index and hit counts.
Note: The feature_names columns in the topTables of splineomics1 and
splineomics2 must have the same names, otherwise, no comparisons are
possible."><meta property="og:description" content="Compares adjusted p-values from two SplineOmics result objects across
standard categories. Calculates Spearman correlation globally and for
significant hits only, generates diagnostic plots, and summarizes
overlap statistics including Jaccard index and hit counts.
Note: The feature_names columns in the topTables of splineomics1 and
splineomics2 must have the same names, otherwise, no comparisons are
possible."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SplineOmics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/get_started.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Further use cases</h6></li>
    <li><a class="dropdown-item" href="../articles/RNA-seq-analysis.html">RNA-seq analysis</a></li>
    <li><a class="dropdown-item" href="../articles/glycan-analysis.html">Glycan analysis</a></li>
    <li><a class="dropdown-item" href="../articles/methylation_data_analysis.html">Epigenetics analysis</a></li>
    <li><a class="dropdown-item" href="../articles/PVC_analysis.html">Peak-Valley-Cliff (PVC) analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/limma_result_categories.html">limma result categories</a></li>
    <li><a class="dropdown-item" href="../articles/design_limma_design_formula.html">Designing a limma design formula</a></li>
    <li><a class="dropdown-item" href="../articles/Docker-instructions.html">Docker container instructions</a></li>
    <li><a class="dropdown-item" href="../articles/Docker_permission_denied.html">Docker permission denied</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/faq.html">FAQ</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/CHANGELOG.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/csbg/SplineOmics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Compare hits between two SplineOmics results</h1>
      <small class="dont-index">Source: <a href="https://github.com/csbg/SplineOmics/blob/HEAD/R/compare_results.R" class="external-link"><code>R/compare_results.R</code></a></small>
      <div class="d-none name"><code>compare_results.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compares adjusted p-values from two SplineOmics result objects across
standard categories. Calculates Spearman correlation globally and for
significant hits only, generates diagnostic plots, and summarizes
overlap statistics including Jaccard index and hit counts.</p>
<p>Note: The feature_names columns in the topTables of splineomics1 and
splineomics2 must have the same names, otherwise, no comparisons are
possible.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">compare_results</span><span class="op">(</span></span>
<span>  <span class="va">splineomics1</span>,</span>
<span>  <span class="va">splineomics2</span>,</span>
<span>  splineomics1_description <span class="op">=</span> <span class="st">"SplineOmics_1"</span>,</span>
<span>  splineomics2_description <span class="op">=</span> <span class="st">"SplineOmics_2"</span>,</span>
<span>  adj_p_tresh1 <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  adj_p_tresh2 <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-splineomics-">splineomics1<a class="anchor" aria-label="anchor" href="#arg-splineomics-"></a></dt>
<dd><p><code>SplineOmics</code>: A list containing <code>limma_splines_result</code>
with topTables organized by category and subcategory.</p></dd>


<dt id="arg-splineomics-">splineomics2<a class="anchor" aria-label="anchor" href="#arg-splineomics-"></a></dt>
<dd><p><code>SplineOmics</code>: Same structure as <code>splineomics1</code>; the
object to compare.</p></dd>


<dt id="arg-splineomics-description">splineomics1_description<a class="anchor" aria-label="anchor" href="#arg-splineomics-description"></a></dt>
<dd><p><code>character(1)</code>: Character label used for
x-axis annotation.</p></dd>


<dt id="arg-splineomics-description">splineomics2_description<a class="anchor" aria-label="anchor" href="#arg-splineomics-description"></a></dt>
<dd><p><code>character(1)</code>: Character label used for
y-axis annotation.</p></dd>


<dt id="arg-adj-p-tresh-">adj_p_tresh1<a class="anchor" aria-label="anchor" href="#arg-adj-p-tresh-"></a></dt>
<dd><p><code>numeric(1)</code>: Numeric p-value threshold for calling
hits in analysis 1.</p></dd>


<dt id="arg-adj-p-tresh-">adj_p_tresh2<a class="anchor" aria-label="anchor" href="#arg-adj-p-tresh-"></a></dt>
<dd><p><code>numeric(1)</code>: Numeric p-value threshold for calling
hits in analysis 2.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with components:</p><dl><dt>correlation_summary</dt>
<dd><p>Data frame of global and hit-level correlations</p></dd>

<dt>plots</dt>
<dd><p>Named list of ggplot objects for all and hit-only subsets.</p></dd>

<dt>hits_summary</dt>
<dd><p>Data frame with hit counts, overlap, and Jaccard index</p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Minimal runnable example (offline)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># Two tiny topTables per category with matching feature_names</span></span></span>
<span class="r-in"><span>  <span class="va">feats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"g"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ttA_te</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>feature_names <span class="op">=</span> <span class="va">feats</span>,</span></span>
<span class="r-in"><span>                       adj.P.Val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.01</span>, <span class="fl">.2</span>, <span class="fl">.03</span>, <span class="fl">.8</span>, <span class="fl">.5</span>, <span class="fl">.04</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ttB_te</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>feature_names <span class="op">=</span> <span class="va">feats</span>,</span></span>
<span class="r-in"><span>                       adj.P.Val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.02</span>, <span class="fl">.25</span>, <span class="fl">.01</span>, <span class="fl">.7</span>, <span class="fl">.4</span>, <span class="fl">.06</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ttA_c2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>feature_names <span class="op">=</span> <span class="va">feats</span>,</span></span>
<span class="r-in"><span>                       adj.P.Val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.8</span>, <span class="fl">.04</span>, <span class="fl">.3</span>, <span class="fl">.9</span>, <span class="fl">.7</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ttB_c2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>feature_names <span class="op">=</span> <span class="va">feats</span>,</span></span>
<span class="r-in"><span>                       adj.P.Val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.3</span>, <span class="fl">.7</span>, <span class="fl">.03</span>, <span class="fl">.4</span>, <span class="fl">.95</span>, <span class="fl">.6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ttA_c3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>feature_names <span class="op">=</span> <span class="va">feats</span>,</span></span>
<span class="r-in"><span>                       adj.P.Val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.6</span>, <span class="fl">.7</span>, <span class="fl">.04</span>, <span class="fl">.9</span>, <span class="fl">.8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ttB_c3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>feature_names <span class="op">=</span> <span class="va">feats</span>,</span></span>
<span class="r-in"><span>                       adj.P.Val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.6</span>, <span class="fl">.55</span>, <span class="fl">.65</span>, <span class="fl">.03</span>, <span class="fl">.85</span>, <span class="fl">.75</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Assemble limma_splines_result lists (one subcategory per cat)</span></span></span>
<span class="r-in"><span>  <span class="va">lsr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    time_effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>WT <span class="op">=</span> <span class="va">ttA_te</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    avrg_diff_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>comp <span class="op">=</span> <span class="va">ttA_c2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    interaction_condition_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>comp <span class="op">=</span> <span class="va">ttA_c3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">lsr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    time_effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>WT <span class="op">=</span> <span class="va">ttB_te</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    avrg_diff_conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>comp <span class="op">=</span> <span class="va">ttB_c2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    interaction_condition_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>comp <span class="op">=</span> <span class="va">ttB_c3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Minimal SplineOmics shells holding the results</span></span></span>
<span class="r-in"><span>  <span class="va">so1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>limma_splines_result <span class="op">=</span> <span class="va">lsr1</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">so1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"SplineOmics"</span></span></span>
<span class="r-in"><span>  <span class="va">so2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>limma_splines_result <span class="op">=</span> <span class="va">lsr2</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">so2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"SplineOmics"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">cmp</span> <span class="op">&lt;-</span> <span class="fu">compare_results</span><span class="op">(</span></span></span>
<span class="r-in"><span>    splineomics1 <span class="op">=</span> <span class="va">so1</span>,</span></span>
<span class="r-in"><span>    splineomics2 <span class="op">=</span> <span class="va">so2</span>,</span></span>
<span class="r-in"><span>    splineomics1_description <span class="op">=</span> <span class="st">"Analysis A"</span>,</span></span>
<span class="r-in"><span>    splineomics2_description <span class="op">=</span> <span class="st">"Analysis B"</span>,</span></span>
<span class="r-in"><span>    adj_p_tresh1 <span class="op">=</span> <span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>    adj_p_tresh2 <span class="op">=</span> <span class="fl">0.05</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Inspect outputs</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cmp</span><span class="op">$</span><span class="va">correlation_summary</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cmp</span><span class="op">$</span><span class="va">plots</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cmp</span><span class="op">$</span><span class="va">hits_summary</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     category subcategory hits_1 hits_2 n_overlap jaccard_index</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                time_effect          WT      3      2         2         0.667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       avrg_diff_conditions        comp      1      1         1         1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 interaction_condition_time        comp      1      1         1         1.000</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Rauter.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

