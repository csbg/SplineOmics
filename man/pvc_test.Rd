% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/find_pvc.R
\name{pvc_test}
\alias{pvc_test}
\title{Detect peaks/valleys in time-series omics using compound contrasts in limma}
\usage{
pvc_test(data, meta, alpha = 0.05, padjust_method = "BH")
}
\arguments{
\item{data}{A numeric matrix, where rows correspond to features (e.g., genes, 
proteins, metabolites) and columns correspond to samples.}

\item{meta}{A data frame containing metadata for the samples. Must include 
a column named `"Time"` that specifies the timepoint for each sample.}

\item{alpha}{A numeric value specifying the significance threshold for 
excursion detection. Defaults to `0.05`.}

\item{padjust_method}{Method to correct the p-values for multiple hypothesis
testing.}
}
\value{
A list containing two elements:
\describe{
  \item{`results_df`}{A data frame with binary indicators for excursions 
  at each timepoint for each feature. Rows correspond to features, columns 
  correspond to timepoints, and values are `1` (excursion) or `0` 
  (no excursion).}
  \item{`pairwise_pvals`}{A matrix of one-tailed adjusted p-values from 
  limma's moderated t-test for pairwise comparisons between consecutive 
  timepoints.}
}
}
\description{
This function identifies excursions in time-series omics data using a 
rolling window Union-Intersection Test (UIT). A timepoint is flagged as 
an excursion if it is significantly different from both its adjacent 
neighbors in the same direction (higher or lower). The significance is 
determined using limma's moderated t-test with FDR correction.
}
