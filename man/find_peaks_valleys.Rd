% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/find_peaks_valleys.R
\name{find_peaks_valleys}
\alias{find_peaks_valleys}
\title{Find Peaks and Valleys in Time-Series Omics Data}
\usage{
find_peaks_valleys(splineomics, alpha = 0.05, padjust_method = "BH")
}
\arguments{
\item{splineomics}{A list containing the preprocessed time-series input data. 
Must include named elements `"data"` (a numeric matrix), `"meta"` (a metadata 
data frame with a `"Time"` column), `"meta_batch_column"` (name of the column 
in `meta` identifying replicates or batches), and `"padjust_method"` (a 
string specifying the method for p-value adjustment).}

\item{alpha}{A numeric significance threshold used to identify excursion 
points. Defaults to `0.05`.}

\item{padjust_method}{A character string specifying the method for multiple 
testing correction. Defaults to `"BH"` (Benjamini-Hochberg).}
}
\value{
A named list of ggplot objects, where each element corresponds to a 
feature with at least one detected peak or valley. Each plot shows expression 
profiles across timepoints, highlights excursion points in red, and annotates 
statistically significant excursions with significance stars.
}
\description{
Identifies significant local peaks or valleys (excursions) in time-series 
omics data using a Union-Intersection Test (UIT)-based approach. This 
function wraps the detection and plotting steps, returning visualizations of 
all features with at least one excursion.
}
\details{
A **peak** or **valley** is defined as a timepoint whose expression value is 
significantly different from both its immediate neighbors and deviates in 
the same direction â€” i.e., it is either significantly higher than both 
(a peak) or significantly lower than both (a valley).  

Statistically, this is tested using a compound contrast in limma:  
\deqn{(T - T_{prev}) + (T - T_{next}) = 2T - T_{prev} - T_{next}}  
This compound contrast has power only when the timepoint `T` is an outlier 
compared to both neighbors in the same direction. The resulting p-value is 
FDR-adjusted and compared to the `alpha` threshold.

- Performs internal input validation via `check_splineomics_elements()` and 
  `InputControl`.
- Detects local excursions using the `peaks_valleys_uit()` function.
- Displays the number of total excursion hits found.
- Generates plots using `plot_peaks_valleys()`, with each excursion point 
  evaluated for significance based on the provided `alpha`.
}
