% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/detect_excursions_playground.R
\name{detect_excursions}
\alias{detect_excursions}
\title{Detect Excursions in Time-Series Omics Data}
\usage{
detect_excursions(data, meta, alpha = 0.05)
}
\arguments{
\item{data}{A numeric matrix, where rows correspond to features (e.g., genes,
proteins, metabolites) and columns correspond to samples.}

\item{meta}{A data frame containing metadata for the samples. Must include
a column named `"Time"` that specifies the timepoint for each sample.}

\item{alpha}{A numeric value specifying the significance threshold for
excursion detection. Defaults to `0.05`.}
}
\value{
A list containing two elements:
\describe{
  \item{`results_df`}{A data frame with binary indicators for excursions
  at each timepoint for each feature. Rows correspond to features, columns
  correspond to timepoints, and values are `1` (excursion) or `0`
  (no excursion).}
  \item{`pairwise_pvals`}{A matrix of one-tailed adjusted p-values from
  limma's moderated t-test for pairwise comparisons between consecutive
  timepoints.}
}
}
\description{
This function identifies excursions in time-series omics data by performing
adjacency-based pairwise comparisons between consecutive timepoints using
limma's moderated t-test. Excursions are defined as timepoints that are
significantly different from both their adjacent neighbors, with their mean
being either higher or lower than both neighbors. All p-values are converted
to one-tailed values to enhance sensitivity.
}
\details{
- The function first fits a linear model to the data using limma.
- It then computes pairwise comparisons between adjacent timepoints.
- All p-values are adjusted using the Benjamini-Hochberg method for false
discovery rate (FDR) correction and subsequently divided by `2` to
reflect a one-tailed test.
- Excursions are identified if a timepoint exhibits significant differences
from both its neighbors and is either higher or lower than both.
}
