% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_general.R
\name{check_homoscedasticity_violation}
\alias{check_homoscedasticity_violation}
\title{Check for Violation of Homoscedasticity in Linear Model Inputs}
\usage{
check_homoscedasticity_violation(
  data,
  meta,
  condition,
  data_type = "other-omics",
  p_threshold = 0.05,
  fraction_threshold = 0.1
)
}
\arguments{
\item{data}{A numeric matrix of expression values (rows = features, 
columns = samples). Should already be log-transformed or 
otherwise variance-stabilized if required.}

\item{meta}{A data frame of sample metadata. Must have one row per column 
in `data`, and must contain a numeric `Time` column indicating 
the timepoint for each sample.}

\item{condition}{A character string indicating the name of the column in
`meta` representing the condition of interest. Currently
only used for consistency; not directly used in this test.}

\item{data_type}{String specifying the omics data type ("rna-seq" or 
"other-omics"). Used to determine the recommendation
message in case of heteroscedasticity.}

\item{p_threshold}{Numeric. Significance threshold for the Breusch–Pagan 
test per feature (default is 0.05).}

\item{fraction_threshold}{Numeric. Proportion of features that must violate 
the homoscedasticity assumption (p < p_threshold) 
to consider the whole dataset heteroscedastic 
(default is 0.1, i.e., 10%).}
}
\value{
A logical value indicating whether a statistically significant 
        violation of homoscedasticity was detected in the dataset 
        (`TRUE` = assumption violated, `FALSE` = no violation). 
        A summary message is printed to the console.
}
\description{
This internal helper function tests whether the assumption of 
homoscedasticity (equal variance of residuals) is violated across time 
for each feature (e.g., gene or protein).
}
\details{
For each feature independently, the function fits a linear model of the 
form `expression ~ time`, where the `time` variable is extracted from 
`meta[["Time"]]` and assumed to be numeric. The residuals from this model 
are then tested for heteroscedasticity using the Breusch–Pagan test.

The Breusch–Pagan test evaluates whether the variance of residuals 
systematically depends on the fitted values from the model. Under the null 
hypothesis, the residual variance is constant across all fitted values 
(i.e., homoscedasticity). Under the alternative hypothesis, the residual 
variance increases or decreases with the predicted expression values 
(i.e., heteroscedasticity).

The test does this by regressing the squared residuals onto the fitted 
values and checking whether this auxiliary regression explains significantly 
more variance than expected by chance. A small p-value indicates that the 
residual variance is not constant and thus violates the assumption of 
homoscedasticity.

This function applies the Breusch–Pagan test across all features 
independently and counts how many features yield a p-value below the 
specified `p_threshold`. If the fraction of violating features exceeds 
`fraction_threshold`, the function concludes that the dataset likely 
violates the homoscedasticity assumption and suggests switching to a 
more robust modeling strategy.
}
