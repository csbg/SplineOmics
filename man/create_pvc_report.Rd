% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_pvc_report.R
\name{create_pvc_report}
\alias{create_pvc_report}
\title{Create PVC HTML report from statistical PVC results}
\usage{
create_pvc_report(
  splineomics,
  pvc_results,
  plot_info = list(y_axis_label = "Value", time_unit = "min", treatment_labels = NA,
    treatment_timepoints = NA),
  verbose = FALSE,
  report_dir = tempdir()
)
}
\arguments{
\item{splineomics}{\code{list}: Preprocessed time-series input. Must include at
least \code{data}, \code{meta}, \code{annotation}, \code{condition},
\code{meta_batch_column}, \code{meta_batch2_column} (optional),
\code{report_info}, and \code{feature_name_columns}.}

\item{pvc_results}{\code{list}: Output from \code{find_pvc()}, a named list by
condition level. Each level must contain \code{alpha} and
\code{pvc_adj_pvals}. Attributes \code{padjust_method} and \code{support}
are used for report header settings.}

\item{plot_info}{\code{list}: Plot annotation options passed to \code{plot_pvc()}.
See \code{find_pvc()} for the expected structure. Treatment annotations are
applied per condition level if \code{treatment_labels} and
\code{treatment_timepoints} are provided.}

\item{verbose}{Boolean flag indicating if messages should be shown.}

\item{report_dir}{\code{character(1)}: Output directory for the HTML report and
any associated files.}
}
\value{
The input \code{pvc_results} with an additional \code{plots} element
added under each condition level. The report is written to
\code{report_dir}.
}
\description{
Generates per-feature PVC plots and writes an HTML report to disk from the
statistical output of \code{find_pvc()}. This function does not recompute any
statistics; it consumes \code{pvc_results} (including its attributes) and the
original input data stored in \code{splineomics}.
}
\details{
For each condition level, the function subsets \code{splineomics$data} and
\code{splineomics$meta}, generates per-feature plots via \code{plot_pvc()}, then
calls \code{generate_report_html()} with the plots, metadata, and report header
settings derived from \code{pvc_results} and \code{splineomics}.
}
\examples{
## Runnable example using packaged extdata (small subset for speed)
data_in <- readRDS(
  xzfile(
    system.file(
      "extdata",
      "phosphoproteomics_data.rds.xz",
      package = "SplineOmics"
    )
  )
)

meta <- read.csv(
  system.file(
    "extdata",
    "phosphoproteomics_meta.csv",
    package = "SplineOmics"
  ),
  stringsAsFactors = FALSE
)

first_na_col <- which(is.na(data_in[1, ]))[1]
annotation_all <- data_in[, (first_na_col + 1):ncol(data_in), drop = FALSE]

## Extract a small feature subset to keep examples fast
data_mat <- SplineOmics::extract_data(
  data = data_in,
  feature_name_columns = c("T..Gene"),
  use_row_index = TRUE,
  top_row = 1,
  bottom_row = 50,
  right_col = 36,
  left_col = 1
)

## IMPORTANT: subset annotation to match the selected features
keep_ids <- rownames(data_mat)
annotation <- annotation_all[
    annotation_all$T..Gene \%in\% keep_ids, , drop = FALSE
    ]
annotation <- annotation[
    match(keep_ids, annotation$T..Gene), , drop = FALSE
    ]

splineomics <- SplineOmics::create_splineomics(
  data = data_mat,
  meta = meta,
  annotation = annotation,
  condition = "Phase",
  meta_batch_column = "Reactor"
)

pvc_results <- SplineOmics::find_pvc(
  splineomics = splineomics,
  alphas = 0.025,
  padjust_method = "BH",
  support = 1
)

report_dir <- file.path(tempdir(), "pvc_report_example")
dir.create(report_dir, showWarnings = FALSE, recursive = TRUE)

out <- SplineOmics::create_pvc_report(
  splineomics = splineomics,
  pvc_results = pvc_results,
  verbose = FALSE,
  report_dir = report_dir
)

names(out)

}
