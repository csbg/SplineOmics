% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extract_gene_sets.R
\name{extract_gene_sets}
\alias{extract_gene_sets}
\title{Download gene set annotations from Bioconductor organism databases}
\usage{
extract_gene_sets(
  organism_db = "org.Hs.eg.db",
  output_dir = here::here(),
  filename = NULL
)
}
\arguments{
\item{organism_db}{\code{character(1)}: A string specifying the Bioconductor
organism annotation database to use (e.g., \code{"org.Hs.eg.db"} for human or
\code{"org.Mm.eg.db"} for mouse).}

\item{output_dir}{\code{character(1)}: A string specifying the output directory
where the \code{.tsv} file will be saved. Defaults to the current project
directory as defined by \code{here::here()}.}

\item{filename}{\code{character(1)} | \code{NULL}: An optional string specifying the
filename for the output file. If \code{NULL} (default), a filename is generated
automatically with a timestamp.}
}
\value{
A \code{data.frame} of gene set annotations with three columns:
\describe{
\item{DB}{Ontology/database source, e.g. \code{"GO_BP"}, \code{"GO_MF"}, \code{"GO_CC"},
or \code{"KEGG"} (if available).}
\item{Geneset}{Ontology term ID or pathway ID (e.g. GO ID, KEGG ID).}
\item{Gene}{Gene symbol (\code{SYMBOL}).}
}
}
\description{
This function extracts gene-to-ontology mappings from a specified
Bioconductor organism annotation package (e.g., \code{org.Hs.eg.db},
\code{org.Mm.eg.db}) and saves the gene sets to a \code{.tsv} file in a
standardized format. The output includes mappings for Gene Ontology
(GO) Biological Process (BP), Molecular Function (MF), Cellular
Component (CC), and KEGG pathways. The resulting file can be used
directly with enrichment functions such as \code{clusterProfiler::enricher()}
with \code{TERM2GENE}.
}
\details{
The TSV has three columns:
\describe{
\item{DB}{Ontology/database source, e.g., \code{"GO_BP"}, \code{"GO_MF"},
\code{"GO_CC"}, or \code{"KEGG"} (if available).}
\item{Geneset}{Ontology term ID or pathway ID (e.g., GO ID, KEGG ID).}
\item{Gene}{Gene symbol (\code{SYMBOL}).}
}
Note: Some \code{org.*.eg.db} packages no longer include KEGG mappings; in
such cases the KEGG section will be empty.

In addition to returning the \code{data.frame}, the function also writes the same
table to disk as a \code{.tsv} file in the specified \code{output_dir}.
}
\examples{
# Minimal real example (runs only if org package is installed)
tmp <- tempdir()
if (requireNamespace("org.Mm.eg.db", quietly = TRUE) &&
    requireNamespace("AnnotationDbi", quietly = TRUE)) {
    gs <- extract_gene_sets(
        organism_db = "org.Mm.eg.db",
        output_dir  = tmp,
        filename    = "mm_genesets.tsv"
    )
    head(gs)
    # The file path:
    file.path(tmp, "mm_genesets.tsv")
}

# If the organism package is not installed, you can still see the TSV format:
tiny <- data.frame(
    DB = c("GO_BP", "GO_MF"),
    Geneset = c("GO:0008150", "GO:0003674"),
    Gene = c("Trp53", "Egfr"),
    stringsAsFactors = FALSE
)
utils::write.table(
    tiny,
    file = file.path(tmp, "example_genesets.tsv"),
    sep = "\t", row.names = FALSE, col.names = TRUE, quote = FALSE
)

}
