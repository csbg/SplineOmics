% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_ora.R
\name{add_p_adj_by_db}
\alias{add_p_adj_by_db}
\title{Add database-wise adjusted p-values across clusters}
\usage{
add_p_adj_by_db(ora_results, p_adjust_method = "BH")
}
\arguments{
\item{ora_results}{A nested list of ORA results of the form
\code{ora_results[[cluster]][[database]]}, where each leaf is either
a data.frame with a \code{pvalue} column (from clusterProfiler) or
a non-data.frame placeholder (e.g. \code{NA}).}

\item{p_adjust_method}{Character scalar specifying the multiple-testing
correction method to use. Passed to \code{stats::p.adjust(method = ...)}.
Typical choices are \code{"BH"} (default), \code{"bonferroni"},
\code{"holm"}, \code{"BY"}, etc.}
}
\value{
The same \code{ora_results} object, with each ORA data.frame
containing an additional numeric column \code{p_adj_by_db}, holding
p-values adjusted across all clusters for that database.
}
\description{
For a single limma result, this function performs multiple testing
correction per gene set database across all clusters.
}
\details{
For each database (e.g. GO_Biological_Process, KEGG_2019_Human, ...),
it collects the \code{pvalue} column from all clusters, applies
\code{stats::p.adjust()} with the chosen method, and writes the adjusted
p-values back into each ORA result data frame as a new column
\code{p_adj_by_db}.

Entries in \code{ora_results} that are not data.frames (e.g. \code{NA},
\code{FALSE}) are skipped.
}
